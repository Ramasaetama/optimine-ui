(()=>{"use strict";const e={appName:"OptiMine",version:"1.0.0",api:{baseUrl:"http://139.59.224.58:5000",timeout:1e4},routes:{default:"home",protected:["planning","ai-tools","dashboard","profile"],public:["home","auth"]},transition:{duration:400,type:"slide"},storage:{theme:"optimine-theme",language:"optimine-language",user:"optimine-user",token:"optimine-token",isLoggedIn:"optimine-logged-in"},defaults:{theme:"dark",language:"id"}},t={en:{nav:{home:"Home",planning:"Planning",aiTools:"AI Tools",dashboard:"Dashboard",login:"Login",profile:"Profile",logout:"Sign Out"},home:{welcomeBack:"Welcome Back",subtitle:"Mining Value Chain Optimization",activeSites:"Active Sites",fleetUnits:"Fleet Units",efficiency:"Efficiency",quickAccess:"QUICK ACCESS",aiScenario:"AI Scenario Simulator",aiScenarioDesc:"Simulate various operational scenarios and generate optimized production & distribution recommendations based on real-time field conditions.",aiChatbot:"AI Assistant Chatbot",aiChatbotDesc:"Interactive Q&A chatbot for field conditions, operational queries, and AI-powered recommendations with contextual responses.",opsDashboard:"Operations Dashboard",opsDashboardDesc:"Comprehensive data visualization with real-time monitoring, analytics, and justification for every AI recommendation.",accessDashboard:"Access Dashboard",aiPoweredAnalysis:"AI-Powered Analysis",realtimeMonitoring:"Real-time Monitoring",riskMitigation:"Risk Mitigation",costOptimization:"Cost Optimization"},planning:{title:"Production Planning",subtitle:"Input operational conditions to generate optimized plans",weatherConditions:"Weather Conditions",rainfallLevel:"Rainfall Level",low:"Low",high:"High",waveHeight:"Wave Height",calm:"Calm",rough:"Rough",fleetStatus:"Fleet Status",activeVehicles:"Active Vehicles",maintenanceStatus:"Maintenance Status",fleetAvailability:"Fleet Availability",truckCount:"Truck Count",excavatorCount:"Excavator Count",shipSchedule:"Ship Schedule",vesselName:"Vessel Name",estimatedArrival:"Estimated Arrival",cargoCapacity:"Cargo Capacity (tons)",addVessel:"Add Vessel",generatePlan:"Generate Optimization Plan",systemStatus:"System Status",aiSystemOnline:"AI System Online",n8nReady:"n8n Integration Ready",activeAlerts:"Active Alerts",alertRainfall:"High rainfall expected at Mine Site B",alertMaintenance:"2 vehicles scheduled for maintenance",weatherData:"Weather Data",connected:"Connected",fleetTracking:"Fleet Tracking",online:"Online",aiEngine:"AI Engine",ready:"Ready",lastUpdate:"Last Updated",justNow:"Just now",active:"Active"},aiTools:{title:"AI Assistant",subtitle:"Ask questions about field conditions and get AI recommendations",aiOnline:"AI Online",responseTime:"Response time",suggestedPrompts:"Suggested Prompts",prompt1:"What is the impact of current rainfall on mining operations?",prompt2:"Recommend optimal fleet allocation for today",prompt3:"Analyze shipping delays due to high waves",integration:"Integration",integrationDesc:"Ready for n8n workflow integration and Lovable AI connection",connectedSystems:"Connected Systems",weather:"Weather",fleet:"Fleet",shipping:"Shipping",placeholder:"Ask about weather impact, fleet optimization, or production planning...",greeting:"Hello! I'm your AI Mining Operations Assistant. How can I help you optimize your operations today?"},dashboard:{title:"Operations Dashboard",subtitle:"Real-time monitoring and analytics",totalProduction:"Total Production",fromLastMonth:"from last month",activeEquipment:"Active Equipment",outOfTotal:"out of 48 total units",efficiencyRate:"Efficiency Rate",target:"Target",costSavings:"Cost Savings",thisQuarter:"This quarter",productionTrends:"Production Trends",equipmentStatus:"Equipment Status",chartPlaceholder:"Chart visualization here",statusPlaceholder:"Status overview here"},auth:{login:"Login",register:"Register",email:"Email",password:"Password",confirmPassword:"Confirm Password",fullName:"Full Name",role:"Role",forgotPassword:"Forgot Password?",signIn:"Sign In",createAccount:"Create Account",resetPassword:"Reset Password",resetDesc:"Enter your email address and we'll send you a link to reset your password.",sendResetLink:"Send Reset Link",backToLogin:"Back to Login",miningPlanner:"Mining Planner",shippingPlanner:"Shipping Planner",passwordRequirements:"Password Requirements:",minLength:"Minimum 6 characters",uppercase:"Uppercase letter (A-Z)",number:"Number (0-9)",weak:"Weak",medium:"Medium",fair:"Fair",strong:"Strong",passwordError:"Password must be at least 6 characters, contain uppercase letter and number!",passwordMismatch:"Passwords do not match!"},profile:{title:"Profile Settings",subtitle:"Manage your account preferences",accountInfo:"Account Information",displayName:"Display Name",email:"Email",preferences:"Preferences",darkMode:"Dark Mode",useDarkTheme:"Use dark theme",language:"Language",selectLanguage:"Select your language",signOut:"Sign Out",theme:"Theme",dark:"Dark",light:"Light"},common:{loading:"Loading...",error:"Error",success:"Success",save:"Save",cancel:"Cancel",confirm:"Confirm",delete:"Delete",edit:"Edit",view:"View",search:"Search",noData:"No data available",languageChanged:"Language changed to English",copyright:"© 2025 OptiMine. All rights reserved.",privacy:"Privacy",terms:"Terms",contact:"Contact"}},id:{nav:{home:"Beranda",planning:"Perencanaan",aiTools:"AI Tools",dashboard:"Dashboard",login:"Masuk",profile:"Profil",logout:"Keluar"},home:{welcomeBack:"Selamat Datang",subtitle:"Optimasi Rantai Nilai Pertambangan",activeSites:"Lokasi Aktif",fleetUnits:"Unit Armada",efficiency:"Efisiensi",quickAccess:"AKSES CEPAT",aiScenario:"Simulator Skenario AI",aiScenarioDesc:"Simulasikan berbagai skenario operasional dan hasilkan rekomendasi produksi & distribusi yang dioptimalkan berdasarkan kondisi lapangan real-time.",aiChatbot:"Chatbot Asisten AI",aiChatbotDesc:"Chatbot Q&A interaktif untuk kondisi lapangan, pertanyaan operasional, dan rekomendasi bertenaga AI dengan respons kontekstual.",opsDashboard:"Dashboard Operasi",opsDashboardDesc:"Visualisasi data komprehensif dengan pemantauan real-time, analitik, dan justifikasi untuk setiap rekomendasi AI.",accessDashboard:"Akses Dashboard",aiPoweredAnalysis:"Analisis Bertenaga AI",realtimeMonitoring:"Pemantauan Real-time",riskMitigation:"Mitigasi Risiko",costOptimization:"Optimasi Biaya"},planning:{title:"Perencanaan Produksi",subtitle:"Masukkan kondisi operasional untuk menghasilkan rencana yang dioptimalkan",weatherConditions:"Kondisi Cuaca",rainfallLevel:"Tingkat Curah Hujan",low:"Rendah",high:"Tinggi",waveHeight:"Tinggi Gelombang",calm:"Tenang",rough:"Bergelombang",fleetStatus:"Status Armada",activeVehicles:"Kendaraan Aktif",maintenanceStatus:"Status Perawatan",fleetAvailability:"Ketersediaan Armada",truckCount:"Jumlah Truk",excavatorCount:"Jumlah Excavator",shipSchedule:"Jadwal Kapal",vesselName:"Nama Kapal",estimatedArrival:"Perkiraan Kedatangan",cargoCapacity:"Kapasitas Kargo (ton)",addVessel:"Tambah Kapal",generatePlan:"Hasilkan Rencana Optimal",systemStatus:"Status Sistem",aiSystemOnline:"Sistem AI Online",n8nReady:"Integrasi n8n Siap",activeAlerts:"Peringatan Aktif",alertRainfall:"Curah hujan tinggi diperkirakan di Lokasi Tambang B",alertMaintenance:"2 kendaraan dijadwalkan untuk perawatan",weatherData:"Data Cuaca",connected:"Terhubung",fleetTracking:"Pelacakan Armada",online:"Online",aiEngine:"Mesin AI",ready:"Siap",lastUpdate:"Terakhir Diperbarui",justNow:"Baru saja",active:"Aktif"},aiTools:{title:"Asisten AI",subtitle:"Ajukan pertanyaan tentang kondisi lapangan dan dapatkan rekomendasi AI",aiOnline:"AI Online",responseTime:"Waktu respons",suggestedPrompts:"Prompt Disarankan",prompt1:"Apa dampak curah hujan saat ini terhadap operasi tambang?",prompt2:"Rekomendasikan alokasi armada optimal untuk hari ini",prompt3:"Analisis keterlambatan pengiriman akibat gelombang tinggi",integration:"Integrasi",integrationDesc:"Siap untuk integrasi alur kerja n8n dan koneksi Lovable AI",connectedSystems:"Sistem Terhubung",weather:"Cuaca",fleet:"Armada",shipping:"Pengiriman",placeholder:"Tanyakan tentang dampak cuaca, optimasi armada, atau perencanaan produksi...",greeting:"Halo! Saya Asisten AI Operasi Tambang Anda. Bagaimana saya bisa membantu mengoptimalkan operasi Anda hari ini?"},dashboard:{title:"Dashboard Operasi",subtitle:"Pemantauan dan analitik real-time",totalProduction:"Total Produksi",fromLastMonth:"dari bulan lalu",activeEquipment:"Peralatan Aktif",outOfTotal:"dari 48 unit total",efficiencyRate:"Tingkat Efisiensi",target:"Target",costSavings:"Penghematan Biaya",thisQuarter:"Kuartal ini",productionTrends:"Tren Produksi",equipmentStatus:"Status Peralatan",chartPlaceholder:"Visualisasi grafik di sini",statusPlaceholder:"Ringkasan status di sini"},auth:{login:"Masuk",register:"Daftar",email:"Email",password:"Kata Sandi",confirmPassword:"Konfirmasi Kata Sandi",fullName:"Nama Lengkap",role:"Peran",forgotPassword:"Lupa Kata Sandi?",signIn:"Masuk",createAccount:"Buat Akun",resetPassword:"Reset Kata Sandi",resetDesc:"Masukkan alamat email Anda dan kami akan mengirimkan link untuk mereset kata sandi.",sendResetLink:"Kirim Link Reset",backToLogin:"Kembali ke Login",miningPlanner:"Perencana Tambang",shippingPlanner:"Perencana Pengiriman",passwordRequirements:"Persyaratan Password:",minLength:"Minimal 6 karakter",uppercase:"Huruf kapital (A-Z)",number:"Angka (0-9)",weak:"Lemah",medium:"Sedang",fair:"Cukup Kuat",strong:"Kuat",passwordError:"Password harus minimal 6 karakter, mengandung huruf kapital dan angka!",passwordMismatch:"Password tidak cocok!"},profile:{title:"Pengaturan Profil",subtitle:"Kelola preferensi akun Anda",accountInfo:"Informasi Akun",displayName:"Nama Tampilan",email:"Email",preferences:"Preferensi",darkMode:"Mode Gelap",useDarkTheme:"Gunakan tema gelap",language:"Bahasa",selectLanguage:"Pilih bahasa Anda",signOut:"Keluar",theme:"Tema",dark:"Gelap",light:"Terang"},common:{loading:"Memuat...",error:"Kesalahan",success:"Berhasil",save:"Simpan",cancel:"Batal",confirm:"Konfirmasi",delete:"Hapus",edit:"Edit",view:"Lihat",search:"Cari",noData:"Tidak ada data",languageChanged:"Bahasa diubah ke Indonesia",copyright:"© 2025 OptiMine. Hak cipta dilindungi.",privacy:"Privasi",terms:"Ketentuan",contact:"Kontak"}}},n=(e,n)=>t[e]?.[n]||t.en?.[n]||{};const a=new class{constructor(){this.currentLanguage=this.getSavedLanguage(),this.listeners=[],this.isInitialized=!1}getSavedLanguage(){const e=localStorage.getItem("optimine-language");return!e||"en"!==e&&"id"!==e?(navigator.language.toLowerCase().startsWith("id"),"id"):e}init(){return this.isInitialized||(this.setLanguage(this.currentLanguage,!1),this.setupLanguageSwitcher(),this.isInitialized=!0,console.log("LanguageManager initialized. Current language:",this.currentLanguage)),this}get t(){return t[this.currentLanguage]||t.id}translate(e){const t=e.split(".");let n=this.t;for(const a of t){if(!n||void 0===n[a])return console.warn(`Translation not found: ${e}`),e;n=n[a]}return n}setLanguage(e,t=!0){"en"===e||"id"===e?(this.currentLanguage=e,localStorage.setItem("optimine-language",e),document.documentElement.setAttribute("lang",e),this.updateAllTranslations(),this.updateLanguageIndicator(),t&&this.notifyListeners()):console.error("Invalid language:",e)}toggleLanguage(){const e="en"===this.currentLanguage?"id":"en";return this.setLanguage(e),e}updateAllTranslations(){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n"),n=this.translate(t);n!==t&&(e.textContent=n)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const t=e.getAttribute("data-i18n-placeholder"),n=this.translate(t);n!==t&&e.setAttribute("placeholder",n)}),document.querySelectorAll("[data-i18n-title]").forEach(e=>{const t=e.getAttribute("data-i18n-title"),n=this.translate(t);n!==t&&e.setAttribute("title",n)}),document.querySelectorAll("[data-i18n-aria]").forEach(e=>{const t=e.getAttribute("data-i18n-aria"),n=this.translate(t);n!==t&&e.setAttribute("aria-label",n)})}updateLanguageIndicator(){document.querySelectorAll("[data-language-indicator]").forEach(e=>{e.textContent=this.currentLanguage.toUpperCase()}),document.querySelectorAll("[data-lang-button]").forEach(e=>{const t=e.getAttribute("data-lang-button")===this.currentLanguage;e.classList.toggle("bg-primary",t),e.classList.toggle("text-primary-foreground",t),e.classList.toggle("shadow-lg",t)}),document.querySelectorAll(".lang-option").forEach(e=>{const t=e.dataset.lang===this.currentLanguage;e.classList.toggle("bg-primary",t),e.classList.toggle("text-primary-foreground",t),e.classList.toggle("shadow-lg",t)})}setupLanguageSwitcher(){document.addEventListener("click",e=>{if(e.target.closest("[data-language-toggle]"))return e.preventDefault(),void this.toggleLanguage();const t=e.target.closest("[data-lang-button]");if(t){e.preventDefault();const n=t.getAttribute("data-lang-button");return void this.setLanguage(n)}const n=e.target.closest(".lang-option");if(n){e.preventDefault();const t=n.dataset.lang;t&&this.setLanguage(t)}})}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.currentLanguage,this.t)}catch(e){console.error("Language listener error:",e)}})}$(e){return this.translate(e)}},r={events:{},on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>this.off(e,t)},off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(e=>e!==t))},emit(e,t){this.events[e]&&this.events[e].forEach(e=>e(t))},once(e,t){const n=a=>{t(a),this.off(e,n)};this.on(e,n)}},s={fadeIn(e,t=300){e.style.opacity="0",e.style.display="block";let n=null;const a=r=>{n||(n=r);const s=Math.min((r-n)/t,1);e.style.opacity=s,s<1&&requestAnimationFrame(a)};requestAnimationFrame(a)},fadeOut(e,t=300){let n=null;const a=r=>{n||(n=r);const s=Math.min((r-n)/t,1);e.style.opacity=1-s,s<1?requestAnimationFrame(a):e.style.display="none"};requestAnimationFrame(a)},slideDown(e,t=300){e.style.height="0px",e.style.overflow="hidden",e.style.display="block";const n=e.scrollHeight;let a=null;const r=s=>{a||(a=s);const i=Math.min((s-a)/t,1);e.style.height=n*i+"px",i<1?requestAnimationFrame(r):(e.style.height="",e.style.overflow="")};requestAnimationFrame(r)},slideUp(e,t=300){const n=e.scrollHeight;e.style.height=`${n}px`,e.style.overflow="hidden";let a=null;const r=s=>{a||(a=s);const i=Math.min((s-a)/t,1);e.style.height=n*(1-i)+"px",i<1?requestAnimationFrame(r):(e.style.display="none",e.style.height="",e.style.overflow="")};requestAnimationFrame(r)},typewriter(e,t,n=100,a=null){e.textContent="",e.style.borderRight="2px solid currentColor",e.style.animation="blink-caret 0.75s step-end infinite";let r=0;const s=()=>{r<t.length?(e.textContent+=t.charAt(r),r++,setTimeout(s,n)):setTimeout(()=>{e.style.borderRight="none",e.style.animation="none",a&&a()},500)};s()},typewriterWelcome(e,t,n,a=80){e.innerHTML="";const r=document.createElement("span");r.className="typewriter-welcome";const s=document.createElement("span");s.className="typewriter-username text-primary",e.appendChild(r),e.appendChild(s),e.classList.add("typewriter-active");let i=0,o=0;const l=()=>{i<t.length?(r.textContent+=t.charAt(i),i++,setTimeout(l,a)):setTimeout(d,200)},d=()=>{o<n.length?(s.textContent+=n.charAt(o),o++,setTimeout(d,a)):setTimeout(()=>{e.classList.remove("typewriter-active"),e.classList.add("typewriter-complete")},500)};setTimeout(l,300)},countUp(e,t,n=2e3,a=""){const r=performance.now(),s=i=>{const o=i-r,l=Math.min(o/n,1),d=(u=l,1-Math.pow(1-u,4)),c=Math.floor(0+(t-0)*d);var u;e.textContent=c+a,l<1?requestAnimationFrame(s):(e.textContent=t+a,e.classList.add("complete"))};requestAnimationFrame(s)},initStatCounters(e=800){setTimeout(()=>{document.querySelectorAll(".stat-value[data-target]").forEach((e,t)=>{const n=parseInt(e.getAttribute("data-target"))||0,a=e.getAttribute("data-suffix")||"",r=parseInt(e.getAttribute("data-duration"))||2e3;e.textContent="0"+a,setTimeout(()=>{s.countUp(e,n,r,a)},200*t)})},e)}},i=()=>{const e=document.getElementById("welcome-title");if(!e)return;const t=(()=>{try{const e=localStorage.getItem("optimine-user");if(e){const t=JSON.parse(e);return t.name||t.nama||""}}catch(e){console.error("Error parsing user data:",e)}return""})();"true"===localStorage.getItem("optimine-logged-in")&&t?s.typewriterWelcome(e,"Welcome Back, ",t,70):s.typewriterWelcome(e,"Welcome to ","OptiMine",70)},o=async()=>{await q.View.render((()=>{const e=q.Model.getState("language")||"id",t=n(e,"home");return`\n<div class="min-h-[calc(100vh-4rem)] pt-6">\n    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">\n        \n        \x3c!-- ========================================\n             WELCOME SECTION\n        ======================================== --\x3e\n        <section class="mb-8 animate-fade-in stagger-1">\n            <div class="glass border border-border rounded-2xl p-6 md:p-8 border-glow">\n                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">\n                    \x3c!-- Left: Title & Subtitle --\x3e\n                    <div>\n                        <h1 id="welcome-title" class="font-heading text-2xl md:text-3xl font-bold text-foreground mb-2 welcome-typewriter">\n                            \x3c!-- Typewriter effect will be inserted here --\x3e\n                        </h1>\n                        <p class="text-muted-foreground">\n                            ${t.subtitle}\n                        </p>\n                    </div>\n                    \n                    \x3c!-- Right: Stats Cards --\x3e\n                    <div class="flex flex-wrap gap-3 lg:gap-4">\n                        \x3c!-- Active Sites --\x3e\n                        <div class="stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]">\n                            <p class="stat-value text-2xl lg:text-3xl font-bold text-primary" data-target="24" data-suffix="" data-duration="2000">0</p>\n                            <p class="text-xs text-muted-foreground uppercase tracking-wide">${t.activeSites}</p>\n                        </div>\n                        \x3c!-- Fleet Units --\x3e\n                        <div class="stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]">\n                            <p class="stat-value text-2xl lg:text-3xl font-bold text-emerald-400" data-target="156" data-suffix="" data-duration="2000">0</p>\n                            <p class="text-xs text-muted-foreground uppercase tracking-wide">${t.fleetUnits}</p>\n                        </div>\n                        \x3c!-- Efficiency --\x3e\n                        <div class="stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]">\n                            <p class="stat-value text-2xl lg:text-3xl font-bold text-orange-400" data-target="98" data-suffix="%" data-duration="2000">0%</p>\n                            <p class="text-xs text-muted-foreground uppercase tracking-wide">${t.efficiency}</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </section>\n\n        \x3c!-- ========================================\n             QUICK ACCESS SECTION\n        ======================================== --\x3e\n        <section class="mb-8">\n            <h2 class="text-sm font-semibold text-muted-foreground uppercase tracking-wider mb-4">\n                ${t.quickAccess}\n            </h2>\n            <div class="grid md:grid-cols-3 gap-4">\n                \n                \x3c!-- Card 1: AI Scenario Simulator --\x3e\n                <a href="#planning" class="glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-2">\n                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg">\n                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />\n                        </svg>\n                    </div>\n                    <h3 class="font-semibold text-foreground mb-2">${t.aiScenario}</h3>\n                    <p class="text-sm text-muted-foreground mb-4 leading-relaxed">\n                        ${t.aiScenarioDesc}\n                    </p>\n                    <span class="text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300">\n                        ${t.accessDashboard}\n                        <svg class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />\n                        </svg>\n                    </span>\n                </a>\n\n                \x3c!-- Card 2: AI Assistant Chatbot --\x3e\n                <a href="#ai-tools" class="glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-3">\n                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg">\n                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />\n                        </svg>\n                    </div>\n                    <h3 class="font-semibold text-foreground mb-2">${t.aiChatbot}</h3>\n                    <p class="text-sm text-muted-foreground mb-4 leading-relaxed">\n                        ${t.aiChatbotDesc}\n                    </p>\n                    <span class="text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300">\n                        ${t.accessDashboard}\n                        <svg class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />\n                        </svg>\n                    </span>\n                </a>\n\n                \x3c!-- Card 3: Operations Dashboard --\x3e\n                <a href="#dashboard" class="glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-4">\n                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-primary flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg">\n                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />\n                        </svg>\n                    </div>\n                    <h3 class="font-semibold text-foreground mb-2">${t.opsDashboard}</h3>\n                    <p class="text-sm text-muted-foreground mb-4 leading-relaxed">\n                        ${t.opsDashboardDesc}\n                    </p>\n                    <span class="text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300">\n                        ${t.accessDashboard}\n                        <svg class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />\n                        </svg>\n                    </span>\n                </a>\n            </div>\n        </section>\n\n        \x3c!-- ========================================\n             CAPABILITIES SECTION\n        ======================================== --\x3e\n        <section class="mb-8 animate-fade-in stagger-5">\n            <div class="flex flex-wrap justify-center gap-3">\n                \x3c!-- AI-Powered Analysis --\x3e\n                <div class="rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default">\n                    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />\n                    </svg>\n                    <span class="text-sm text-muted-foreground">${t.aiPoweredAnalysis}</span>\n                </div>\n                \n                \x3c!-- Real-time Monitoring --\x3e\n                <div class="rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default">\n                    <svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />\n                    </svg>\n                    <span class="text-sm text-muted-foreground">${t.realtimeMonitoring}</span>\n                </div>\n                \n                \x3c!-- Risk Mitigation --\x3e\n                <div class="rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default">\n                    <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />\n                    </svg>\n                    <span class="text-sm text-muted-foreground">${t.riskMitigation}</span>\n                </div>\n                \n                \x3c!-- Cost Optimization --\x3e\n                <div class="rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default">\n                    <svg class="w-4 h-4 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />\n                    </svg>\n                    <span class="text-sm text-muted-foreground">${t.costOptimization}</span>\n                </div>\n            </div>\n        </section>\n        \n    </div>\n</div>\n`})(),"home"),setTimeout(i,100),s.initStatCounters(800)},l={planning:()=>{const e=q.Model.getState("language")||"id",t=n(e,"planning");return`\n    <div class="min-h-[calc(100vh-4rem)] pt-6 relative">\n        \x3c!-- Background Effects --\x3e\n        <div class="absolute inset-0 -z-10 overflow-hidden">\n            <div class="radial-gradient absolute inset-0"></div>\n            <div class="absolute top-20 right-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"></div>\n            <div class="absolute bottom-20 left-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"></div>\n        </div>\n        \n        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">\n            \x3c!-- Header --\x3e\n            <div class="mb-8 animate-fade-in">\n                <h1 class="font-heading text-3xl md:text-4xl font-bold text-foreground">\n                    ${t.title}\n                </h1>\n                <p class="text-muted-foreground mt-2">\n                    ${t.subtitle}\n                </p>\n            </div>\n\n            \x3c!-- Main Grid: 2/3 Input, 1/3 Status --\x3e\n            <div class="grid lg:grid-cols-3 gap-6">\n                \n                \x3c!-- LEFT: Input Section (2/3) --\x3e\n                <div class="lg:col-span-2 space-y-6">\n                    \n                    \x3c!-- Weather Conditions Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-1">\n                        <h2 class="font-semibold text-lg text-foreground mb-6 flex items-center gap-2">\n                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />\n                            </svg>\n                            ${t.weatherConditions}\n                        </h2>\n                        \n                        <div class="space-y-6">\n                            \x3c!-- Rainfall Level Slider --\x3e\n                            <div>\n                                <label class="block text-sm font-medium text-muted-foreground mb-3">${t.rainfallLevel}</label>\n                                <input \n                                    type="range" \n                                    min="0" \n                                    max="100" \n                                    value="50"\n                                    class="w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer slider-primary"\n                                >\n                                <div class="flex justify-between text-xs text-muted-foreground mt-2">\n                                    <span>${t.low}</span>\n                                    <span>${t.high}</span>\n                                </div>\n                            </div>\n                            \n                            \x3c!-- Wave Height Slider --\x3e\n                            <div>\n                                <label class="block text-sm font-medium text-muted-foreground mb-3">${t.waveHeight}</label>\n                                <input \n                                    type="range" \n                                    min="0" \n                                    max="100" \n                                    value="35"\n                                    class="w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer slider-primary"\n                                >\n                                <div class="flex justify-between text-xs text-muted-foreground mt-2">\n                                    <span>${t.calm}</span>\n                                    <span>${t.rough}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Fleet Status Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-2">\n                        <h2 class="font-semibold text-lg text-foreground mb-6 flex items-center gap-2">\n                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />\n                            </svg>\n                            ${t.fleetStatus}\n                        </h2>\n                        \n                        <div class="grid grid-cols-2 gap-4">\n                            <div>\n                                <label class="block text-sm font-medium text-muted-foreground mb-2">${t.activeVehicles}</label>\n                                <input \n                                    type="number" \n                                    value="25"\n                                    class="w-full px-4 py-3 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all"\n                                >\n                            </div>\n                            <div>\n                                <label class="block text-sm font-medium text-muted-foreground mb-2">${t.maintenanceStatus}</label>\n                                <input \n                                    type="number" \n                                    value="3"\n                                    class="w-full px-4 py-3 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all"\n                                >\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Ship Schedule Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-3">\n                        <h2 class="font-semibold text-lg text-foreground mb-6 flex items-center gap-2">\n                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 13h2m-2 4h2m-2-8h2m4 8v-2a2 2 0 012-2h6a2 2 0 012 2v2M7 9V7a2 2 0 012-2h6a2 2 0 012 2v2m-4 4h.01M12 17h.01" />\n                            </svg>\n                            ${t.shipSchedule}\n                        </h2>\n                        \n                        <div class="space-y-3">\n                            <div class="flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg">\n                                <span class="text-foreground">Vessel A - 08:00</span>\n                                <span class="px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full">${t.active}</span>\n                            </div>\n                            <div class="flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg">\n                                <span class="text-foreground">Vessel B - 14:00</span>\n                                <span class="px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full">${t.active}</span>\n                            </div>\n                            <div class="flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg">\n                                <span class="text-foreground">Vessel C - 20:00</span>\n                                <span class="px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full">${t.active}</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Generate Button --\x3e\n                    <button class="w-full h-14 bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2 glow-hover animate-fade-in stagger-4">\n                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />\n                        </svg>\n                        ${t.generatePlan}\n                    </button>\n                </div>\n                \n                \x3c!-- RIGHT: Status Panel (1/3) --\x3e\n                <div class="lg:col-span-1 space-y-6">\n                    \n                    \x3c!-- System Status Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 border-glow animate-fade-in stagger-2">\n                        <h2 class="font-semibold text-lg text-foreground mb-6 flex items-center gap-2">\n                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />\n                            </svg>\n                            ${t.systemStatus}\n                        </h2>\n                        \n                        <div class="space-y-3">\n                            <div class="flex items-center gap-3 p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg">\n                                <span class="relative flex h-3 w-3">\n                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>\n                                    <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>\n                                </span>\n                                <span class="text-emerald-400 font-medium">${t.aiSystemOnline}</span>\n                            </div>\n                            <div class="flex items-center gap-3 p-3 bg-primary/10 border border-primary/30 rounded-lg">\n                                <span class="relative flex h-3 w-3">\n                                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"></span>\n                                    <span class="relative inline-flex rounded-full h-3 w-3 bg-primary"></span>\n                                </span>\n                                <span class="text-primary font-medium">${t.n8nReady}</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Active Alerts Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-3">\n                        <h2 class="font-semibold text-lg text-foreground mb-6 flex items-center gap-2">\n                            <svg class="w-5 h-5 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\n                            </svg>\n                            ${t.activeAlerts}\n                        </h2>\n                        \n                        <div class="space-y-3">\n                            <div class="p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg">\n                                <p class="text-amber-400 text-sm">${t.alertRainfall}</p>\n                            </div>\n                            <div class="p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg">\n                                <p class="text-orange-400 text-sm">${t.alertMaintenance}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                </div>\n            </div>\n        </div>\n    </div>\n    `},"ai-tools":()=>{const e=q.Model.getState("language")||"id",t=n(e,"aiTools");return`\n    <div class="h-[calc(100vh-4rem)] pt-6">\n        <div class="h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">\n            \x3c!-- Header --\x3e\n            <div class="mb-6 animate-fade-in">\n                <h1 class="font-heading text-3xl md:text-4xl font-bold text-foreground">${t.title}</h1>\n                <p class="text-muted-foreground mt-1">${t.subtitle}</p>\n            </div>\n            \n            \x3c!-- Main Grid: Chat 3/4, Sidebar 1/4 --\x3e\n            <div class="grid lg:grid-cols-4 gap-6 h-[calc(100%-6rem)]">\n                \n                \x3c!-- CHAT AREA (3/4) --\x3e\n                <div class="lg:col-span-3 flex flex-col glass border border-border rounded-xl overflow-hidden animate-fade-in stagger-1">\n                    \n                    \x3c!-- Messages Area --\x3e\n                    <div class="flex-1 overflow-y-auto p-6 space-y-4" id="chat-messages">\n                        \n                        \x3c!-- AI Message --\x3e\n                        <div class="flex items-start gap-3">\n                            <div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0">\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                </svg>\n                            </div>\n                            <div class="flex-1 max-w-[85%]">\n                                <div class="bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4">\n                                    <p class="text-foreground">${t.greeting}</p>\n                                </div>\n                                <span class="text-xs text-muted-foreground mt-1 block">12:29 PM</span>\n                            </div>\n                        </div>\n                        \n                    </div>\n                    \n                    \x3c!-- Input Area --\x3e\n                    <div class="border-t border-border p-4">\n                        <div class="flex gap-3">\n                            <input \n                                type="text" \n                                id="chat-input"\n                                placeholder="${t.placeholder}" \n                                class="flex-1 px-4 py-3 bg-secondary/30 border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all"\n                            >\n                            <button id="send-btn" class="px-5 py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl transition-all duration-300 glow-hover flex items-center justify-center">\n                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />\n                                </svg>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n                \n                \x3c!-- SIDEBAR (1/4) --\x3e\n                <div class="lg:col-span-1 space-y-4">\n                    \n                    \x3c!-- AI Status Card --\x3e\n                    <div class="glass border border-border rounded-xl p-4 border-glow animate-fade-in stagger-2">\n                        <div class="flex items-center gap-2 mb-2">\n                            <span class="relative flex h-3 w-3">\n                                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>\n                                <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>\n                            </span>\n                            <span class="text-emerald-400 font-semibold">${t.aiOnline}</span>\n                        </div>\n                        <div class="flex items-center gap-2 text-sm text-muted-foreground">\n                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />\n                            </svg>\n                            <span>${t.responseTime}: &lt;2s</span>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Suggested Prompts Card --\x3e\n                    <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-3">\n                        <h3 class="font-semibold text-foreground mb-3 flex items-center gap-2">\n                            <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />\n                            </svg>\n                            ${t.suggestedPrompts}\n                        </h3>\n                        <div class="space-y-2">\n                            <button class="suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all">\n                                ${t.prompt1}\n                            </button>\n                            <button class="suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all">\n                                ${t.prompt2}\n                            </button>\n                            <button class="suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all">\n                                ${t.prompt3}\n                            </button>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Integration Info Card --\x3e\n                    <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-4">\n                        <h3 class="font-semibold text-foreground mb-2 flex items-center gap-2">\n                            <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />\n                            </svg>\n                            ${t.integration}\n                        </h3>\n                        <p class="text-xs text-muted-foreground">\n                            ${t.integrationDesc}\n                        </p>\n                    </div>\n                    \n                </div>\n            </div>\n        </div>\n    </div>\n    `},dashboard:()=>{const e=q.Model.getState("language")||"id",t=n(e,"dashboard");return`\n    <div class="min-h-screen pt-6 pb-8 px-4 sm:px-6 lg:px-8">\n        <div class="max-w-7xl mx-auto">\n            <div class="mb-8 animate-fade-in">\n                <h1 class="font-heading text-3xl md:text-4xl font-bold text-foreground">\n                    ${t.title}\n                </h1>\n                <p class="text-muted-foreground mt-2">\n                    ${t.subtitle}\n                </p>\n            </div>\n\n            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">\n                <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-1">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-sm text-muted-foreground">${t.totalProduction}</span>\n                        <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>\n                    </div>\n                    <p class="text-2xl font-bold text-foreground">24,580</p>\n                    <p class="text-xs text-green-500">+12.5% ${t.fromLastMonth}</p>\n                </div>\n                \n                <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-2">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-sm text-muted-foreground">${t.activeEquipment}</span>\n                        <i data-lucide="truck" class="w-4 h-4 text-primary"></i>\n                    </div>\n                    <p class="text-2xl font-bold text-foreground">42</p>\n                    <p class="text-xs text-muted-foreground">${t.outOfTotal}</p>\n                </div>\n                \n                <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-3">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-sm text-muted-foreground">${t.efficiencyRate}</span>\n                        <i data-lucide="gauge" class="w-4 h-4 text-amber-500"></i>\n                    </div>\n                    <p class="text-2xl font-bold text-foreground">94.2%</p>\n                    <p class="text-xs text-amber-500">${t.target}: 95%</p>\n                </div>\n                \n                <div class="glass border border-border rounded-xl p-4 animate-fade-in stagger-4">\n                    <div class="flex items-center justify-between mb-2">\n                        <span class="text-sm text-muted-foreground">${t.costSavings}</span>\n                        <i data-lucide="dollar-sign" class="w-4 h-4 text-green-500"></i>\n                    </div>\n                    <p class="text-2xl font-bold text-foreground">$1.2M</p>\n                    <p class="text-xs text-green-500">${t.thisQuarter}</p>\n                </div>\n            </div>\n\n            <div class="grid lg:grid-cols-2 gap-6">\n                <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-5">\n                    <h3 class="font-semibold text-foreground mb-4 flex items-center gap-2">\n                        <i data-lucide="line-chart" class="w-5 h-5 text-primary"></i>\n                        ${t.productionTrends}\n                    </h3>\n                    <div class="h-64 flex items-center justify-center bg-secondary/20 rounded-lg">\n                        <p class="text-muted-foreground">${t.chartPlaceholder}</p>\n                    </div>\n                </div>\n                \n                <div class="glass border border-border rounded-xl p-6 animate-fade-in stagger-5">\n                    <h3 class="font-semibold text-foreground mb-4 flex items-center gap-2">\n                        <i data-lucide="truck" class="w-5 h-5 text-primary"></i>\n                        ${t.equipmentStatus}\n                    </h3>\n                    <div class="h-64 flex items-center justify-center bg-secondary/20 rounded-lg">\n                        <p class="text-muted-foreground">${t.statusPlaceholder}</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    `},auth:()=>{const e=localStorage.getItem("optimine-language")||"id",t=n(e,"auth");return`\n    <div class="min-h-screen flex items-center justify-center px-4 pt-6 pb-8">\n        <div class="w-full max-w-md">\n            \x3c!-- Main Auth Card --\x3e\n            <div id="auth-card" class="glass border border-border rounded-2xl p-6 sm:p-8 animate-scale-in">\n                \x3c!-- Header with Logo --\x3e\n                <div class="text-center mb-6">\n                    <img \n                        src="assets/images/b (192 x 192 piksel) (1).png" \n                        alt="OptiMine Logo" \n                        class="w-16 h-16 mx-auto mb-4 rounded-full border-2 border-amber-500/50 shadow-lg"\n                    >\n                    <h1 class="font-heading text-2xl font-bold">\n                        <span class="text-primary">Opti</span><span class="text-foreground">Mine</span>\n                    </h1>\n                    <p class="text-sm text-muted-foreground mt-1">Mining Value Chain Optimization Platform</p>\n                </div>\n                \n                \x3c!-- Tab Navigation --\x3e\n                <div class="grid grid-cols-2 bg-secondary/50 border border-border rounded-lg p-1 mb-6">\n                    <button id="login-tab" class="auth-tab active py-2.5 px-4 text-sm font-medium rounded-md transition-all duration-300">\n                        ${t.login}\n                    </button>\n                    <button id="register-tab" class="auth-tab py-2.5 px-4 text-sm font-medium rounded-md transition-all duration-300">\n                        ${t.register}\n                    </button>\n                </div>\n                \n                \x3c!-- LOGIN FORM --\x3e\n                <form id="login-form" class="space-y-4">\n                    \x3c!-- Email --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.email}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="email" \n                                id="login-email" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="email@example.com"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Password --\x3e\n                    <div>\n                        <div class="flex items-center justify-between mb-2">\n                            <label class="block text-sm font-medium text-foreground">${t.password}</label>\n                            <button type="button" id="forgot-password-btn" class="text-xs text-primary hover:text-primary/80 transition-colors">\n                                ${t.forgotPassword}\n                            </button>\n                        </div>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="password" \n                                id="login-password" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="••••••••"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Submit Button --\x3e\n                    <button \n                        type="submit" \n                        class="w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover mt-6"\n                    >\n                        ${t.signIn}\n                    </button>\n                </form>\n                \n                \x3c!-- REGISTER FORM --\x3e\n                <form id="register-form" class="space-y-4 hidden">\n                    \x3c!-- Full Name --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.fullName}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="text" \n                                id="register-name" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="John Doe"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Email --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.email}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="email" \n                                id="register-email" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="email@example.com"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Password --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.password}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="password" \n                                id="register-password" \n                                required \n                                minlength="6"\n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="••••••••"\n                            >\n                        </div>\n                        \x3c!-- Password Strength Container (hidden by default) --\x3e\n                        <div id="password-info-container" class="hidden mt-3 p-3 bg-secondary/30 border border-border rounded-lg animate-fade-in">\n                            \x3c!-- Password Strength Indicator --\x3e\n                            <div id="password-strength-container" class="hidden mb-3">\n                                <div class="flex gap-1 mb-1">\n                                    <div id="strength-bar-1" class="h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300"></div>\n                                    <div id="strength-bar-2" class="h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300"></div>\n                                    <div id="strength-bar-3" class="h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300"></div>\n                                    <div id="strength-bar-4" class="h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300"></div>\n                                </div>\n                                <p id="password-strength-text" class="text-xs font-medium"></p>\n                            </div>\n                            \x3c!-- Password Requirements --\x3e\n                            <div id="password-requirements" class="space-y-1.5 text-xs">\n                                <p id="req-title" class="text-muted-foreground font-medium mb-2"></p>\n                                <p id="req-length" class="flex items-center gap-2 text-muted-foreground">\n                                    <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <circle cx="12" cy="12" r="10" stroke-width="2"/>\n                                    </svg>\n                                    <span></span>\n                                </p>\n                                <p id="req-uppercase" class="flex items-center gap-2 text-muted-foreground">\n                                    <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <circle cx="12" cy="12" r="10" stroke-width="2"/>\n                                    </svg>\n                                    <span></span>\n                                </p>\n                                <p id="req-number" class="flex items-center gap-2 text-muted-foreground">\n                                    <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <circle cx="12" cy="12" r="10" stroke-width="2"/>\n                                    </svg>\n                                    <span></span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Confirm Password --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.confirmPassword}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="password" \n                                id="register-confirm-password" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="••••••••"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Role Dropdown --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.role}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />\n                                </svg>\n                            </div>\n                            <select \n                                id="register-role" \n                                required \n                                class="w-full pl-10 pr-10 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none cursor-pointer"\n                            >\n                                <option value="mine_planner">${t.miningPlanner}</option>\n                                <option value="shipping_planner">${t.shippingPlanner}</option>\n                            </select>\n                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />\n                                </svg>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Submit Button --\x3e\n                    <button \n                        type="submit" \n                        class="w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover mt-2"\n                    >\n                        ${t.createAccount}\n                    </button>\n                </form>\n            </div>\n            \n            \x3c!-- FORGOT PASSWORD CARD --\x3e\n            <div id="forgot-password-card" class="glass border border-border rounded-2xl p-6 sm:p-8 animate-scale-in hidden">\n                \x3c!-- Header --\x3e\n                <div class="text-center mb-6">\n                    <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-primary/20 flex items-center justify-center">\n                        <svg class="w-8 h-8 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />\n                        </svg>\n                    </div>\n                    <h2 class="font-heading text-xl font-bold text-foreground">${t.resetPassword}</h2>\n                    <p class="text-sm text-muted-foreground mt-2">${t.resetDesc}</p>\n                </div>\n                \n                <form id="forgot-password-form" class="space-y-4">\n                    \x3c!-- Email --\x3e\n                    <div>\n                        <label class="block text-sm font-medium text-foreground mb-2">${t.email}</label>\n                        <div class="relative">\n                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                </svg>\n                            </div>\n                            <input \n                                type="email" \n                                id="forgot-email" \n                                required \n                                class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all" \n                                placeholder="email@example.com"\n                            >\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Submit Button --\x3e\n                    <button \n                        type="submit" \n                        class="w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover"\n                    >\n                        ${t.sendResetLink}\n                    </button>\n                    \n                    \x3c!-- Back to Login --\x3e\n                    <button \n                        type="button" \n                        id="back-to-login-btn"\n                        class="w-full py-3 bg-secondary/50 hover:bg-secondary/70 text-foreground border border-border rounded-lg font-medium transition-all duration-300"\n                    >\n                        ${t.backToLogin}\n                    </button>\n                </form>\n            </div>\n        </div>\n    </div>\n    `},profile:()=>{const e=JSON.parse(localStorage.getItem("optimine-user")||"{}"),t=localStorage.getItem("optimine-theme")||"dark",a=localStorage.getItem("optimine-language")||"id",r=n(a,"profile");return`\n        <div class="min-h-screen pt-6 pb-8 px-4 sm:px-6 lg:px-8">\n            <div class="max-w-2xl mx-auto">\n                <div class="mb-8 animate-fade-in">\n                    <h1 class="font-heading text-3xl md:text-4xl font-bold text-foreground">\n                        ${r.title}\n                    </h1>\n                    <p class="text-muted-foreground mt-2">\n                        ${r.subtitle}\n                    </p>\n                </div>\n\n                <div class="glass border border-border rounded-xl p-6 mb-6 animate-fade-in stagger-1">\n                    <div class="flex items-center gap-4 mb-6">\n                        <div class="w-20 h-20 rounded-full bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white text-2xl font-bold">\n                            ${(e.name||"U").charAt(0).toUpperCase()}\n                        </div>\n                        <div>\n                            <h2 class="text-xl font-semibold text-foreground">${e.name||"User"}</h2>\n                            <p class="text-muted-foreground">${e.email||"user@example.com"}</p>\n                            <span class="inline-block mt-1 px-2 py-0.5 text-xs bg-primary/10 text-primary rounded-full">${e.role||"member"}</span>\n                        </div>\n                    </div>\n                    \n                    <div class="space-y-4">\n                        <div>\n                            <label class="block text-sm font-medium text-foreground mb-1">${r.displayName}</label>\n                            <input type="text" value="${e.name||""}" class="w-full px-4 py-2.5 bg-secondary/50 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">\n                        </div>\n                        <div>\n                            <label class="block text-sm font-medium text-foreground mb-1">${r.email}</label>\n                            <input type="email" value="${e.email||""}" disabled class="w-full px-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-muted-foreground">\n                        </div>\n                    </div>\n                </div>\n\n                <div class="glass border border-border rounded-xl p-6 mb-6 animate-fade-in stagger-2">\n                    <h3 class="font-semibold text-foreground mb-4">${r.preferences}</h3>\n                    \n                    <div class="space-y-4">\n                        <div class="flex items-center justify-between">\n                            <div>\n                                <p class="font-medium text-foreground">${r.darkMode}</p>\n                                <p class="text-sm text-muted-foreground">${r.useDarkTheme}</p>\n                            </div>\n                            <button id="profile-theme-toggle" class="relative w-12 h-6 bg-secondary rounded-full transition-colors ${"dark"===t?"bg-primary/30":""}">\n                                <span class="absolute left-1 top-1 w-4 h-4 bg-foreground rounded-full transition-transform ${"dark"===t?"translate-x-6 bg-primary":""}"></span>\n                            </button>\n                        </div>\n                        \n                        <div class="flex items-center justify-between">\n                            <div>\n                                <p class="font-medium text-foreground">${r.language}</p>\n                                <p class="text-sm text-muted-foreground">${r.selectLanguage}</p>\n                            </div>\n                            <div class="flex gap-2">\n                                <button class="profile-lang-btn px-3 py-1.5 text-sm rounded-md transition-colors ${"en"===a?"bg-primary/10 text-primary":"hover:bg-secondary/50"}" data-lang="en">🇬🇧 EN</button>\n                                <button class="profile-lang-btn px-3 py-1.5 text-sm rounded-md transition-colors ${"id"===a?"bg-primary/10 text-primary":"hover:bg-secondary/50"}" data-lang="id">🇮🇩 ID</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <button id="logout-btn" class="w-full py-2.5 border border-red-500/50 text-red-500 hover:bg-red-500/10 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 animate-fade-in stagger-3">\n                    <i data-lucide="log-out" class="w-4 h-4"></i>\n                    ${r.signOut}\n                </button>\n            </div>\n        </div>\n        `}},d=async e=>{const t=T.getCurrentRoute(),n=l[t]||l.planning;await q.View.render("function"==typeof n?n():n,t),"auth"===t?(()=>{const e=document.getElementById("login-tab"),t=document.getElementById("register-tab");let n=document.getElementById("login-form"),a=document.getElementById("register-form");const r=document.getElementById("auth-card"),s=document.getElementById("forgot-password-card"),i=document.getElementById("forgot-password-btn"),o=document.getElementById("back-to-login-btn"),l=document.getElementById("forgot-password-form");if(n){const e=n.cloneNode(!0);n.replaceWith(e),n=e}if(a){const e=a.cloneNode(!0);a.replaceWith(e),a=e}e?.addEventListener("click",()=>{e.classList.add("active"),t?.classList.remove("active"),n?.classList.remove("hidden"),a?.classList.add("hidden")}),t?.addEventListener("click",()=>{t.classList.add("active"),e?.classList.remove("active"),a?.classList.remove("hidden"),n?.classList.add("hidden")});const d=document.getElementById("register-password"),c=document.getElementById("password-info-container"),u=document.getElementById("password-strength-container"),m=document.getElementById("password-strength-text"),g=[document.getElementById("strength-bar-1"),document.getElementById("strength-bar-2"),document.getElementById("strength-bar-3"),document.getElementById("strength-bar-4")],p=document.getElementById("req-title"),h=document.getElementById("req-length"),f=document.getElementById("req-uppercase"),v=document.getElementById("req-number"),x=()=>{const e=localStorage.getItem("optimine-language")||"id";return window.getSection?window.getSection(e,"auth"):{passwordRequirements:"en"===e?"Password Requirements:":"Persyaratan Password:",minLength:"en"===e?"Minimum 6 characters":"Minimal 6 karakter",uppercase:"en"===e?"Uppercase letter (A-Z)":"Huruf kapital (A-Z)",number:"en"===e?"Number (0-9)":"Angka (0-9)",weak:"en"===e?"Weak":"Lemah",medium:"en"===e?"Medium":"Sedang",fair:"en"===e?"Fair":"Cukup Kuat",strong:"en"===e?"Strong":"Kuat",passwordError:"en"===e?"Password must be at least 6 characters, contain uppercase letter and number!":"Password harus minimal 6 karakter, mengandung huruf kapital dan angka!",passwordMismatch:"en"===e?"Passwords do not match!":"Password tidak cocok!"}},b=(e,t,n)=>{e&&(t?(e.classList.remove("text-muted-foreground"),e.classList.add("text-green-500"),e.innerHTML=`\n                <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>\n                </svg>\n                <span>${n}</span>\n            `):(e.classList.add("text-muted-foreground"),e.classList.remove("text-green-500"),e.innerHTML=`\n                <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <circle cx="12" cy="12" r="10" stroke-width="2"/>\n                </svg>\n                <span>${n}</span>\n            `))},y=e=>{const t=x(),n={0:{bar:"bg-secondary",text:"",label:""},1:{bar:"bg-red-500",text:"text-red-500",label:t.weak},2:{bar:"bg-orange-500",text:"text-orange-500",label:t.medium},3:{bar:"bg-yellow-500",text:"text-yellow-500",label:t.fair},4:{bar:"bg-green-500",text:"text-green-500",label:t.strong}}[e];g.forEach((t,a)=>{t&&(t.className="h-1.5 flex-1 rounded-full transition-colors duration-300",a<e?t.classList.add(n.bar):t.classList.add("bg-secondary"))}),m&&(m.textContent=n.label,m.className=`text-xs font-medium ${n.text}`)};d?.addEventListener("focus",()=>{(()=>{const e=x();p&&(p.textContent=e.passwordRequirements),h&&(h.querySelector("span").textContent=e.minLength),f&&(f.querySelector("span").textContent=e.uppercase),v&&(v.querySelector("span").textContent=e.number)})(),c?.classList.remove("hidden")}),d?.addEventListener("blur",()=>{d.value||(c?.classList.add("hidden"),u?.classList.add("hidden"))}),d?.addEventListener("input",e=>{const t=e.target.value,n=x();if(c?.classList.remove("hidden"),t.length>0){u?.classList.remove("hidden");const{strength:e}=(e=>{const t=x();let n=0;const a={length:e.length>=6,uppercase:/[A-Z]/.test(e),number:/[0-9]/.test(e),special:/[!@#$%^&*(),.?":{}|<>]/.test(e),lowercase:/[a-z]/.test(e)};return b(h,a.length,t.minLength),b(f,a.uppercase,t.uppercase),b(v,a.number,t.number),a.length&&n++,a.uppercase&&n++,a.number&&n++,(a.special||a.lowercase&&e.length>=8)&&n++,{strength:n,checks:a}})(t);y(e)}else u?.classList.add("hidden"),y(0),b(h,!1,n.minLength),b(f,!1,n.uppercase),b(v,!1,n.number)}),i?.addEventListener("click",()=>{r?.classList.add("hidden"),s?.classList.remove("hidden")}),o?.addEventListener("click",()=>{s?.classList.add("hidden"),r?.classList.remove("hidden"),e?.classList.add("active"),t?.classList.remove("active"),n?.classList.remove("hidden"),a?.classList.add("hidden")}),n?.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("login-email")?.value,a=document.getElementById("login-password")?.value,r=n.querySelector('button[type="submit"]'),s=r?.innerHTML;r&&(r.innerHTML='\n                <svg class="animate-spin h-5 w-5 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                </svg>\n            ',r.disabled=!0),await q.Presenter.handleLogin(t,a),r&&(r.innerHTML=s,r.disabled=!1)}),a?.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("register-name")?.value,n=document.getElementById("register-email")?.value,r=document.getElementById("register-password")?.value,s=document.getElementById("register-confirm-password")?.value,i=document.getElementById("register-role")?.value,o=(x(),r.length>=6),l=/[A-Z]/.test(r),d=/[0-9]/.test(r);if(!o||!l||!d)return;if(r!==s)return;const c=a.querySelector('button[type="submit"]'),u=c?.innerHTML;c&&(c.innerHTML='\n                <svg class="animate-spin h-5 w-5 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                </svg>\n            ',c.disabled=!0),await q.Presenter.handleRegister(t,n,r,i),c&&(c.innerHTML=u,c.disabled=!1)}),l?.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("forgot-email")?.value,n=l.querySelector('button[type="submit"]'),a=n?.innerHTML;n&&(n.innerHTML='\n                <svg class="animate-spin h-5 w-5 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                </svg>\n            ',n.disabled=!0),await new Promise(e=>setTimeout(e,1500)),alert(`Password reset link sent to ${t}`),n&&(n.innerHTML=a,n.disabled=!1),s?.classList.add("hidden"),r?.classList.remove("hidden")})})():"profile"===t?(()=>{let e=document.getElementById("logout-btn"),t=document.getElementById("profile-theme-toggle");const n=document.querySelectorAll(".profile-lang-btn");if(e){const t=e.cloneNode(!0);e.replaceWith(t),e=t}if(t){const e=t.cloneNode(!0);t.replaceWith(e),t=e}e?.addEventListener("click",()=>{q.Presenter.handleLogout()}),t?.addEventListener("click",()=>{q.Model.toggleTheme();const e=t.querySelector("span"),n="dark"===q.Model.getState("theme");e?.classList.toggle("translate-x-6",n),e?.classList.toggle("bg-primary",n),t.classList.toggle("bg-primary/30",n)}),n.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.lang;q.Model.setLanguage(t),T.handleRouteChange()})})})():"ai-tools"===t&&(()=>{const e=document.getElementById("chat-input"),t=document.getElementById("send-btn"),n=document.getElementById("chat-messages"),a=document.querySelectorAll(".suggested-prompt"),r=(e,t=!1)=>{const a=(new Date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),r=t?`\n            <div class="flex items-start gap-3 justify-end">\n                <div class="flex-1 max-w-[85%] flex flex-col items-end">\n                    <div class="bg-primary text-primary-foreground rounded-2xl rounded-br-sm p-4">\n                        <p>${e}</p>\n                    </div>\n                    <span class="text-xs text-muted-foreground mt-1">${a}</span>\n                </div>\n                <div class="w-10 h-10 rounded-lg bg-secondary flex items-center justify-center flex-shrink-0">\n                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />\n                    </svg>\n                </div>\n            </div>\n        `:`\n            <div class="flex items-start gap-3">\n                <div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0">\n                    <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                    </svg>\n                </div>\n                <div class="flex-1 max-w-[85%]">\n                    <div class="bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4">\n                        <p class="text-foreground">${e}</p>\n                    </div>\n                    <span class="text-xs text-muted-foreground mt-1 block">${a}</span>\n                </div>\n            </div>\n        `;n?.insertAdjacentHTML("beforeend",r),n&&(n.scrollTop=n.scrollHeight)},s=()=>{const t=e?.value?.trim();t&&(r(t,!0),e&&(e.value=""),setTimeout(()=>{const e=["Based on current weather conditions and fleet status, I recommend adjusting the mining schedule to avoid peak rainfall hours.","I've analyzed your query. The current conditions suggest optimal production can be achieved by reallocating 3 vehicles from Site A to Site B.","According to the latest data, shipping delays are expected to be minimal today. I recommend proceeding with the scheduled departures.","I've processed your request. The AI analysis indicates that maintenance should be scheduled during low-activity periods to minimize operational impact."],t=e[Math.floor(Math.random()*e.length)];r(t,!1)},1e3))};t?.addEventListener("click",s),e?.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),s())}),a.forEach(t=>{t.addEventListener("click",()=>{const n=t.textContent?.trim();e&&n&&(e.value=n,e.focus())})})})()},c=e.api.baseUrl,u={async request(t,n={}){const a=`${c}${t}`,r=localStorage.getItem(e.storage.token),s={"Content-Type":"application/json"};r&&(s.Authorization=`Bearer ${r}`);const i={...n,headers:{...s,...n.headers}};try{const e=await fetch(a,i),t=await e.json();if(!e.ok)throw new Error(t.message||"Request failed");return t}catch(e){throw console.error("API Error:",e),e}},get(e){return this.request(e,{method:"GET"})},post(e,t){return this.request(e,{method:"POST",body:JSON.stringify(t)})},put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})},delete(e){return this.request(e,{method:"DELETE"})}},m={chat:async t=>{const n=localStorage.getItem(e.storage.token);console.log("🚀 Sending to Backend AI Service:",`${c}/ai/chat`),console.log("Message:",t);try{const e={"Content-Type":"application/json"};n&&(e.Authorization=`Bearer ${n}`);const a=await fetch(`${c}/ai/chat`,{method:"POST",headers:e,body:JSON.stringify({chatInput:t,message:t,timestamp:(new Date).toISOString(),userId:localStorage.getItem("user")||"anonymous",language:document.documentElement.lang||"id"})});let r;try{const e=await a.text();console.log("📦 Raw response:",e),r=e?JSON.parse(e):{}}catch(e){console.error("Parse error:",e),r={}}if(console.log("✅ AI Service response status:",a.status),console.log("✅ AI Service response data:",r),r.error)throw new Error(r.message||"AI Service Error");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return{success:!0,data:{response:r.data?.response||r.response||r.output||r.text||r.message||"No response"}}}catch(e){throw console.error("❌ Error connecting to AI Service:",e),e}},plan:async t=>{const n=localStorage.getItem(e.storage.token);console.log("🚀 Sending to AI Plan Service:",`${c}/ai/plan`),console.log("Payload:",t);try{const e={"Content-Type":"application/json"};n&&(e.Authorization=`Bearer ${n}`);const a=await fetch(`${c}/ai/plan`,{method:"POST",headers:e,body:JSON.stringify(t)});let r;try{const e=await a.text();console.log("📦 Raw plan response:",e),r=e?JSON.parse(e):{}}catch(e){console.error("Parse error:",e),r={}}if(console.log("✅ AI Plan response status:",a.status),console.log("✅ AI Plan response data:",r),r.error)throw new Error(r.message||"AI Plan Service Error");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return r}catch(e){throw console.error("❌ Error connecting to AI Plan Service:",e),e}},recommend:e=>u.post("/ai/recommend",e)},g=async()=>{console.log("🚀 AI Tools Page - Loading..."),await q.View.render(`\n            <div class="min-h-screen bg-background">\n                \x3c!-- AI Tools Content --\x3e\n                <div class="container mx-auto px-4 py-8">\n                    <div class="max-w-4xl mx-auto">\n                        <h1 class="text-3xl font-bold mb-2">Asisten AI</h1>\n                        <p class="text-muted-foreground mb-8">\n                            Ajukan pertanyaan tentang kondisi lapangan dan dapatkan rekomendasi AI\n                        </p>\n\n                        \x3c!-- Chat Container --\x3e\n                        <div class="bg-card border border-border rounded-xl overflow-hidden">\n                            \x3c!-- Chat Messages --\x3e\n                            <div id="chat-messages" class="h-[500px] overflow-y-auto p-6 space-y-4">\n                                \x3c!-- Welcome Message --\x3e\n                                <div class="flex items-start gap-3">\n                                    <div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0">\n                                        <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                        </svg>\n                                    </div>\n                                    <div class="flex-1">\n                                        <div class="bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4">\n                                            <p class="text-sm">Halo! Saya Asisten AI Operasi Tambang Anda. Bagaimana saya bisa membantu mengoptimalkan operasi Anda hari ini?</p>\n                                        </div>\n                                        <span class="text-xs text-muted-foreground mt-1 block">${(new Date).toLocaleTimeString("id-ID",{hour:"numeric",minute:"2-digit"})}</span>\n                                    </div>\n                                </div>\n                            </div>\n\n                            \x3c!-- Typing Indicator (hidden by default) --\x3e\n                            <div id="typing-indicator" class="hidden px-6 pb-4">\n                                <div class="flex items-center gap-2 text-muted-foreground text-sm">\n                                    <div class="flex gap-1">\n                                        <span class="w-2 h-2 bg-primary rounded-full animate-bounce" style="animation-delay: 0s"></span>\n                                        <span class="w-2 h-2 bg-primary rounded-full animate-bounce" style="animation-delay: 0.2s"></span>\n                                        <span class="w-2 h-2 bg-primary rounded-full animate-bounce" style="animation-delay: 0.4s"></span>\n                                    </div>\n                                    <span>AI sedang mengetik...</span>\n                                </div>\n                            </div>\n\n                            \x3c!-- Input Area --\x3e\n                            <div class="border-t border-border p-4 bg-background/50">\n                                <form id="chat-form" class="flex gap-2">\n                                    <input\n                                        type="text"\n                                        id="chat-input"\n                                        class="flex-1 px-4 py-3 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"\n                                        placeholder="Tanyakan tentang dampak cuaca, optimasi armada, atau perencanaan produksi..."\n                                        autocomplete="off"\n                                    />\n                                    <button\n                                        type="submit"\n                                        id="send-btn"\n                                        class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"\n                                        disabled\n                                    >\n                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />\n                                        </svg>\n                                    </button>\n                                </form>\n                            </div>\n                        </div>\n\n                        \x3c!-- Status Indicator --\x3e\n                        <div class="mt-4 flex items-center justify-center gap-2 text-sm">\n                            <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>\n                            <span class="text-muted-foreground">AI Online - Terhubung ke AI Service</span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,"ai-tools"),console.log("✅ AI Tools Page - Rendered, initializing..."),(()=>{console.log("🤖 AI Tools Page - Initializing...");const e=document.getElementById("chat-messages"),t=document.getElementById("chat-form"),n=document.getElementById("chat-input"),a=document.getElementById("send-btn"),r=document.getElementById("typing-indicator");function s(t,n){const a=(new Date).toLocaleTimeString("id-ID",{hour:"numeric",minute:"2-digit"}),r=document.createElement("div");r.className="flex items-start gap-3 animate-fade-in",r.innerHTML="ai"===n?`\n                    <div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0">\n                        <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                        </svg>\n                    </div>\n                    <div class="flex-1">\n                        <div class="bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4">\n                            <p class="text-sm whitespace-pre-wrap">${o(t)}</p>\n                        </div>\n                        <span class="text-xs text-muted-foreground mt-1 block">${a}</span>\n                    </div>\n                `:`\n                    <div class="flex-1"></div>\n                    <div class="flex-shrink-0 max-w-[70%]">\n                        <div class="bg-primary text-white rounded-2xl rounded-br-sm p-4">\n                            <p class="text-sm whitespace-pre-wrap">${o(t)}</p>\n                        </div>\n                        <span class="text-xs text-muted-foreground mt-1 block text-right">${a}</span>\n                    </div>\n                    <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center flex-shrink-0">\n                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />\n                        </svg>\n                    </div>\n                `,e.appendChild(r),i()}function i(){e.scrollTop=e.scrollHeight}function o(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}n.addEventListener("input",()=>{a.disabled=!n.value.trim()}),t.addEventListener("submit",async e=>{e.preventDefault();const t=n.value.trim();if(t){s(t,"user"),n.value="",a.disabled=!0,r.classList.remove("hidden"),i();try{const e=await m.chat(t);r.classList.add("hidden"),e.success&&e.data.response?s(e.data.response,"ai"):s("Maaf, terjadi kesalahan. Silakan coba lagi.","ai")}catch(e){console.error("Error sending message:",e),r.classList.add("hidden"),s("Maaf, saya tidak dapat terhubung ke AI server. Silakan coba lagi nanti.","ai")}}}),n.focus(),console.log("✅ AI Tools Page - Ready!")})()},p="http://139.59.224.58:5000",h=`${p}/ai/plan`,f=`${p}/shipping-schedules`;function v(){try{return JSON.parse(localStorage.getItem("optimine-user")||"{}").role||"shipping_planner"}catch{return"shipping_planner"}}const x={rainfall_mm:.5,wind_speed_kmh:.4,activeVehicles:25,maintenanceStatus:3,totalFleet:40,vessels:[],excavatorActive:8,dumpTruckActive:15,miningMaintenanceStatus:2,selectedShift:"pagi",isLoading:!1,result:null},b=[{icon:"📡",text:"Mengirim data telemetri ke Server...",duration:2e3},{icon:"🌩️",text:"Menganalisis dampak cuaca & gelombang...",duration:2e3},{icon:"🤖",text:"AI menyusun strategi optimal...",duration:null}],y=async e=>{const t=function(){const e="mining_planner"===v();return`\n        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">\n            \x3c!-- Page Header --\x3e\n            <section id="page-header" class="mb-8 animate-fade-in">\n                <h1 class="font-heading text-3xl md:text-4xl font-bold text-foreground mb-2">\n                    ${e?"Perencanaan Tambang":"Perencanaan Produksi"}\n                </h1>\n                <p class="text-muted-foreground">\n                    ${e?"Masukkan kondisi operasional tambang untuk menghasilkan rencana yang dioptimalkan":"Masukkan kondisi operasional untuk menghasilkan rencana yang dioptimalkan"}\n                </p>\n                <div class="mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium ${e?"bg-amber-500/20 text-amber-400":"bg-cyan-500/20 text-cyan-400"}">\n                    <span class="w-2 h-2 rounded-full ${e?"bg-amber-400":"bg-cyan-400"}"></span>\n                    ${e?"Mining Planner":"Shipping Planner"}\n                </div>\n            </section>\n\n            \x3c!-- Main Grid Layout --\x3e\n            <div class="grid lg:grid-cols-3 gap-6">\n                \x3c!-- Input Section (2/3 width) --\x3e\n                <div class="lg:col-span-2 space-y-6">\n                    \x3c!-- Weather Conditions Card (Same for both roles) --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in" style="animation-delay: 0.1s;">\n                        <div class="flex items-center gap-3 mb-6">\n                            <div class="w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center">\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />\n                                </svg>\n                            </div>\n                            <h2 class="font-heading font-semibold text-lg text-foreground">Kondisi Cuaca</h2>\n                        </div>\n\n                        \x3c!-- Rainfall Slider --\x3e\n                        <div class="mb-6">\n                            <div class="flex justify-between items-center mb-3">\n                                <label class="block text-sm text-muted-foreground">Curah Hujan</label>\n                                <span id="rainfall-value" class="text-sm font-medium text-primary">0.5 mm</span>\n                            </div>\n                            <div class="slider-container">\n                                <input type="range" id="rainfall-slider" class="slider-primary w-full" min="0" max="50" step="0.1" value="0.5">\n                                <div class="flex justify-between text-xs text-muted-foreground mt-2">\n                                    <span>0 mm</span>\n                                    <span>50 mm</span>\n                                </div>\n                            </div>\n                        </div>\n\n                        \x3c!-- Wind Speed Slider --\x3e\n                        <div>\n                            <div class="flex justify-between items-center mb-3">\n                                <label class="block text-sm text-muted-foreground">Kecepatan Angin</label>\n                                <span id="wind-value" class="text-sm font-medium text-primary">0.4 km/h</span>\n                            </div>\n                            <div class="slider-container">\n                                <input type="range" id="wave-slider" class="slider-primary w-full" min="0" max="10" step="0.1" value="0.4">\n                                <div class="flex justify-between text-xs text-muted-foreground mt-2">\n                                    <span>0 km/h</span>\n                                    <span>10 km/h</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    \x3c!-- Fleet/Equipment Status Card (Role-based) --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in" style="animation-delay: 0.2s;">\n                        <div class="flex items-center gap-3 mb-6">\n                            <div class="w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center">\n                                ${e?'\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />\n                                </svg>\n                                ':'\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />\n                                </svg>\n                                '}\n                            </div>\n                            <h2 class="font-heading font-semibold text-lg text-foreground">\n                                ${e?"Status Peralatan Tambang":"Status Armada"}\n                            </h2>\n                        </div>\n\n                        ${e?'\n                        \x3c!-- Mining Planner: Equipment Status --\x3e\n                        <div class="grid sm:grid-cols-3 gap-4">\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Excavator Aktif</label>\n                                <input type="number" id="excavator-active" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="8" min="0">\n                            </div>\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Dump Truck Aktif</label>\n                                <input type="number" id="dump-truck-active" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="15" min="0">\n                            </div>\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Status Perawatan</label>\n                                <input type="number" id="mining-maintenance-status" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="2" min="0">\n                            </div>\n                        </div>\n                        ':'\n                        \x3c!-- Shipping Planner: Fleet Status --\x3e\n                        <div class="grid sm:grid-cols-2 gap-4">\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Kendaraan Aktif</label>\n                                <input type="number" id="active-vehicles" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="25" min="0">\n                            </div>\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Status Perawatan</label>\n                                <input type="number" id="maintenance-status" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="3" min="0">\n                            </div>\n                        </div>\n                        '}\n                    </div>\n\n                    \x3c!-- Schedule Card (Role-based) --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in" style="animation-delay: 0.3s;">\n                        <div class="flex items-center gap-3 mb-6">\n                            <div class="w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center">\n                                ${e?'\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />\n                                </svg>\n                                ':'\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />\n                                </svg>\n                                '}\n                            </div>\n                            <h2 class="font-heading font-semibold text-lg text-foreground">\n                                ${e?"Jadwal Produksi":"Jadwal Kapal"}\n                            </h2>\n                        </div>\n\n                        ${e?'\n                        \x3c!-- Mining Planner: Production Schedule --\x3e\n                        <div class="space-y-4">\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-3">Pilih Shift Produksi</label>\n                                <div class="grid grid-cols-3 gap-3">\n                                    <button type="button" id="shift-pagi" class="shift-btn active p-4 bg-primary/20 border-2 border-primary rounded-lg text-center transition-all hover:bg-primary/30" data-shift="pagi">\n                                        <div class="text-2xl mb-1">🌅</div>\n                                        <div class="text-sm font-medium text-foreground">Pagi</div>\n                                        <div class="text-xs text-muted-foreground">06:00 - 14:00</div>\n                                    </button>\n                                    <button type="button" id="shift-siang" class="shift-btn p-4 bg-secondary/50 border-2 border-border rounded-lg text-center transition-all hover:bg-secondary" data-shift="siang">\n                                        <div class="text-2xl mb-1">☀️</div>\n                                        <div class="text-sm font-medium text-foreground">Siang</div>\n                                        <div class="text-xs text-muted-foreground">14:00 - 22:00</div>\n                                    </button>\n                                    <button type="button" id="shift-malam" class="shift-btn p-4 bg-secondary/50 border-2 border-border rounded-lg text-center transition-all hover:bg-secondary" data-shift="malam">\n                                        <div class="text-2xl mb-1">🌙</div>\n                                        <div class="text-sm font-medium text-foreground">Malam</div>\n                                        <div class="text-xs text-muted-foreground">22:00 - 06:00</div>\n                                    </button>\n                                </div>\n                            </div>\n                            <div>\n                                <label class="block text-sm text-muted-foreground mb-2">Target Produksi Harian (ton)</label>\n                                <input type="number" id="target-production" class="w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors" value="5000" min="0" step="100">\n                            </div>\n                        </div>\n                        ':'\n                        \x3c!-- Shipping Planner: Vessel Schedule --\x3e\n                        <div id="vessels-container" class="space-y-3">\n                            <div class="flex items-center justify-center p-4 text-muted-foreground text-sm">\n                                <svg class="w-5 h-5 animate-spin mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                                </svg>\n                                Memuat jadwal kapal...\n                            </div>\n                        </div>\n                        '}\n                    </div>\n\n                    \x3c!-- Generate Button --\x3e\n                    <button id="generate-btn" class="w-full h-14 bg-primary hover:bg-primary/90 text-white font-medium rounded-xl flex items-center justify-center gap-2 glow-hover transition-all duration-300 animate-fade-in" style="animation-delay: 0.4s;">\n                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />\n                        </svg>\n                        <span>Hasilkan Rencana Optimal</span>\n                    </button>\n\n                    \x3c!-- Loading Container (Hidden by default) --\x3e\n                    <div id="loading-container" class="hidden w-full">\n                        <div class="glass border border-border rounded-xl p-8 animate-fade-in">\n                            <div class="flex flex-col items-center justify-center gap-4">\n                                <div class="relative">\n                                    <div class="w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center">\n                                        <span id="loading-icon" class="text-3xl">📡</span>\n                                    </div>\n                                    <div class="absolute inset-0 w-16 h-16 rounded-full border-4 border-primary/30 border-t-primary animate-spin"></div>\n                                </div>\n                                <p id="loading-text" class="text-lg font-medium text-foreground text-center">\n                                    Mengirim data telemetri ke Server...\n                                </p>\n                                <div class="flex gap-2 mt-2">\n                                    <div class="w-2 h-2 rounded-full bg-primary animate-pulse" style="animation-delay: 0ms;"></div>\n                                    <div class="w-2 h-2 rounded-full bg-primary animate-pulse" style="animation-delay: 200ms;"></div>\n                                    <div class="w-2 h-2 rounded-full bg-primary animate-pulse" style="animation-delay: 400ms;"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    \x3c!-- Result Dashboard (Hidden by default) --\x3e\n                    <div id="result-dashboard" class="hidden w-full space-y-6 animate-fade-in">\n                        <div class="flex items-center justify-between flex-wrap gap-4">\n                            <div class="flex items-center gap-3">\n                                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-cyan-500 flex items-center justify-center">\n                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />\n                                    </svg>\n                                </div>\n                                <div>\n                                    <h2 class="font-heading font-bold text-xl text-foreground">Rencana Optimasi Operasional</h2>\n                                    <p id="result-timestamp" class="text-sm text-muted-foreground"></p>\n                                </div>\n                            </div>\n                            <button id="new-plan-btn" class="px-4 py-2 text-sm font-medium text-primary hover:bg-primary/10 rounded-lg transition-colors flex items-center gap-2">\n                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />\n                                </svg>\n                                Buat Rencana Baru\n                            </button>\n                        </div>\n                        <div class="grid sm:grid-cols-3 gap-4" id="metrics-grid"></div>\n                        <div id="recommendations-container" class="space-y-4"></div>\n                    </div>\n                </div>\n\n                \x3c!-- Status Panel (1/3 width) --\x3e\n                <div class="space-y-6">\n                    \x3c!-- System Status Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 border-glow animate-fade-in" style="animation-delay: 0.2s;">\n                        <div class="flex items-center gap-3 mb-6">\n                            <div class="w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center">\n                                <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />\n                                </svg>\n                            </div>\n                            <h2 class="font-heading font-semibold text-lg text-foreground">Status Sistem</h2>\n                        </div>\n\n                        <div class="space-y-3">\n                            <div class="p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20">\n                                <div class="flex items-center gap-3">\n                                    <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>\n                                    <span class="text-sm text-emerald-400 font-medium">Sistem AI Online</span>\n                                </div>\n                            </div>\n                            <div class="p-3 rounded-lg bg-primary/10 border border-primary/20">\n                                <div class="flex items-center gap-3">\n                                    <span class="w-2 h-2 rounded-full bg-primary"></span>\n                                    <span class="text-sm text-primary font-medium">Integrasi RAG Siap</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    \x3c!-- Active Alerts Card --\x3e\n                    <div class="glass border border-border rounded-xl p-6 animate-fade-in" style="animation-delay: 0.3s;">\n                        <div class="flex items-center gap-3 mb-6">\n                            <div class="w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center">\n                                <svg class="w-5 h-5 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\n                                </svg>\n                            </div>\n                            <h2 class="font-heading font-semibold text-lg text-foreground">Peringatan Aktif</h2>\n                        </div>\n\n                        <div class="space-y-3">\n                            <div class="p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20">\n                                <span class="text-sm text-yellow-400">Curah hujan tinggi diperkirakan di Lokasi Tambang B</span>\n                            </div>\n                            <div class="p-3 rounded-lg bg-orange-500/10 border border-orange-500/20">\n                                <span class="text-sm text-orange-400">2 kendaraan dijadwalkan untuk perawatan</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `}();await q.View.render(t,"planning"),setTimeout(()=>{!function(){const e="mining_planner"===v();(function(){const e=document.getElementById("rainfall-slider"),t=document.getElementById("wave-slider");e&&e.addEventListener("input",e=>{x.rainfall_mm=parseFloat(e.target.value),w()}),t&&t.addEventListener("input",e=>{x.wind_speed_kmh=parseFloat(e.target.value),w()})})(),function(){const e=document.getElementById("active-vehicles"),t=document.getElementById("maintenance-status");e&&e.addEventListener("change",e=>{x.activeVehicles=parseInt(e.target.value)||0}),t&&t.addEventListener("change",e=>{x.maintenanceStatus=parseInt(e.target.value)||0})}(),function(){const e=document.getElementById("generate-btn"),t=document.getElementById("new-plan-btn");e&&e.addEventListener("click",()=>async function(){if(x.isLoading)return;const e=document.getElementById("generate-btn"),t=document.getElementById("loading-container"),n=document.getElementById("result-dashboard");e&&e.classList.add("hidden"),n&&n.classList.add("hidden"),t&&t.classList.remove("hidden"),x.isLoading=!0;const a=async function(){const e=document.getElementById("loading-icon"),t=document.getElementById("loading-text");for(let n=0;n<b.length-1;n++){const a=b[n];e&&(e.textContent=a.icon),t&&(t.textContent=a.text),await L(a.duration)}const n=b[b.length-1];e&&(e.textContent=n.icon),t&&(t.textContent=n.text)}();try{const e=function(){const e="mining_planner"===v(),t={rainfall_mm:x.rainfall_mm,wind_speed_kmh:x.wind_speed_kmh,temperature_c:30,humidity_pct:80};let n="Mendung";x.rainfall_mm>=1?n="Hujan ringan":x.rainfall_mm<.1&&(n="Berawan");let a,r,s,i="Good";if(x.rainfall_mm>=1?i="Poor":x.rainfall_mm>=.3&&(i="Fair"),e){const e=x.excavatorActive+x.dumpTruckActive;a={availability_pct:parseFloat((e/30*100).toFixed(2)),road_condition:i,weather_condition:n,mine_id:"MINE_1",equipment_type:"Mixed"},r={planned_output_ton:x.targetProduction||5e3};const t={pagi:"Pagi (06:00-14:00)",siang:"Siang (14:00-22:00)",malam:"Malam (22:00-06:00)"};s=`[Mining Planner] Status cuaca: ${n}, curah hujan ${x.rainfall_mm.toFixed(1)}mm, angin ${x.wind_speed_kmh.toFixed(1)}km/h. Peralatan tambang: ${x.excavatorActive} Excavator aktif, ${x.dumpTruckActive} Dump Truck aktif, ${x.miningMaintenanceStatus} unit dalam perawatan. Kondisi jalan tambang: ${i}. Shift produksi: ${t[x.selectedShift]||"Pagi"}. Target produksi harian: ${(x.targetProduction||5e3).toLocaleString()} ton.`}else{const e=x.activeVehicles/x.totalFleet*100;a={availability_pct:parseFloat(e.toFixed(2)),road_condition:i,weather_condition:n,mine_id:"MINE_1",equipment_type:"Excavator"},r={planned_output_ton:5e3};const t=x.vessels.map(e=>e.name?`${e.name} (${e.status})`:`Vessel ${e.id} - ${e.time} (${e.status})`).join(", ");s=`[Shipping Planner] Status cuaca: ${n}, curah hujan ${x.rainfall_mm.toFixed(1)}mm, angin ${x.wind_speed_kmh.toFixed(1)}km/h. Armada: ${x.activeVehicles} aktif dari ${x.totalFleet} total, ${x.maintenanceStatus} dalam perawatan. Kondisi jalan: ${i}. Jadwal kapal: ${t||"Tidak ada data"}.`}return{weather_input:t,capacity_input:a,production_input:r,additional_context:s}}();console.log("📤 Sending payload to AI Plan:",e);const t=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();console.log("📥 AI Plan response:",n),x.result=n,await a,I(n),q.View.showToast("Rencana optimasi berhasil dibuat!","success")}catch(e){console.error("❌ Error generating plan:",e),console.log("🎭 Menggunakan Demo Mode karena API belum tersedia..."),await a;const t=function(){const e="mining_planner"===v(),t=S(x.rainfall_mm);let n,a;if(e){const e=x.excavatorActive+x.dumpTruckActive;n=Math.round(e/30*(x.targetProduction||5e3));const r={pagi:"Pagi",siang:"Siang",malam:"Malam"};a=`\n**Strategi Utama:**\nBerdasarkan analisis kondisi cuaca ${t} dengan curah hujan ${x.rainfall_mm.toFixed(1)}mm, disarankan untuk mengoptimalkan operasi penambangan pada shift ${r[x.selectedShift]||"Pagi"} dengan memaksimalkan utilisasi ${x.excavatorActive} unit Excavator dan ${x.dumpTruckActive} unit Dump Truck.\n\n**Risiko Terdeteksi:**\n- Curah hujan ${x.rainfall_mm>=1?"tinggi dapat mempengaruhi stabilitas pit dan kondisi jalan tambang":"rendah, kondisi operasional tambang optimal"}\n- ${x.miningMaintenanceStatus} unit peralatan dalam perawatan perlu dijadwalkan kembali beroperasi\n- Kecepatan angin ${x.wind_speed_kmh.toFixed(1)} km/h ${x.wind_speed_kmh>5?"perlu perhatian untuk operasi blasting":"dalam batas aman untuk semua operasi"}\n\n**Tindakan Prioritas:**\n1. Fokuskan Excavator pada front kerja dengan overburden ratio optimal\n2. Koordinasikan Dump Truck untuk meminimalkan cycle time\n3. Monitor kondisi pit dan jalan akses secara berkala\n4. Target produksi harian: ${(x.targetProduction||5e3).toLocaleString()} ton\n        `.trim()}else n=Math.round(x.activeVehicles/x.totalFleet*5e3),a=`\n**Strategi Utama:**\nBerdasarkan analisis kondisi cuaca ${t} dengan curah hujan ${x.rainfall_mm.toFixed(1)}mm, disarankan untuk mengoptimalkan jadwal operasional pada shift pagi ketika kondisi jalan masih optimal.\n\n**Risiko Terdeteksi:**\n- Curah hujan ${x.rainfall_mm>=1?"tinggi dapat menurunkan kapasitas hauling sebesar 15-20%":"rendah, kondisi operasional normal"}\n- ${x.maintenanceStatus} unit kendaraan dalam perawatan perlu diprioritaskan untuk kembali beroperasi\n- Kecepatan angin ${x.wind_speed_kmh.toFixed(1)} km/h ${x.wind_speed_kmh>5?"perlu monitoring untuk keamanan operasi crane":"dalam batas aman"}\n\n**Tindakan Prioritas:**\n1. Fokuskan operasi pada ${x.activeVehicles} unit kendaraan aktif\n2. Koordinasi dengan jadwal kapal untuk optimasi loading\n3. Monitor kondisi jalan secara berkala terutama area ramp\n4. Siapkan contingency plan jika cuaca memburuk\n        `.trim();return{success:!0,data:{ml_predictions:{weather_classification:t,effective_capacity_ton_per_day:n,confidence_score:.87,production_forecast:.9*n},narrative_recommendation:a}}}();x.result=t,I(t),q.View.showToast("Demo Mode: Menampilkan contoh hasil","info")}finally{x.isLoading=!1}}()),t&&t.addEventListener("click",()=>function(){const e=document.getElementById("generate-btn"),t=document.getElementById("loading-container"),n=document.getElementById("result-dashboard");e&&e.classList.remove("hidden"),t&&t.classList.add("hidden"),n&&n.classList.add("hidden"),x.result=null}())}(),e?function(){const e=document.getElementById("excavator-active"),t=document.getElementById("dump-truck-active"),n=document.getElementById("mining-maintenance-status"),a=document.getElementById("target-production"),r=document.querySelectorAll(".shift-btn");e&&e.addEventListener("change",e=>{x.excavatorActive=parseInt(e.target.value)||0}),t&&t.addEventListener("change",e=>{x.dumpTruckActive=parseInt(e.target.value)||0}),n&&n.addEventListener("change",e=>{x.miningMaintenanceStatus=parseInt(e.target.value)||0}),a&&a.addEventListener("change",e=>{x.targetProduction=parseInt(e.target.value)||5e3}),r.forEach(e=>{e.addEventListener("click",()=>{r.forEach(e=>{e.classList.remove("active","bg-primary/20","border-primary"),e.classList.add("bg-secondary/50","border-border")}),e.classList.add("active","bg-primary/20","border-primary"),e.classList.remove("bg-secondary/50","border-border"),x.selectedShift=e.dataset.shift})})}():async function(){const e=document.getElementById("vessels-container");if(e)try{const t=localStorage.getItem("optimine-token"),n={"Content-Type":"application/json"};t&&(n.Authorization=`Bearer ${t}`);const a=await fetch(`${f}?limit=5`,{headers:n});if(!a.ok)throw new Error(`HTTP ${a.status}`);const r=(await a.json()).data||[];if(0===r.length)return void k(e);x.vessels=r.map(e=>({id:e.shipment_id,name:e.vessel_name,etd:e.etd,status:e.status,destination:e.destination_port,tonnage:e.coal_tonnage})),function(e,t){e.innerHTML=t.map(e=>{const t=e.etd?new Date(e.etd):null,n=t?t.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-",a="scheduled"===e.status?.toLowerCase()||"loading"===e.status?.toLowerCase()?"bg-primary/20 text-primary":"bg-emerald-500/20 text-emerald-400",r=e.status||"Scheduled";return`\n            <div class="flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border">\n                <div class="flex-1">\n                    <span class="text-sm font-medium text-foreground">${e.vessel_name||"Unknown Vessel"}</span>\n                    <span class="text-xs text-muted-foreground ml-2">ETD: ${n}</span>\n                </div>\n                <div class="flex items-center gap-2">\n                    <span class="text-xs text-muted-foreground">${e.coal_tonnage?.toLocaleString()||"-"} ton</span>\n                    <span class="px-2 py-1 text-xs font-medium ${a} rounded">${r}</span>\n                </div>\n            </div>\n        `}).join("")}(e,r)}catch(t){console.warn("Failed to load vessels, using defaults:",t.message),k(e)}}()}()},100)};function w(){const e=document.getElementById("rainfall-value"),t=document.getElementById("wind-value");e&&(e.textContent=`${x.rainfall_mm.toFixed(1)} mm`),t&&(t.textContent=`${x.wind_speed_kmh.toFixed(1)} km/h`)}function k(e){x.vessels=[{id:"A",name:"MV Samudera Jaya",time:"08:00",status:"Scheduled"},{id:"B",name:"MV Nusantara",time:"14:00",status:"Loading"},{id:"C",name:"MV Bahari Indah",time:"20:00",status:"Scheduled"}],e.innerHTML=x.vessels.map(e=>`\n        <div class="flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border">\n            <span class="text-sm text-foreground">${e.name} - ${e.time}</span>\n            <span class="px-2 py-1 text-xs font-medium bg-primary/20 text-primary rounded">${e.status}</span>\n        </div>\n    `).join("")}function L(e){return new Promise(t=>setTimeout(t,e))}function S(e){return e>=1?"Hujan ringan":e>=.3?"Mendung":"Berawan"}function I(e){const t=document.getElementById("loading-container"),n=document.getElementById("result-dashboard"),a=document.getElementById("generate-btn");t&&t.classList.add("hidden"),a&&a.classList.add("hidden"),n&&n.classList.remove("hidden");const r=document.getElementById("result-timestamp");if(r){const e=new Date;r.textContent=`Dibuat pada ${e.toLocaleString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}`}!function(e){const t=document.getElementById("metrics-grid");if(!t)return;const n=e.ml_predictions||{},a=n.weather_classification||S(x.rainfall_mm),r=function(e){const t=e.toLowerCase();return t.includes("hujan")?"🌧️":t.includes("mendung")?"☁️":"⛅"}(a),s=n.effective_capacity_ton_per_day||n.capacity_forecast||50*x.activeVehicles,i=n.confidence_score||n.model_confidence||.85;t.innerHTML=`\n        <div class="glass border border-border rounded-xl p-5 transition-all hover:border-primary/50">\n            <div class="flex items-center gap-3 mb-3">\n                <span class="text-3xl">${r}</span>\n                <span class="text-sm text-muted-foreground">Kondisi Cuaca</span>\n            </div>\n            <p class="text-xl font-bold text-foreground">${a}</p>\n            <p class="text-xs text-muted-foreground mt-1">\n                ${x.rainfall_mm.toFixed(1)}mm curah hujan, ${x.wind_speed_kmh.toFixed(1)}km/h angin\n            </p>\n        </div>\n        \n        <div class="glass border border-border rounded-xl p-5 transition-all hover:border-primary/50">\n            <div class="flex items-center gap-3 mb-3">\n                <span class="text-3xl">⚙️</span>\n                <span class="text-sm text-muted-foreground">Kapasitas Efektif</span>\n            </div>\n            <p class="text-xl font-bold text-foreground">${Math.round(s).toLocaleString("id-ID")}</p>\n            <p class="text-xs text-muted-foreground mt-1">Ton/Hari</p>\n        </div>\n        \n        <div class="glass border border-border rounded-xl p-5 transition-all hover:border-primary/50">\n            <div class="flex items-center gap-3 mb-3">\n                <span class="text-3xl">📊</span>\n                <span class="text-sm text-muted-foreground">Confidence Score</span>\n            </div>\n            <p class="text-xl font-bold text-foreground">${(100*i).toFixed(1)}%</p>\n            <div class="w-full h-2 bg-secondary rounded-full mt-2 overflow-hidden">\n                <div class="h-full bg-gradient-to-r from-primary to-cyan-500 rounded-full" \n                     style="width: ${100*i}%"></div>\n            </div>\n        </div>\n    `}(e.data||e),function(e){const t=document.getElementById("recommendations-container");if(!t)return;const n=e.narrative_recommendation||e.recommendation||e.response||"Tidak ada rekomendasi tersedia.",a=function(e){const t={strategy:"",risks:"",actions:""},n=e.match(/\*\*Strategi Utama:\*\*\s*([\s\S]*?)(?=\*\*Risiko|\*\*Tindakan|$)/i),a=e.match(/\*\*Risiko Terdeteksi:\*\*\s*([\s\S]*?)(?=\*\*Strategi|\*\*Tindakan|$)/i),r=e.match(/\*\*Tindakan Prioritas:\*\*\s*([\s\S]*?)(?=\*\*Strategi|\*\*Risiko|$)/i);if(n&&n[1]&&(t.strategy=n[1].trim()),a&&a[1]&&(t.risks=a[1].trim()),r&&r[1]&&(t.actions=r[1].trim()),!t.strategy&&!t.risks&&!t.actions){const n=e.split(/\n\n/).filter(e=>e.trim());n.length>=1&&(t.strategy=n[0]),n.length>=2&&(t.risks=n[1]),n.length>=3&&(t.actions=n.slice(2).join("\n"))}return t}(n);let r="";a.strategy&&(r+=A("📌","Strategi Utama",a.strategy,"from-primary/20 to-cyan-500/20")),a.risks&&(r+=A("⚠️","Risiko Terdeteksi",a.risks,"from-yellow-500/20 to-orange-500/20")),a.actions&&(r+=A("✅","Tindakan Prioritas",a.actions,"from-emerald-500/20 to-green-500/20")),a.strategy||a.risks||a.actions||(r=A("💡","Rekomendasi AI",n,"from-primary/20 to-blue-500/20")),t.innerHTML=r}(e.data||e)}function A(e,t,n,a){let r=n.replace(/\*\*([^*]+)\*\*/g,"$1").replace(/\*([^*]+)\*/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/^(Strategi Utama|Risiko Terdeteksi|Tindakan Prioritas):\s*/gi,"").trim(),s=r;if(r.includes("\n")||r.includes("•")||r.includes("-")){const e=r.split(/[\n•-]/).map(e=>e.trim()).filter(e=>e.length>0);s=e.length>1?'<ul class="list-disc list-inside space-y-2">'+e.map(e=>`<li class="text-muted-foreground">${e}</li>`).join("")+"</ul>":`<p class="text-muted-foreground">${r}</p>`}else s=`<p class="text-muted-foreground">${r}</p>`;return`\n        <div class="glass border border-border rounded-xl overflow-hidden">\n            <div class="bg-gradient-to-r ${a} px-5 py-4 border-b border-border/50">\n                <div class="flex items-center gap-3">\n                    <span class="text-2xl">${e}</span>\n                    <h3 class="font-heading font-semibold text-lg text-foreground">${t}</h3>\n                </div>\n            </div>\n            <div class="p-5">${s}</div>\n        </div>\n    `}const E="http://139.59.224.58:5000",C=async e=>{q.View.hideNavbar(),await q.View.render('\n        <div class="min-h-[80vh] flex items-center justify-center px-4 py-8">\n            <div class="w-full max-w-md">\n                \x3c!-- Auth Card --\x3e\n                <div class="glass border border-border rounded-2xl p-6 sm:p-8 animate-fade-in">\n                    \n                    \x3c!-- Header: Logo + Title --\x3e\n                    <div class="text-center mb-6">\n                        <div class="w-16 h-16 mx-auto mb-4 rounded-full overflow-hidden border-2 border-primary/30 bg-gradient-to-br from-primary/20 to-cyan-500/20 flex items-center justify-center">\n                            <img src="assets/images/b (192 x 192 piksel) (1).png" alt="OptiMine Logo" class="w-full h-full object-cover" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'flex\';">\n                            <svg class="w-8 h-8 text-primary" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />\n                            </svg>\n                        </div>\n                        <h1 class="font-heading text-2xl font-bold mb-1">\n                            <span class="text-primary">Opti</span><span class="text-foreground">Mine</span>\n                        </h1>\n                        <p class="text-sm text-muted-foreground">Mining Value Chain Optimization Platform</p>\n                    </div>\n                    \n                    \x3c!-- Tab Navigation --\x3e\n                    <div class="grid grid-cols-2 gap-1 bg-secondary/50 rounded-lg p-1 mb-6">\n                        <button id="login-tab" class="auth-tab active py-2 px-4 text-sm font-medium rounded-md transition-all bg-primary text-white" data-tab="login">\n                            Masuk\n                        </button>\n                        <button id="register-tab" class="auth-tab py-2 px-4 text-sm font-medium rounded-md transition-all text-muted-foreground hover:text-foreground" data-tab="register">\n                            Daftar\n                        </button>\n                    </div>\n                    \n                    \x3c!-- LOGIN FORM --\x3e\n                    <form id="login-form" class="space-y-4">\n                        \x3c!-- Email Input --\x3e\n                        <div class="space-y-1.5">\n                            <label for="login-email" class="text-sm font-medium text-foreground">Email</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                    </svg>\n                                </div>\n                                <input \n                                    type="email" \n                                    id="login-email" \n                                    class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all"\n                                    placeholder="email@example.com"\n                                    required\n                                >\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Password Input --\x3e\n                        <div class="space-y-1.5">\n                            <label for="login-password" class="text-sm font-medium text-foreground">Kata Sandi</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                    </svg>\n                                </div>\n                                <input \n                                    type="password" \n                                    id="login-password" \n                                    class="w-full pl-10 pr-10 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all"\n                                    placeholder="••••••••"\n                                    required\n                                >\n                                <button type="button" class="password-toggle absolute inset-y-0 right-0 pr-3 flex items-center">\n                                    <svg class="eye-open w-5 h-5 text-muted-foreground hover:text-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />\n                                    </svg>\n                                    <svg class="eye-closed w-5 h-5 text-muted-foreground hover:text-foreground hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />\n                                    </svg>\n                                </button>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Submit Button --\x3e\n                        <button \n                            type="submit" \n                            id="login-submit"\n                            class="w-full py-3 bg-primary hover:bg-primary/90 text-white font-medium rounded-lg transition-all duration-300 glow-hover flex items-center justify-center gap-2"\n                        >\n                            <span>Masuk</span>\n                            <svg class="loading-spinner w-5 h-5 animate-spin hidden" fill="none" viewBox="0 0 24 24">\n                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                            </svg>\n                        </button>\n                    </form>\n                    \n                    \x3c!-- REGISTER FORM --\x3e\n                    <form id="register-form" class="space-y-4 hidden">\n                        \x3c!-- Full Name --\x3e\n                        <div class="space-y-1.5">\n                            <label for="register-name" class="text-sm font-medium text-foreground">Nama Lengkap</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />\n                                    </svg>\n                                </div>\n                                <input type="text" id="register-name" class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm" placeholder="John Doe" required>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Email --\x3e\n                        <div class="space-y-1.5">\n                            <label for="register-email" class="text-sm font-medium text-foreground">Email</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />\n                                    </svg>\n                                </div>\n                                <input type="email" id="register-email" class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm" placeholder="email@example.com" required>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Password --\x3e\n                        <div class="space-y-1.5">\n                            <label for="register-password" class="text-sm font-medium text-foreground">Kata Sandi</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                    </svg>\n                                </div>\n                                <input type="password" id="register-password" class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm" placeholder="Minimal 8 karakter" required minlength="8">\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Confirm Password --\x3e\n                        <div class="space-y-1.5">\n                            <label for="register-confirm" class="text-sm font-medium text-foreground">Konfirmasi Kata Sandi</label>\n                            <div class="relative">\n                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">\n                                    <svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />\n                                    </svg>\n                                </div>\n                                <input type="password" id="register-confirm" class="w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm" placeholder="••••••••" required>\n                            </div>\n                        </div>\n                        \n                        \x3c!-- Role Dropdown --\x3e\n                        <div class="space-y-1.5">\n                            <label for="register-role" class="text-sm font-medium text-foreground">Peran</label>\n                            <select id="register-role" class="w-full px-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground focus:outline-none focus:border-primary" required>\n                                <option value="">Pilih Peran</option>\n                                <option value="mining_planner">Mining Planner</option>\n                                <option value="shipping_planner">Shipping Planner</option>\n                            </select>\n                        </div>\n                        \n                        \x3c!-- Submit Button --\x3e\n                        <button \n                            type="submit" \n                            id="register-submit"\n                            class="w-full py-3 bg-primary hover:bg-primary/90 text-white font-medium rounded-lg transition-all duration-300 glow-hover flex items-center justify-center gap-2"\n                        >\n                            <span>Buat Akun</span>\n                            <svg class="loading-spinner w-5 h-5 animate-spin hidden" fill="none" viewBox="0 0 24 24">\n                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                            </svg>\n                        </button>\n                    </form>\n                    \n                </div>\n            </div>\n        </div>\n    ',"auth"),setTimeout(()=>{(function(){const e=document.getElementById("login-tab"),t=document.getElementById("register-tab"),n=document.getElementById("login-form"),a=document.getElementById("register-form");e&&t&&(e.addEventListener("click",()=>{e.classList.add("bg-primary","text-white"),e.classList.remove("text-muted-foreground"),t.classList.remove("bg-primary","text-white"),t.classList.add("text-muted-foreground"),n.classList.remove("hidden"),a.classList.add("hidden")}),t.addEventListener("click",()=>{t.classList.add("bg-primary","text-white"),t.classList.remove("text-muted-foreground"),e.classList.remove("bg-primary","text-white"),e.classList.add("text-muted-foreground"),a.classList.remove("hidden"),n.classList.add("hidden")}))})(),function(){const e=document.getElementById("login-form");e&&e.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("login-email").value.trim(),n=document.getElementById("login-password").value,a=document.getElementById("login-submit"),r=a.querySelector(".loading-spinner");a.disabled=!0,r.classList.remove("hidden");try{const e=await fetch(`${E}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}),a=await e.json();if(!e.ok||a.error)throw new Error(a.message||"Login gagal");localStorage.setItem("optimine-logged-in","true"),localStorage.setItem("optimine-token",a.data.token),localStorage.setItem("optimine-user",JSON.stringify({id:a.data.id,email:t,name:a.data.nama,role:a.data.role})),M(!0,a.data.nama),q.View.showNavbar(),setTimeout(()=>{const e=localStorage.getItem("optimine-redirect")||"home";localStorage.removeItem("optimine-redirect"),window.location.hash=e},1e3)}catch(e){q.View.showToast(e.message||"Email atau password salah","error")}finally{a.disabled=!1,r.classList.add("hidden")}})}(),function(){const e=document.getElementById("register-form");if(!e)return;if("true"===e.dataset.listenerAdded)return void console.log("Register form listener already added, skipping");e.dataset.listenerAdded="true";let t=!1;e.addEventListener("submit",async e=>{if(e.preventDefault(),e.stopImmediatePropagation(),t)return void console.log("Registration already in progress, ignoring duplicate submit");const n=document.getElementById("register-name").value.trim(),a=document.getElementById("register-email").value.trim(),r=document.getElementById("register-password").value,s=document.getElementById("register-confirm").value,i=document.getElementById("register-role").value,o=document.getElementById("register-submit"),l=o.querySelector(".loading-spinner");if(r===s)if(i){t=!0,o.disabled=!0,l.classList.remove("hidden");try{const e=await fetch(`${E}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nama:n,email:a,password:r,role:i})}),t=await e.json();if(!e.ok||t.error)throw new Error(t.message||"Registrasi gagal");const s=await fetch(`${E}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:r})}),o=await s.json();let l=n;s.ok&&!o.error&&(localStorage.setItem("optimine-logged-in","true"),localStorage.setItem("optimine-token",o.data.token),localStorage.setItem("optimine-user",JSON.stringify({id:o.data.id,email:a,name:o.data.nama,role:o.data.role})),l=o.data.nama),M(!0,l),q.View.showNavbar(),setTimeout(()=>{const e=localStorage.getItem("optimine-redirect")||"home";localStorage.removeItem("optimine-redirect"),window.location.hash=e},1e3)}catch(e){q.View.showToast(e.message||"Registrasi gagal","error")}finally{t=!1,o.disabled=!1,l.classList.add("hidden")}}else q.View.showToast("Pilih peran terlebih dahulu","error");else q.View.showToast("Konfirmasi password tidak cocok","error")})}(),document.querySelectorAll(".password-toggle").forEach(e=>{e.addEventListener("click",()=>{const t=e.parentElement.querySelector("input"),n=e.querySelector(".eye-open"),a=e.querySelector(".eye-closed");"password"===t.type?(t.type="text",n?.classList.add("hidden"),a?.classList.remove("hidden")):(t.type="password",n?.classList.remove("hidden"),a?.classList.add("hidden"))})})},100)};function M(e,t){const n=document.getElementById("loginBtn"),a=document.getElementById("profileBtn"),r=document.getElementById("mobileLoginBtn"),s=document.getElementById("mobileProfileBtn");if(e){n?.classList.add("hidden"),n?.classList.remove("sm:flex"),r?.classList.add("hidden"),a?.classList.remove("hidden"),a?.classList.add("flex"),s?.classList.remove("hidden"),s?.classList.add("flex");const e=document.querySelectorAll(".user-name"),i=document.querySelectorAll(".user-initial");e.forEach(e=>{e.textContent=t||"User"}),i.forEach(e=>{e.textContent=(t||"U").charAt(0).toUpperCase()})}else n?.classList.remove("hidden"),n?.classList.add("sm:flex"),r?.classList.remove("hidden"),a?.classList.add("hidden"),a?.classList.remove("flex"),s?.classList.add("hidden"),s?.classList.remove("flex")}const B={};let $=null;const T={init(){return this.register("home",o),this.register("planning",y),this.register("ai-tools",g),this.register("dashboard",d),this.register("auth",C),this.register("profile",d),window.addEventListener("hashchange",()=>this.handleRouteChange()),this.handleRouteChange(),this},register(e,t){return B[e]=t,this},navigate(e){window.location.hash=e},async handleRouteChange(){const t=window.location.hash.slice(1)||e.routes.default,[n,a]=t.split("?");if(e.routes.protected.includes(n)&&"true"!==localStorage.getItem(e.storage.isLoggedIn))return localStorage.setItem("optimine-redirect",n),void this.navigate("auth");const r=B[n];if(r){$=n;const e=this.parseQuery(a);await r(e),this.updateActiveNav(n)}else this.navigate(e.routes.default)},parseQuery(e){if(!e)return{};const t={};return e.split("&").forEach(e=>{const[n,a]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(a||"")}),t},updateActiveNav(e){document.querySelectorAll(".spa-nav-link").forEach(t=>{const n=t.getAttribute("href")?.replace("#","");t.classList.toggle("active",n===e)}),document.querySelectorAll(".spa-mobile-nav-link").forEach(t=>{const n=t.getAttribute("href")?.replace("#","");t.classList.toggle("active",n===e)});const t=document.getElementById("mobile-menu");t?.classList.add("hidden"),r.emit("routeChanged",e)},getCurrentRoute:()=>$},P={state:{user:null,isAuthenticated:!1,theme:e.defaults.theme,language:e.defaults.language,currentRoute:null,isLoading:!1},init(){this.state.theme=localStorage.getItem(e.storage.theme)||e.defaults.theme,this.state.language=localStorage.getItem(e.storage.language)||e.defaults.language,this.state.isAuthenticated="true"===localStorage.getItem(e.storage.isLoggedIn);const t=localStorage.getItem(e.storage.user);if(t)try{this.state.user=JSON.parse(t)}catch(e){this.state.user=null}return this},getState(e){return e?this.state[e]:this.state},setState(e,t){return this.state[e]=t,r.emit("stateChanged",{key:e,value:t}),this},login(t){return this.state.user=t,this.state.isAuthenticated=!0,localStorage.setItem(e.storage.user,JSON.stringify(t)),localStorage.setItem(e.storage.isLoggedIn,"true"),r.emit("authChanged",{isAuthenticated:!0,user:t}),this},logout(){return this.state.user=null,this.state.isAuthenticated=!1,localStorage.removeItem(e.storage.user),localStorage.removeItem(e.storage.token),localStorage.setItem(e.storage.isLoggedIn,"false"),r.emit("authChanged",{isAuthenticated:!1,user:null}),this},setTheme(t){return this.state.theme=t,localStorage.setItem(e.storage.theme,t),document.documentElement.classList.toggle("dark","dark"===t),r.emit("themeChanged",t),this},toggleTheme(){const e="dark"===this.state.theme?"light":"dark";return this.setTheme(e)},setLanguage(t){return this.state.language=t,localStorage.setItem(e.storage.language,t),r.emit("languageChanged",t),this}},j={elements:{content:null,navbar:null,toastContainer:null},init(){return this.elements.content=document.getElementById("spa-content"),this.elements.navbar=document.getElementById("header"),this.elements.toastContainer=document.getElementById("toast-container"),document.documentElement.classList.toggle("dark","dark"===P.getState("theme")),this},async render(e,t){this.elements.content||(this.elements.content=document.getElementById("spa-content"));const{content:n}=this.elements;n?(""===n.innerHTML.trim()||(n.classList.add("page-exit"),n.classList.add("page-exit-active"),await this.delay(200)),n.innerHTML=e,n.classList.remove("page-exit","page-exit-active"),n.classList.add("page-enter"),n.offsetWidth,n.classList.add("page-enter-active"),r.emit("routeChanged",t),await this.delay(500),n.classList.remove("page-enter","page-enter-active"),window.lucide&&window.lucide.createIcons()):console.error("SPA content element not found")},updateAuthUI(e,t){const n=document.getElementById("nav-auth-btn"),a=document.getElementById("nav-user-menu"),r=document.getElementById("nav-user-initial"),s=document.getElementById("nav-user-name"),i=document.getElementById("nav-user-email");e&&t?(n?.classList.add("hidden"),a?.classList.remove("hidden"),r&&(r.textContent=(t.name||"U").charAt(0).toUpperCase()),s&&(s.textContent=t.name||"User"),i&&(i.textContent=t.email||"")):(n?.classList.remove("hidden"),a?.classList.add("hidden"))},showToast(e,t="info",n=3e3){const a=this.elements.toastContainer;if(!a)return;const r=document.createElement("div");r.className=`spa-toast ${t}`,r.innerHTML=`\n            <i data-lucide="${{success:"check-circle",error:"x-circle",warning:"alert-triangle",info:"info"}[t]}" class="spa-toast-icon"></i>\n            <span class="spa-toast-message">${e}</span>\n        `,a.appendChild(r),window.lucide&&window.lucide.createIcons(),setTimeout(()=>{r.classList.add("exiting"),setTimeout(()=>r.remove(),300)},n)},hideNavbar(){this.elements.navbar&&this.elements.navbar.classList.add("hidden");const e=document.getElementById("footer");e&&e.classList.add("hidden")},showNavbar(){this.elements.navbar&&this.elements.navbar.classList.remove("hidden");const e=document.getElementById("footer");e&&e.classList.remove("hidden")},delay:e=>new Promise(t=>setTimeout(t,e))},R={init(){return this.setupEventListeners(),this},setupEventListeners(){r.on("authChanged",({isAuthenticated:e,user:t})=>{j.updateAuthUI(e,t),e||T.navigate("home")}),r.on("themeChanged",e=>{console.log("Theme changed:",e)})},async handleLogin(e,t){try{const n=await fetch("http://139.59.224.58:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await n.json();if(!n.ok||a.error)throw new Error(a.message||"Login gagal");const r={id:a.data.id,name:a.data.nama,email:e,role:a.data.role,token:a.data.token};return localStorage.setItem("optimine-token",a.data.token),P.login(r),j.showToast("Login berhasil!","success"),setTimeout(()=>{T.navigate("home")},500),!0}catch(e){return j.showToast("Login gagal: "+e.message,"error"),!1}},async handleRegister(e,t,n,a){try{const r=await fetch("http://139.59.224.58:5000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nama:e,email:t,password:n,role:a||"admin"})}),s=await r.json();if(console.log("Register response:",s),!r.ok||s.error)throw new Error(s.message||"Registrasi gagal");const i=await fetch("http://139.59.224.58:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}),o=await i.json();if(i.ok&&!o.error){const e={id:o.data.id,name:o.data.nama,email:t,role:o.data.role,token:o.data.token};localStorage.setItem("optimine-token",o.data.token),P.login(e)}else{const n={id:Date.now(),name:e,email:t,role:a||"admin"};P.login(n)}return j.showToast("Registrasi berhasil!","success"),setTimeout(()=>{T.navigate("home")},500),!0}catch(e){return j.showToast("Registrasi gagal: "+e.message,"error"),!1}},handleLogout(){P.logout(),j.showToast("Logout berhasil","info")}},q={Model:P,View:j,Presenter:R,init(){return P.init(),j.init(),R.init(),j.updateAuthUI(P.getState("isAuthenticated"),P.getState("user")),console.log("App initialized"),this}},z=e=>{const t=n(e,"nav");document.querySelectorAll(".nav-link[data-page]").forEach(e=>{const n=e.dataset.page,a=e.querySelector("span");a&&("home"===n&&(a.textContent=t.home),"planning"===n&&(a.textContent=t.planning),"ai-tools"===n&&(a.textContent=t.aiTools),"dashboard"===n&&(a.textContent=t.dashboard))}),document.querySelectorAll(".mobile-nav-link[data-page]").forEach(e=>{const n=e.dataset.page,a=e.querySelector("span");a&&("home"===n&&(a.textContent=t.home),"planning"===n&&(a.textContent=t.planning),"ai-tools"===n&&(a.textContent=t.aiTools),"dashboard"===n&&(a.textContent=t.dashboard))});const a=document.querySelector("#loginBtn span"),r=document.querySelector("#mobileLoginBtn span");a&&(a.textContent=t.login),r&&(r.textContent=t.login),document.querySelectorAll(".lang-option").forEach(t=>{const n=t.dataset.lang===e;t.classList.toggle("bg-primary",n),t.classList.toggle("text-primary-foreground",n),t.classList.toggle("shadow-lg",n),n?t.classList.remove("hover:bg-primary/10"):t.classList.add("hover:bg-primary/10")}),document.querySelectorAll(".lang-option-mobile").forEach(t=>{const n=t.dataset.lang===e;t.classList.toggle("bg-primary",n),t.classList.toggle("text-primary-foreground",n),t.classList.toggle("bg-secondary/50",!n)})},O=e=>{document.querySelectorAll(".nav-link").forEach(t=>{const n=t.dataset.page;t.classList.toggle("active",n===e)}),document.querySelectorAll(".mobile-nav-link").forEach(t=>{const n=t.dataset.page;t.classList.toggle("active",n===e)})},_=()=>{const e=q.Model.getState("isAuthenticated"),t=q.Model.getState("user"),n=document.getElementById("loginBtn"),a=document.getElementById("profileBtn"),r=document.getElementById("mobileLoginBtn"),s=document.getElementById("mobileProfileBtn");if(e&&t){n?.classList.add("hidden"),a?.classList.remove("hidden"),a?.classList.add("flex"),r?.classList.add("hidden"),s?.classList.remove("hidden"),s?.classList.add("flex");const e=(t.name||"U").charAt(0).toUpperCase();document.querySelectorAll(".user-initial").forEach(t=>t.textContent=e),document.querySelectorAll(".user-name").forEach(e=>e.textContent=t.name||"User")}else n?.classList.remove("hidden"),n?.classList.add("flex"),a?.classList.add("hidden"),a?.classList.remove("flex"),r?.classList.remove("hidden"),r?.classList.add("flex"),s?.classList.add("hidden"),s?.classList.remove("flex")},H=(e,t="info",n=3e3)=>{const a=document.getElementById("toast-container");if(!a)return;const r={success:'<svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',error:'<svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',info:'<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'},s=document.createElement("div");s.className=`toast ${t}`,s.innerHTML=`${r[t]||r.info}<span>${e}</span>`,a.appendChild(s),setTimeout(()=>{s.style.opacity="0",s.style.transform="translateX(100%)",s.style.transition="all 0.3s ease",setTimeout(()=>s.remove(),300)},n)};window.showToast=H,window.t=(e,n)=>{const a=n.split(".");let r=t[e]||t.en;for(const t of a){if(!r||"object"!=typeof r||!(t in r))return console.warn(`Translation not found: ${n} for language: ${e}`),n;r=r[t]}return r},window.getSection=n,window.updateLanguageUI=z,window.LanguageManager=a,document.addEventListener("DOMContentLoaded",()=>{q.init(),a.init(),(()=>{const e=document.getElementById("theme-toggle");e?.addEventListener("click",()=>{q.Model.toggleTheme()});const t=document.getElementById("lang-toggle"),n=document.getElementById("lang-dropdown");t?.addEventListener("click",e=>{e.stopPropagation(),n?.classList.toggle("hidden")}),document.querySelectorAll(".lang-option").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.lang;q.Model.setLanguage(t),n?.classList.add("hidden"),z(t),T.handleRouteChange()})}),document.querySelectorAll(".lang-option-mobile").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.lang;q.Model.setLanguage(t),z(t),T.handleRouteChange()})});const a=document.getElementById("mobile-menu-btn"),r=document.getElementById("mobile-menu"),s=document.getElementById("menu-icon"),i=document.getElementById("close-icon");a?.addEventListener("click",()=>{const e=!r?.classList.contains("hidden");r?.classList.toggle("hidden",e),s?.classList.toggle("hidden",!e),i?.classList.toggle("hidden",e)}),document.querySelectorAll(".mobile-nav-link").forEach(e=>{e.addEventListener("click",()=>{r?.classList.add("hidden"),s?.classList.remove("hidden"),i?.classList.add("hidden")})}),document.addEventListener("click",e=>{t?.contains(e.target)||n?.contains(e.target)||n?.classList.add("hidden")});const o=q.Model.getState("language")||"id";z(o)})(),_(),r.on("routeChanged",O),r.on("authChanged",_),r.on("languageChanged",e=>{z(e);const t=T.getCurrentRoute();t&&T.navigate(t)}),a.subscribe(e=>{const t=T.getCurrentRoute();t&&T.navigate(t)}),T.init(),console.log("OptiMine SPA initialized")}),window.OptiMine={App:q,Router:T,showToast:H}})();
//# sourceMappingURL=bundle.js.map