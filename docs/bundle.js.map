{"version":3,"file":"bundle.js","mappings":"mBAIO,MAAMA,EAAS,CAElBC,QAAS,WACTC,QAAS,QAGTC,IAAK,CACDC,QAAS,4BACTC,QAAS,KAIbC,OAAQ,CACJC,QAAS,OACTC,UAAW,CAAC,WAAY,WAAY,YAAa,WACjDC,OAAQ,CAAC,OAAQ,SAIrBC,WAAY,CACRC,SAAU,IACVC,KAAM,SAIVC,QAAS,CACLC,MAAO,iBACPC,SAAU,oBACVC,KAAM,gBACNC,MAAO,iBACPC,WAAY,sBAIhBC,SAAU,CACNL,MAAO,OACPC,SAAU,OCnCLK,EAAe,CACxBC,GAAI,CAEAC,IAAK,CACDC,KAAM,OACNC,SAAU,WACVC,QAAS,WACTC,UAAW,YACXC,MAAO,QACPC,QAAS,UACTC,OAAQ,YAIZN,KAAM,CACFO,YAAa,eACbC,SAAU,kCACVC,YAAa,eACbC,WAAY,cACZC,WAAY,aACZC,YAAa,eACbC,WAAY,wBACZC,eAAgB,+IAChBC,UAAW,uBACXC,cAAe,+HACfC,aAAc,uBACdC,iBAAkB,wHAClBC,gBAAiB,mBACjBC,kBAAmB,sBACnBC,mBAAoB,uBACpBC,eAAgB,kBAChBC,iBAAkB,qBAItBtB,SAAU,CACNuB,MAAO,sBACPhB,SAAU,2DACViB,kBAAmB,qBACnBC,cAAe,iBACfC,IAAK,MACLC,KAAM,OACNC,WAAY,cACZC,KAAM,OACNC,MAAO,QACPC,YAAa,eACbC,eAAgB,kBAChBC,kBAAmB,qBACnBC,kBAAmB,qBACnBC,WAAY,cACZC,eAAgB,kBAChBC,aAAc,gBACdC,WAAY,cACZC,iBAAkB,oBAClBC,cAAe,wBACfC,UAAW,aACXC,aAAc,6BACdC,aAAc,gBACdC,eAAgB,mBAChBC,SAAU,wBACVC,aAAc,gBACdC,cAAe,wCACfC,iBAAkB,uCAClBC,YAAa,eACbC,UAAW,YACXC,cAAe,iBACfC,OAAQ,SACRC,SAAU,YACVC,MAAO,QACPC,WAAY,eACZC,QAAS,WACTC,OAAQ,UAIZxD,QAAS,CACLsB,MAAO,eACPhB,SAAU,kEACVmD,SAAU,YACVC,aAAc,gBACdC,iBAAkB,oBAClBC,QAAS,+DACTC,QAAS,+CACTC,QAAS,4CACTC,YAAa,cACbC,gBAAiB,+DACjBC,iBAAkB,oBAClBC,QAAS,UACTC,MAAO,QACPC,SAAU,WACVC,YAAa,0EACbC,SAAU,sGAIdrE,UAAW,CACPqB,MAAO,uBACPhB,SAAU,qCACViE,gBAAiB,mBACjBC,cAAe,kBACfC,gBAAiB,mBACjBC,WAAY,wBACZC,eAAgB,kBAChBC,OAAQ,SACRC,YAAa,eACbC,YAAa,eACbC,iBAAkB,oBAClBC,gBAAiB,mBACjBC,iBAAkB,2BAClBC,kBAAmB,wBAIvBC,KAAM,CACFjF,MAAO,QACPkF,SAAU,WACVC,MAAO,QACPC,SAAU,WACVC,gBAAiB,mBACjBC,SAAU,YACVC,KAAM,OACNC,eAAgB,mBAChBC,OAAQ,UACRC,cAAe,iBACfC,cAAe,iBACfC,UAAW,6EACXC,cAAe,kBACfC,YAAa,gBACbC,cAAe,iBACfC,gBAAiB,mBAEjBC,qBAAsB,yBACtBC,UAAW,uBACXC,UAAW,yBACXC,OAAQ,eACRC,KAAM,OACNC,OAAQ,SACRC,KAAM,OACNC,OAAQ,SACRC,cAAe,+EACfC,iBAAkB,2BAItBzG,QAAS,CACLmB,MAAO,mBACPhB,SAAU,kCACVuG,YAAa,sBACbC,YAAa,eACbzB,MAAO,QACP0B,YAAa,cACbC,SAAU,YACVC,aAAc,iBACd3H,SAAU,WACV4H,eAAgB,uBAChBC,QAAS,WACT9H,MAAO,QACP+H,KAAM,OACNC,MAAO,SAIXC,OAAQ,CACJC,QAAS,aACTC,MAAO,QACPC,QAAS,UACTC,KAAM,OACNC,OAAQ,SACRC,QAAS,UACTC,OAAQ,SACRC,KAAM,OACNC,KAAM,OACNC,OAAQ,SACRC,OAAQ,oBACRC,gBAAiB,8BACjBC,UAAW,wCACXC,QAAS,UACTC,MAAO,QACPC,QAAS,YAIjBC,GAAI,CAEA1I,IAAK,CACDC,KAAM,UACNC,SAAU,cACVC,QAAS,WACTC,UAAW,YACXC,MAAO,QACPC,QAAS,SACTC,OAAQ,UAIZN,KAAM,CACFO,YAAa,iBACbC,SAAU,qCACVC,YAAa,eACbC,WAAY,cACZC,WAAY,YACZC,YAAa,cACbC,WAAY,wBACZC,eAAgB,qJAChBC,UAAW,qBACXC,cAAe,kIACfC,aAAc,oBACdC,iBAAkB,oHAClBC,gBAAiB,kBACjBC,kBAAmB,wBACnBC,mBAAoB,uBACpBC,eAAgB,kBAChBC,iBAAkB,kBAItBtB,SAAU,CACNuB,MAAO,uBACPhB,SAAU,4EACViB,kBAAmB,gBACnBC,cAAe,sBACfC,IAAK,SACLC,KAAM,SACNC,WAAY,mBACZC,KAAM,SACNC,MAAO,eACPC,YAAa,gBACbC,eAAgB,kBAChBC,kBAAmB,mBACnBC,kBAAmB,sBACnBC,WAAY,cACZC,eAAgB,mBAChBC,aAAc,eACdC,WAAY,aACZC,iBAAkB,uBAClBC,cAAe,wBACfC,UAAW,eACXC,aAAc,2BACdC,aAAc,gBACdC,eAAgB,mBAChBC,SAAU,qBACVC,aAAc,mBACdC,cAAe,sDACfC,iBAAkB,0CAClBC,YAAa,aACbC,UAAW,YACXC,cAAe,mBACfC,OAAQ,SACRC,SAAU,WACVC,MAAO,OACPC,WAAY,sBACZC,QAAS,YACTC,OAAQ,SAIZxD,QAAS,CACLsB,MAAO,aACPhB,SAAU,yEACVmD,SAAU,YACVC,aAAc,gBACdC,iBAAkB,oBAClBC,QAAS,4DACTC,QAAS,uDACTC,QAAS,4DACTC,YAAa,YACbC,gBAAiB,6DACjBC,iBAAkB,mBAClBC,QAAS,QACTC,MAAO,SACPC,SAAU,aACVC,YAAa,+EACbC,SAAU,kHAIdrE,UAAW,CACPqB,MAAO,oBACPhB,SAAU,oCACViE,gBAAiB,iBACjBC,cAAe,kBACfC,gBAAiB,kBACjBC,WAAY,qBACZC,eAAgB,oBAChBC,OAAQ,SACRC,YAAa,oBACbC,YAAa,cACbC,iBAAkB,gBAClBC,gBAAiB,mBACjBC,iBAAkB,6BAClBC,kBAAmB,4BAIvBC,KAAM,CACFjF,MAAO,QACPkF,SAAU,SACVC,MAAO,QACPC,SAAU,aACVC,gBAAiB,wBACjBC,SAAU,eACVC,KAAM,QACNC,eAAgB,mBAChBC,OAAQ,QACRC,cAAe,YACfC,cAAe,mBACfC,UAAW,sFACXC,cAAe,mBACfC,YAAa,mBACbC,cAAe,oBACfC,gBAAiB,uBAEjBC,qBAAsB,wBACtBC,UAAW,qBACXC,UAAW,sBACXC,OAAQ,cACRC,KAAM,QACNC,OAAQ,SACRC,KAAM,aACNC,OAAQ,OACRC,cAAe,yEACfC,iBAAkB,yBAItBzG,QAAS,CACLmB,MAAO,oBACPhB,SAAU,8BACVuG,YAAa,iBACbC,YAAa,gBACbzB,MAAO,QACP0B,YAAa,aACbC,SAAU,aACVC,aAAc,qBACd3H,SAAU,SACV4H,eAAgB,oBAChBC,QAAS,SACT9H,MAAO,OACP+H,KAAM,QACNC,MAAO,UAIXC,OAAQ,CACJC,QAAS,YACTC,MAAO,YACPC,QAAS,WACTC,KAAM,SACNC,OAAQ,QACRC,QAAS,aACTC,OAAQ,QACRC,KAAM,OACNC,KAAM,QACNC,OAAQ,OACRC,OAAQ,iBACRC,gBAAiB,6BACjBC,UAAW,yCACXC,QAAS,UACTC,MAAO,YACPC,QAAS,YAiCRE,EAAa,CAACC,EAAMC,IACtB/I,EAAa8I,KAAQC,IAAY/I,EAAiB,KAAI+I,IAAY,CAAC,EC3I9E,MAGA,EAHwB,IA3PxB,MACI,WAAAC,GACIC,KAAKC,gBAAkBD,KAAKE,mBAC5BF,KAAKG,UAAY,GACjBH,KAAKI,eAAgB,CACzB,CAKA,gBAAAF,GACI,MAAMG,EAAQC,aAAaC,QAAQ,qBACnC,OAAIF,GAAoB,OAAVA,GAA4B,OAAVA,GAIZG,UAAU9J,SAAS+J,cACvBC,WAAW,MAChB,MALAL,CAQf,CAKA,IAAAM,GACI,OAAIX,KAAKI,gBAETJ,KAAKY,YAAYZ,KAAKC,iBAAiB,GACvCD,KAAKa,wBACLb,KAAKI,eAAgB,EAErBU,QAAQC,IAAI,iDAAkDf,KAAKC,kBANpCD,IAQnC,CAKA,KAAIgB,GACA,OAAOjK,EAAaiJ,KAAKC,kBAAoBlJ,EAAiB,EAClE,CAOA,SAAAkK,CAAUC,GACN,MAAMC,EAAOD,EAAKE,MAAM,KACxB,IAAIC,EAASrB,KAAKgB,EAElB,IAAK,MAAMM,KAAOH,EAAM,CACpB,IAAIE,QAA0BE,IAAhBF,EAAOC,GAIjB,OADAR,QAAQU,KAAK,0BAA0BN,KAChCA,EAHPG,EAASA,EAAOC,EAKxB,CAEA,OAAOD,CACX,CAOA,WAAAT,CAAYf,EAAM4B,GAAS,GACV,OAAT5B,GAA0B,OAATA,GAKrBG,KAAKC,gBAAkBJ,EACvBS,aAAaoB,QAAQ,oBAAqB7B,GAG1C8B,SAASC,gBAAgBC,aAAa,OAAQhC,GAG9CG,KAAK8B,wBAGL9B,KAAK+B,0BAGDN,GACAzB,KAAKgC,mBAlBLlB,QAAQlC,MAAM,oBAAqBiB,EAoB3C,CAKA,cAAAoC,GACI,MAAMC,EAAmC,OAAzBlC,KAAKC,gBAA2B,KAAO,KAEvD,OADAD,KAAKY,YAAYsB,GACVA,CACX,CAKA,qBAAAJ,GAEyBH,SAASQ,iBAAiB,eAClCC,QAAQC,IACjB,MAAMf,EAAMe,EAAQC,aAAa,aAC3BC,EAAcvC,KAAKiB,UAAUK,GAC/BiB,IAAgBjB,IAChBe,EAAQG,YAAcD,KAKFZ,SAASQ,iBAAiB,2BAClCC,QAAQC,IACxB,MAAMf,EAAMe,EAAQC,aAAa,yBAC3BC,EAAcvC,KAAKiB,UAAUK,GAC/BiB,IAAgBjB,GAChBe,EAAQR,aAAa,cAAeU,KAKtBZ,SAASQ,iBAAiB,qBAClCC,QAAQC,IAClB,MAAMf,EAAMe,EAAQC,aAAa,mBAC3BC,EAAcvC,KAAKiB,UAAUK,GAC/BiB,IAAgBjB,GAChBe,EAAQR,aAAa,QAASU,KAKjBZ,SAASQ,iBAAiB,oBAClCC,QAAQC,IACjB,MAAMf,EAAMe,EAAQC,aAAa,kBAC3BC,EAAcvC,KAAKiB,UAAUK,GAC/BiB,IAAgBjB,GAChBe,EAAQR,aAAa,aAAcU,IAG/C,CAKA,uBAAAR,GAEuBJ,SAASQ,iBAAiB,6BAClCC,QAAQK,IACfA,EAAUD,YAAcxC,KAAKC,gBAAgByC,gBAI7Bf,SAASQ,iBAAiB,sBAClCC,QAAQO,IAChB,MACMC,EADOD,EAAOL,aAAa,sBACPtC,KAAKC,gBAG/B0C,EAAOE,UAAUC,OAAO,aAAcF,GACtCD,EAAOE,UAAUC,OAAO,0BAA2BF,GACnDD,EAAOE,UAAUC,OAAO,YAAaF,KAIzCjB,SAASQ,iBAAiB,gBAAgBC,QAAQW,IAC9C,MACMH,EADOG,EAAIC,QAAQnD,OACCG,KAAKC,gBAE/B8C,EAAIF,UAAUC,OAAO,aAAcF,GACnCG,EAAIF,UAAUC,OAAO,0BAA2BF,GAChDG,EAAIF,UAAUC,OAAO,YAAaF,IAE1C,CAKA,qBAAA/B,GAEIc,SAASsB,iBAAiB,QAAUC,IAGhC,GADkBA,EAAElH,OAAOmH,QAAQ,0BAI/B,OAFAD,EAAEE,sBACFpD,KAAKiC,iBAKT,MAAMoB,EAAUH,EAAElH,OAAOmH,QAAQ,sBACjC,GAAIE,EAAS,CACTH,EAAEE,iBACF,MAAMvD,EAAOwD,EAAQf,aAAa,oBAElC,YADAtC,KAAKY,YAAYf,EAErB,CAGA,MAAMyD,EAAaJ,EAAElH,OAAOmH,QAAQ,gBACpC,GAAIG,EAAY,CACZJ,EAAEE,iBACF,MAAMvD,EAAOyD,EAAWN,QAAQnD,KAC5BA,GACAG,KAAKY,YAAYf,EAEzB,GAER,CAOA,SAAA0D,CAAUC,GAEN,OADAxD,KAAKG,UAAUsD,KAAKD,GACb,KACHxD,KAAKG,UAAYH,KAAKG,UAAUuD,OAAOC,GAAMA,IAAOH,GAE5D,CAKA,eAAAxB,GACIhC,KAAKG,UAAUiC,QAAQoB,IACnB,IACIA,EAASxD,KAAKC,gBAAiBD,KAAKgB,EACxC,CAAE,MAAOpC,GACLkC,QAAQlC,MAAM,2BAA4BA,EAC9C,GAER,CAMA,CAAAgF,CAAE1C,GACE,OAAOlB,KAAKiB,UAAUC,EAC1B,GCvPS2C,EAAW,CACpBC,OAAQ,CAAC,EAET,EAAAC,CAAGC,EAAOR,GAKN,OAJKxD,KAAK8D,OAAOE,KACbhE,KAAK8D,OAAOE,GAAS,IAEzBhE,KAAK8D,OAAOE,GAAOP,KAAKD,GACjB,IAAMxD,KAAKiE,IAAID,EAAOR,EACjC,EAEA,GAAAS,CAAID,EAAOR,GACFxD,KAAK8D,OAAOE,KACjBhE,KAAK8D,OAAOE,GAAShE,KAAK8D,OAAOE,GAAON,OAAOC,GAAMA,IAAOH,GAChE,EAEA,IAAAU,CAAKF,EAAOG,GACHnE,KAAK8D,OAAOE,IACjBhE,KAAK8D,OAAOE,GAAO5B,QAAQoB,GAAYA,EAASW,GACpD,EAEA,IAAAC,CAAKJ,EAAOR,GACR,MAAMa,EAAWF,IACbX,EAASW,GACTnE,KAAKiE,IAAID,EAAOK,IAEpBrE,KAAK+D,GAAGC,EAAOK,EACnB,GAgHSC,EAAU,CACnB,MAAAC,CAAOlC,EAAS/L,EAAW,KACvB+L,EAAQmC,MAAMC,QAAU,IACxBpC,EAAQmC,MAAME,QAAU,QAExB,IAAIC,EAAQ,KACZ,MAAMC,EAAQC,IACLF,IAAOA,EAAQE,GACpB,MAAMC,EAAWC,KAAKC,KAAKH,EAAYF,GAASrO,EAAU,GAC1D+L,EAAQmC,MAAMC,QAAUK,EACpBA,EAAW,GACXG,sBAAsBL,IAG9BK,sBAAsBL,EAC1B,EAEA,OAAAM,CAAQ7C,EAAS/L,EAAW,KACxB,IAAIqO,EAAQ,KACZ,MAAMC,EAAQC,IACLF,IAAOA,EAAQE,GACpB,MAAMC,EAAWC,KAAKC,KAAKH,EAAYF,GAASrO,EAAU,GAC1D+L,EAAQmC,MAAMC,QAAU,EAAIK,EACxBA,EAAW,EACXG,sBAAsBL,GAEtBvC,EAAQmC,MAAME,QAAU,QAGhCO,sBAAsBL,EAC1B,EAEA,SAAAO,CAAU9C,EAAS/L,EAAW,KAC1B+L,EAAQmC,MAAMY,OAAS,MACvB/C,EAAQmC,MAAMa,SAAW,SACzBhD,EAAQmC,MAAME,QAAU,QAExB,MAAMY,EAAejD,EAAQkD,aAC7B,IAAIZ,EAAQ,KAEZ,MAAMC,EAAQC,IACLF,IAAOA,EAAQE,GACpB,MAAMC,EAAWC,KAAKC,KAAKH,EAAYF,GAASrO,EAAU,GAC1D+L,EAAQmC,MAAMY,OAAYE,EAAeR,EAAlB,KACnBA,EAAW,EACXG,sBAAsBL,IAEtBvC,EAAQmC,MAAMY,OAAS,GACvB/C,EAAQmC,MAAMa,SAAW,KAGjCJ,sBAAsBL,EAC1B,EAEA,OAAAY,CAAQnD,EAAS/L,EAAW,KACxB,MAAMmP,EAAcpD,EAAQkD,aAC5BlD,EAAQmC,MAAMY,OAAS,GAAGK,MAC1BpD,EAAQmC,MAAMa,SAAW,SAEzB,IAAIV,EAAQ,KAEZ,MAAMC,EAAQC,IACLF,IAAOA,EAAQE,GACpB,MAAMC,EAAWC,KAAKC,KAAKH,EAAYF,GAASrO,EAAU,GAC1D+L,EAAQmC,MAAMY,OAAYK,GAAe,EAAIX,GAAtB,KACnBA,EAAW,EACXG,sBAAsBL,IAEtBvC,EAAQmC,MAAME,QAAU,OACxBrC,EAAQmC,MAAMY,OAAS,GACvB/C,EAAQmC,MAAMa,SAAW,KAGjCJ,sBAAsBL,EAC1B,EAGA,UAAAc,CAAWrD,EAASsD,EAAMC,EAAQ,IAAKpC,EAAW,MAC9CnB,EAAQG,YAAc,GACtBH,EAAQmC,MAAMqB,YAAc,yBAC5BxD,EAAQmC,MAAMsB,UAAY,sCAE1B,IAAIC,EAAQ,EAEZ,MAAMxP,EAAO,KACLwP,EAAQJ,EAAKK,QACb3D,EAAQG,aAAemD,EAAKM,OAAOF,GACnCA,IACAG,WAAW3P,EAAMqP,IAEjBM,WAAW,KACP7D,EAAQmC,MAAMqB,YAAc,OAC5BxD,EAAQmC,MAAMsB,UAAY,OACtBtC,GAAUA,KACf,MAIXjN,GACJ,EAGA,iBAAA4P,CAAkB9D,EAAS+D,EAAaC,EAAUT,EAAQ,IACtDvD,EAAQiE,UAAY,GAEpB,MAAMC,EAAc5E,SAAS6E,cAAc,QAC3CD,EAAYE,UAAY,qBAExB,MAAMC,EAAW/E,SAAS6E,cAAc,QACxCE,EAASD,UAAY,mCAErBpE,EAAQsE,YAAYJ,GACpBlE,EAAQsE,YAAYD,GAEpBrE,EAAQQ,UAAU+D,IAAI,qBAEtB,IAAIC,EAAe,EACfC,EAAY,EAEhB,MAAMC,EAAc,KACZF,EAAeT,EAAYJ,QAC3BO,EAAY/D,aAAe4D,EAAYH,OAAOY,GAC9CA,IACAX,WAAWa,EAAanB,IAExBM,WAAWc,EAAU,MAIvBA,EAAW,KACTF,EAAYT,EAASL,QACrBU,EAASlE,aAAe6D,EAASJ,OAAOa,GACxCA,IACAZ,WAAWc,EAAUpB,IAErBM,WAAW,KACP7D,EAAQQ,UAAUoE,OAAO,qBACzB5E,EAAQQ,UAAU+D,IAAI,wBACvB,MAIXV,WAAWa,EAAa,IAC5B,EAGA,OAAAG,CAAQ7E,EAASrG,EAAQ1F,EAAW,IAAM6Q,EAAS,IAC/C,MAAMC,EAAYC,YAAYC,MAMxBC,EAAeC,IACjB,MAAMC,EAAUD,EAAcJ,EACxBtC,EAAWC,KAAKC,IAAIyC,EAAUnR,EAAU,GACxCoR,GALY1G,EAKiB8D,EALX,EAAIC,KAAK4C,IAAI,EAAI3G,EAAG,IAOtC4G,EAAe7C,KAAK8C,MAVX,GAU+B7L,EAV/B,GAUsD0L,GAPpD,IAAC1G,EAQlBqB,EAAQG,YAAcoF,EAAeT,EAEjCrC,EAAW,EACXG,sBAAsBsC,IAEtBlF,EAAQG,YAAcxG,EAASmL,EAC/B9E,EAAQQ,UAAU+D,IAAI,cAI9B3B,sBAAsBsC,EAC1B,EAGA,gBAAAO,CAAiBC,EAAQ,KACrB7B,WAAW,KACcvE,SAASQ,iBAAiB,4BAElCC,QAAQ,CAACC,EAAS0D,KAC3B,MAAM/J,EAASgM,SAAS3F,EAAQC,aAAa,iBAAmB,EAC1D6E,EAAS9E,EAAQC,aAAa,gBAAkB,GAChDhM,EAAW0R,SAAS3F,EAAQC,aAAa,mBAAqB,IAGpED,EAAQG,YAAc,IAAM2E,EAG5BjB,WAAW,KACP5B,EAAQ4C,QAAQ7E,EAASrG,EAAQ1F,EAAU6Q,IACpC,IAARpB,MAERgC,EACP,GC/SEE,EAAiB,KACnB,MAAMC,EAAiBvG,SAASwG,eAAe,iBAC/C,IAAKD,EAAgB,OAErB,MAAM7B,EA3BU,MAChB,IACI,MAAM+B,EAAW9H,aAAaC,QAAQ,iBACtC,GAAI6H,EAAU,CACV,MAAMzR,EAAO0R,KAAKC,MAAMF,GACxB,OAAOzR,EAAK4R,MAAQ5R,EAAK6R,MAAQ,EACrC,CACJ,CAAE,MAAOtF,GACLpC,QAAQlC,MAAM,2BAA4BsE,EAC9C,CACA,MAAO,IAiBUuF,GAVqC,SAA/CnI,aAAaC,QAAQ,uBAYR8F,EAChB/B,EAAQ6B,kBAAkB+B,EAAgB,iBAAkB7B,EAAU,IAEtE/B,EAAQ6B,kBAAkB+B,EAAgB,cAAe,WAAY,KAqKhEQ,EAAWC,gBACdC,GAAIC,KAAKC,OAlKF,MACb,MAAMjJ,EAAO+I,GAAIG,MAAMC,SAAS,aAAe,KACzC9R,EAAO0I,EAAWC,EAAM,QAE9B,MAAO,86BAgBmB3I,EAAKQ,soBAS4DR,EAAKS,yeAKLT,EAAKU,ueAKLV,EAAKW,2bAYlFX,EAAKY,46BAW8CZ,EAAKa,gIAEhDb,EAAKc,uNAGLd,EAAKmB,k0CAcsCnB,EAAKe,+HAEhDf,EAAKgB,sNAGLhB,EAAKmB,q2CAcsCnB,EAAKiB,kIAEhDjB,EAAKkB,yNAGLlB,EAAKmB,gwCAmBmCnB,EAAKoB,qqBAQLpB,EAAKqB,kzBAQLrB,EAAKsB,+oBAQLtB,EAAKuB,2HAc7CwQ,GAAY,QAElC/C,WAAW+B,EAAgB,KAE3B3D,EAAQwD,iBAAiB,MC/MvBoB,EAAWvT,EAAOG,IAAIC,QAKtBD,EAAM,CAOR,aAAMqT,CAAQC,EAAUC,EAAU,CAAC,GAC/B,MAAMC,EAAM,GAAGJ,IAAWE,IACpBxS,EAAQ0J,aAAaC,QAAQ5K,EAAOa,QAAQI,OAE5C2S,EAAiB,CACnB,eAAgB,oBAGhB3S,IACA2S,EAA8B,cAAI,UAAU3S,KAGhD,MAAM4S,EAAS,IACRH,EACHI,QAAS,IACFF,KACAF,EAAQI,UAInB,IACI,MAAMC,QAAiBC,MAAML,EAAKE,GAC5BrF,QAAauF,EAASE,OAE5B,IAAKF,EAASG,GACV,MAAM,IAAIC,MAAM3F,EAAK4F,SAAW,kBAGpC,OAAO5F,CACX,CAAE,MAAOvF,GAEL,MADAkC,QAAQlC,MAAM,aAAcA,GACtBA,CACV,CACJ,EAKA,GAAAoL,CAAIZ,GACA,OAAOpJ,KAAKmJ,QAAQC,EAAU,CAAEa,OAAQ,OAC5C,EAKA,IAAAC,CAAKd,EAAUe,GACX,OAAOnK,KAAKmJ,QAAQC,EAAU,CAC1Ba,OAAQ,OACRE,KAAM9B,KAAK+B,UAAUD,IAE7B,EAKA,GAAAE,CAAIjB,EAAUe,GACV,OAAOnK,KAAKmJ,QAAQC,EAAU,CAC1Ba,OAAQ,MACRE,KAAM9B,KAAK+B,UAAUD,IAE7B,EAKA,OAAOf,GACH,OAAOpJ,KAAKmJ,QAAQC,EAAU,CAAEa,OAAQ,UAC5C,GAMSK,EAEH,CACFhT,MAAQiT,GAAgBzU,EAAIoU,KAAK,cAAeK,GAChD/N,SAAW4L,GAAatS,EAAIoU,KAAK,iBAAkB9B,GACnD5Q,OAAQ,IAAM1B,EAAIoU,KAAK,gBACvB3S,QAAS,IAAMzB,EAAIkU,IAAI,iBAGvBlN,eAAiBL,GAAU3G,EAAIoU,KAAK,mBAAoB,CAAEzN,UAC1DQ,cAAe,CAACrG,EAAO4T,IAAgB1U,EAAIoU,KAAK,kBAAmB,CAAEtT,QAAO4T,iBAVvEF,EA8BL,CACAG,KAAM9B,MAAOoB,IAET,MAAMnT,EAAQ0J,aAAaC,QAAQ5K,EAAOa,QAAQI,OAElDkK,QAAQC,IAAI,oCAAqC,GAAGmI,aACpDpI,QAAQC,IAAI,WAAYgJ,GAExB,IACI,MAAMN,EAAU,CACZ,eAAgB,oBAIhB7S,IACA6S,EAAuB,cAAI,UAAU7S,KAGzC,MAAM8S,QAAiBC,MAAM,GAAGT,YAAoB,CAChDe,OAAQ,OACRR,QAASA,EACTU,KAAM9B,KAAK+B,UAAU,CACjBM,UAAWX,EACXA,QAASA,EACTlF,WAAW,IAAI8F,MAAOC,cACtBC,OAAQvK,aAAaC,QAAQ,SAAW,YACxC7J,SAAUiL,SAASC,gBAAgB/B,MAAQ,SAKnD,IAAIsE,EACJ,IACI,MAAM2G,QAAqBpB,EAAS/D,OACpC7E,QAAQC,IAAI,mBAAoB+J,GAChC3G,EAAO2G,EAAezC,KAAKC,MAAMwC,GAAgB,CAAC,CACtD,CAAE,MAAOC,GACLjK,QAAQlC,MAAM,eAAgBmM,GAC9B5G,EAAO,CAAC,CACZ,CAMA,GAJArD,QAAQC,IAAI,gCAAiC2I,EAASsB,QACtDlK,QAAQC,IAAI,8BAA+BoD,GAGvCA,EAAKvF,MACL,MAAM,IAAIkL,MAAM3F,EAAK4F,SAAW,oBAGpC,IAAKL,EAASG,GACV,MAAM,IAAIC,MAAM,uBAAuBJ,EAASsB,UAOpD,MAAO,CACHnM,SAAS,EACTsF,KAAM,CACFuF,SALWvF,EAAKA,MAAMuF,UAAYvF,EAAKuF,UAAYvF,EAAK8G,QAAU9G,EAAKwB,MAAQxB,EAAK4F,SAAW,eAQ3G,CAAE,MAAOnL,GAEL,MADAkC,QAAQlC,MAAM,oCAAqCA,GAC7CA,CACV,GAIJsM,KAAMvC,MAAOwC,IACT,MAAMvU,EAAQ0J,aAAaC,QAAQ5K,EAAOa,QAAQI,OAElDkK,QAAQC,IAAI,iCAAkC,GAAGmI,aACjDpI,QAAQC,IAAI,WAAYoK,GAExB,IACI,MAAM1B,EAAU,CACZ,eAAgB,oBAGhB7S,IACA6S,EAAuB,cAAI,UAAU7S,KAGzC,MAAM8S,QAAiBC,MAAM,GAAGT,YAAoB,CAChDe,OAAQ,OACRR,QAASA,EACTU,KAAM9B,KAAK+B,UAAUe,KAGzB,IAAIhH,EACJ,IACI,MAAM2G,QAAqBpB,EAAS/D,OACpC7E,QAAQC,IAAI,wBAAyB+J,GACrC3G,EAAO2G,EAAezC,KAAKC,MAAMwC,GAAgB,CAAC,CACtD,CAAE,MAAOC,GACLjK,QAAQlC,MAAM,eAAgBmM,GAC9B5G,EAAO,CAAC,CACZ,CAKA,GAHArD,QAAQC,IAAI,6BAA8B2I,EAASsB,QACnDlK,QAAQC,IAAI,2BAA4BoD,GAEpCA,EAAKvF,MACL,MAAM,IAAIkL,MAAM3F,EAAK4F,SAAW,yBAGpC,IAAKL,EAASG,GACV,MAAM,IAAIC,MAAM,uBAAuBJ,EAASsB,UAGpD,OAAO7G,CACX,CAAE,MAAOvF,GAEL,MADAkC,QAAQlC,MAAM,yCAA0CA,GAClDA,CACV,GAGJwM,UAAYC,GAAYvV,EAAIoU,KAAK,gBAAiBmB,ICvOpDC,EAAY,CACdnU,SAAU,KACN,MAAM0I,EAAO+I,GAAIG,MAAMC,SAAS,aAAe,KACzCuC,EAAI3L,EAAWC,EAAM,YAE3B,MAAO,2tBAaO0L,EAAE7S,6GAGF6S,EAAE7T,48BAgBM6T,EAAE5S,yUAMsE4S,EAAE3S,sjBAS5D2S,EAAE1S,yDACF0S,EAAEzS,gUAMwDyS,EAAExS,mjBAS5DwS,EAAEvS,0DACFuS,EAAEtS,0wBAYhBsS,EAAErS,8QAKsEqS,EAAEpS,4jBAQFoS,EAAEnS,kqCAgB1EmS,EAAE/R,ucAMsF+R,EAAE3Q,kYAIF2Q,EAAE3Q,kYAIF2Q,EAAE3Q,sxBAU9F2Q,EAAE1R,24CAcE0R,EAAEzR,4rBAS6CyR,EAAExR,2mBAONwR,EAAEvR,4zBAW7CuR,EAAEtR,kSAKoCsR,EAAErR,oOAGDqR,EAAEpR,4NAYnE,WAAY,KACR,MAAM0F,EAAO+I,GAAIG,MAAMC,SAAS,aAAe,KACzCwC,EAAK5L,EAAWC,EAAM,WAE5B,MAAO,uSAK2E2L,EAAG9S,qEACrC8S,EAAG9T,k8CAqBM8T,EAAG9P,ioBAcrB8P,EAAG/P,6qDAsByB+P,EAAG3Q,0dAM1C2Q,EAAG1Q,42BAUT0Q,EAAGzQ,oWAICyQ,EAAGxQ,kTAGHwQ,EAAGvQ,kTAGHuQ,EAAGtQ,oxBAWPsQ,EAAGrQ,8IAGHqQ,EAAGpQ,iLAW7B/D,UAAW,KACP,MAAMwI,EAAO+I,GAAIG,MAAMC,SAAS,aAAe,KACzCyC,EAAI7L,EAAWC,EAAM,aAE3B,MAAO,2QAKO4L,EAAE/S,6GAGF+S,EAAE/T,mXAO8C+T,EAAE9P,4RAIT8P,EAAE7P,iTAKK6P,EAAE5P,gRAIT4P,EAAE3P,8SAKK2P,EAAE1P,6QAIhB0P,EAAEzP,+SAKYyP,EAAExP,gRAIhBwP,EAAEvP,saAQhCuP,EAAEtP,6MAG+BsP,EAAEpP,yYAOnCoP,EAAErP,4MAG+BqP,EAAEnP,mIASzDC,KAAM,KACF,MAAMsD,EAAOS,aAAaC,QAAQ,sBAAwB,KACpDmL,EAAI9L,EAAWC,EAAM,QAE3B,MAAO,wyCAqBW6L,EAAEpU,yMAGFoU,EAAElP,sVAQ4DkP,EAAEjP,o5CAoBHiP,EAAEhP,uMAEvDgP,EAAE5O,4jDAwBV4O,EAAE3O,sWAQ4D2O,EAAE9O,8xCAmBF8O,EAAEjP,00CAmBFiP,EAAEhP,6uIAuDFgP,EAAE/O,81CAmBF+O,EAAE7O,6nCAY3B6O,EAAErO,4FACEqO,EAAEpO,q6BAe3CoO,EAAE1O,28BAcqD0O,EAAEzO,yFACfyO,EAAExO,2RAMkBwO,EAAEjP,m/CAsBhEiP,EAAEvO,ycASFuO,EAAEtO,6HASxB7F,QAAS,KACL,MAAMZ,EAAO0R,KAAKC,MAAMhI,aAAaC,QAAQ,kBAAoB,MAC3D9J,EAAQ6J,aAAaC,QAAQ,mBAAqB,OAClDV,EAAOS,aAAaC,QAAQ,sBAAwB,KACpDoL,EAAK/L,EAAWC,EAAM,WAE5B,MAAO,+RAKW8L,EAAGjT,yHAGHiT,EAAGjU,8aAOEf,EAAK4R,MAAQ,KAAKtC,OAAO,GAAGvD,+JAGqB/L,EAAK4R,MAAQ,6EAC9B5R,EAAK8F,OAAS,mJAC6C9F,EAAKkG,MAAQ,4QAM3C8O,EAAGzN,8EACvCvH,EAAK4R,MAAQ,sSAGuBoD,EAAGlP,yEACtC9F,EAAK8F,OAAS,oXAMFkP,EAAGxN,2QAKCwN,EAAGvN,0FACDuN,EAAGtN,4LAEiE,SAAV5H,EAAmB,gBAAkB,oIACnC,SAAVA,EAAmB,2BAA6B,oSAMpGkV,EAAGjV,0FACDiV,EAAGrN,kOAG8C,OAATuB,EAAgB,6BAA+B,8KACtC,OAATA,EAAgB,6BAA+B,kfAQ5I8L,EAAGpN,qFAqfZqN,EAAYjD,MAAOkD,IAC5B,MAAMC,EAAQC,GAAOC,kBACf/C,EAAWqC,EAAUQ,IAAUR,EAAUnU,eAEzCyR,GAAIC,KAAKC,OAA2B,mBAAbG,EAA0BA,IAAaA,EAAU6C,GAGhE,SAAVA,EAjfkB,MACtB,MAAMG,EAAWtK,SAASwG,eAAe,aACnC+D,EAAcvK,SAASwG,eAAe,gBAC5C,IAAIgE,EAAYxK,SAASwG,eAAe,cACpCiE,EAAezK,SAASwG,eAAe,iBAC3C,MAAMkE,EAAW1K,SAASwG,eAAe,aACnCmE,EAAqB3K,SAASwG,eAAe,wBAC7CoE,EAAoB5K,SAASwG,eAAe,uBAC5CqE,EAAiB7K,SAASwG,eAAe,qBACzCsE,EAAqB9K,SAASwG,eAAe,wBAGnD,GAAIgE,EAAW,CACX,MAAMO,EAAiBP,EAAUQ,WAAU,GAC3CR,EAAUS,YAAYF,GACtBP,EAAYO,CAChB,CACA,GAAIN,EAAc,CACd,MAAMS,EAAoBT,EAAaO,WAAU,GACjDP,EAAaQ,YAAYC,GACzBT,EAAeS,CACnB,CAGAZ,GAAUhJ,iBAAiB,QAAS,KAChCgJ,EAASpJ,UAAU+D,IAAI,UACvBsF,GAAarJ,UAAUoE,OAAO,UAC9BkF,GAAWtJ,UAAUoE,OAAO,UAC5BmF,GAAcvJ,UAAU+D,IAAI,YAIhCsF,GAAajJ,iBAAiB,QAAS,KACnCiJ,EAAYrJ,UAAU+D,IAAI,UAC1BqF,GAAUpJ,UAAUoE,OAAO,UAC3BmF,GAAcvJ,UAAUoE,OAAO,UAC/BkF,GAAWtJ,UAAU+D,IAAI,YAI7B,MAAMkG,EAAmBnL,SAASwG,eAAe,qBAC3C4E,EAAwBpL,SAASwG,eAAe,2BAChD6E,EAAoBrL,SAASwG,eAAe,+BAC5C8E,EAAetL,SAASwG,eAAe,0BACvC+E,EAAe,CACjBvL,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,mBAEtBgF,EAAWxL,SAASwG,eAAe,aACnCiF,EAAYzL,SAASwG,eAAe,cACpCkF,EAAe1L,SAASwG,eAAe,iBACvCmF,EAAY3L,SAASwG,eAAe,cAGpCoF,EAAsB,KACxB,MAAM1N,EAAOS,aAAaC,QAAQ,sBAAwB,KAC1D,OAAOiN,OAAO5N,WAAa4N,OAAO5N,WAAWC,EAAM,QAAU,CACzDtC,qBAA+B,OAATsC,EAAgB,yBAA2B,wBACjErC,UAAoB,OAATqC,EAAgB,uBAAyB,qBACpDpC,UAAoB,OAAToC,EAAgB,yBAA2B,sBACtDnC,OAAiB,OAATmC,EAAgB,eAAiB,cACzClC,KAAe,OAATkC,EAAgB,OAAS,QAC/BjC,OAAiB,OAATiC,EAAgB,SAAW,SACnChC,KAAe,OAATgC,EAAgB,OAAS,aAC/B/B,OAAiB,OAAT+B,EAAgB,SAAW,OACnC9B,cAAwB,OAAT8B,EAAgB,+EAAiF,yEAChH7B,iBAA2B,OAAT6B,EAAgB,0BAA4B,0BAsChE4N,EAAoB,CAACpL,EAASqL,EAAS/H,KACpCtD,IACDqL,GACArL,EAAQQ,UAAUoE,OAAO,yBACzB5E,EAAQQ,UAAU+D,IAAI,kBACtBvE,EAAQiE,UAAY,6SAIRX,2BAGZtD,EAAQQ,UAAU+D,IAAI,yBACtBvE,EAAQQ,UAAUoE,OAAO,kBACzB5E,EAAQiE,UAAY,qOAIRX,4BAKdgI,EAAoBC,IACtB,MAAM5M,EAAIuM,IASJ/D,EARS,CACX,EAAG,CAAEqE,IAAK,eAAgBlI,KAAM,GAAImI,MAAO,IAC3C,EAAG,CAAED,IAAK,aAAclI,KAAM,eAAgBmI,MAAO9M,EAAErD,MACvD,EAAG,CAAEkQ,IAAK,gBAAiBlI,KAAM,kBAAmBmI,MAAO9M,EAAEpD,QAC7D,EAAG,CAAEiQ,IAAK,gBAAiBlI,KAAM,kBAAmBmI,MAAO9M,EAAEnD,MAC7D,EAAG,CAAEgQ,IAAK,eAAgBlI,KAAM,iBAAkBmI,MAAO9M,EAAElD,SAGzC8P,GAGtBV,EAAa9K,QAAQ,CAACyL,EAAK9H,KAClB8H,IACLA,EAAIpH,UAAY,2DACZV,EAAQ6H,EACRC,EAAIhL,UAAU+D,IAAI4C,EAAOqE,KAEzBA,EAAIhL,UAAU+D,IAAI,mBAKtBqG,IACAA,EAAazK,YAAcgH,EAAOsE,MAClCb,EAAaxG,UAAY,uBAAuB+C,EAAO7D,SAK/DmH,GAAkB7J,iBAAiB,QAAS,KAvFX,MAC7B,MAAMjC,EAAIuM,IACNJ,IAAUA,EAAS3K,YAAcxB,EAAEzD,sBACnC6P,IAAWA,EAAUW,cAAc,QAAQvL,YAAcxB,EAAExD,WAC3D6P,IAAcA,EAAaU,cAAc,QAAQvL,YAAcxB,EAAEvD,WACjE6P,IAAWA,EAAUS,cAAc,QAAQvL,YAAcxB,EAAEtD,SAmF/DsQ,GACAjB,GAAuBlK,UAAUoE,OAAO,YAI5C6F,GAAkB7J,iBAAiB,OAAQ,KAClC6J,EAAiBmB,QAClBlB,GAAuBlK,UAAU+D,IAAI,UACrCoG,GAAmBnK,UAAU+D,IAAI,aAIzCkG,GAAkB7J,iBAAiB,QAAUC,IACzC,MAAMxG,EAAWwG,EAAElH,OAAOiS,MACpBjN,EAAIuM,IAKV,GAFAR,GAAuBlK,UAAUoE,OAAO,UAEpCvK,EAASsJ,OAAS,EAAG,CACrBgH,GAAmBnK,UAAUoE,OAAO,UACpC,MAAM,SAAE2G,GArGc,CAAClR,IAC3B,MAAMsE,EAAIuM,IACV,IAAIK,EAAW,EACf,MAAMM,EAAS,CACXlI,OAAQtJ,EAASsJ,QAAU,EAC3BvI,UAAW,QAAQ0Q,KAAKzR,GACxBgB,OAAQ,QAAQyQ,KAAKzR,GACrB0R,QAAS,yBAAyBD,KAAKzR,GACvC2R,UAAW,QAAQF,KAAKzR,IAc5B,OAVA+Q,EAAkBL,EAAWc,EAAOlI,OAAQhF,EAAExD,WAC9CiQ,EAAkBJ,EAAca,EAAOzQ,UAAWuD,EAAEvD,WACpDgQ,EAAkBH,EAAWY,EAAOxQ,OAAQsD,EAAEtD,QAG1CwQ,EAAOlI,QAAQ4H,IACfM,EAAOzQ,WAAWmQ,IAClBM,EAAOxQ,QAAQkQ,KACfM,EAAOE,SAAYF,EAAOG,WAAa3R,EAASsJ,QAAU,IAAI4H,IAE3D,CAAEA,WAAUM,WA+EMI,CAAsB5R,GAC3CiR,EAAiBC,EACrB,MACIZ,GAAmBnK,UAAU+D,IAAI,UACjC+G,EAAiB,GAEjBF,EAAkBL,GAAW,EAAOpM,EAAExD,WACtCiQ,EAAkBJ,GAAc,EAAOrM,EAAEvD,WACzCgQ,EAAkBH,GAAW,EAAOtM,EAAEtD,UAK9C6O,GAAmBtJ,iBAAiB,QAAS,KACzCoJ,GAAUxJ,UAAU+D,IAAI,UACxB0F,GAAoBzJ,UAAUoE,OAAO,YAIzCuF,GAAgBvJ,iBAAiB,QAAS,KACtCqJ,GAAoBzJ,UAAU+D,IAAI,UAClCyF,GAAUxJ,UAAUoE,OAAO,UAE3BgF,GAAUpJ,UAAU+D,IAAI,UACxBsF,GAAarJ,UAAUoE,OAAO,UAC9BkF,GAAWtJ,UAAUoE,OAAO,UAC5BmF,GAAcvJ,UAAU+D,IAAI,YAIhCuF,GAAWlJ,iBAAiB,SAAU0F,MAAOzF,IACzCA,EAAEE,iBACF,MAAM3G,EAAQkF,SAASwG,eAAe,gBAAgB8F,MAChDvR,EAAWiF,SAASwG,eAAe,mBAAmB8F,MAGtDM,EAAYpC,EAAU4B,cAAc,yBACpCS,EAAeD,GAAWjI,UAC5BiI,IACAA,EAAUjI,UAAY,8dAMtBiI,EAAUE,UAAW,SAGnB7F,GAAI8F,UAAUC,YAAYlS,EAAOC,GAGnC6R,IACAA,EAAUjI,UAAYkI,EACtBD,EAAUE,UAAW,KAK7BrC,GAAcnJ,iBAAiB,SAAU0F,MAAOzF,IAC5CA,EAAEE,iBACF,MAAMmF,EAAO5G,SAASwG,eAAe,kBAAkB8F,MACjDxR,EAAQkF,SAASwG,eAAe,mBAAmB8F,MACnDvR,EAAWiF,SAASwG,eAAe,sBAAsB8F,MACzDtR,EAAkBgF,SAASwG,eAAe,8BAA8B8F,MACxEpR,EAAO8E,SAASwG,eAAe,kBAAkB8F,MAMjDW,GAHIrB,IAGW7Q,EAASsJ,QAAU,GAClC6I,EAAe,QAAQV,KAAKzR,GAC5BoS,EAAY,QAAQX,KAAKzR,GAE/B,IAAKkS,IAAiBC,IAAiBC,EAEnC,OAIJ,GAAIpS,IAAaC,EAEb,OAIJ,MAAM4R,EAAYnC,EAAa2B,cAAc,yBACvCS,EAAeD,GAAWjI,UAC5BiI,IACAA,EAAUjI,UAAY,8dAMtBiI,EAAUE,UAAW,SAGnB7F,GAAI8F,UAAUK,eAAexG,EAAM9L,EAAOC,EAAUG,GAGtD0R,IACAA,EAAUjI,UAAYkI,EACtBD,EAAUE,UAAW,KAK7BhC,GAAoBxJ,iBAAiB,SAAU0F,MAAOzF,IAClDA,EAAEE,iBACF,MAAM3G,EAAQkF,SAASwG,eAAe,iBAAiB8F,MACjDpO,EAAOS,aAAaC,QAAQ,sBAAwB,KAE1D,IAAK9D,EAED,YADAmM,GAAIC,KAAKmG,UAAmB,OAATnP,EAAgB,0BAA4B,8BAA+B,SAKlG,MAAM0O,EAAY9B,EAAmBsB,cAAc,yBAC7CS,EAAeD,GAAWjI,UAC5BiI,IACAA,EAAUjI,UAAY,8dAMtBiI,EAAUE,UAAW,GAGzB,UAEUnE,EAASxN,eAAeL,GAG9BmM,GAAIC,KAAKmG,UACI,OAATnP,EACM,kDACA,kDACN,WAIJ8B,SAASwG,eAAe,gBAAgB8F,MAAQ,GAChD3B,GAAoBzJ,UAAU+D,IAAI,UAClCyF,GAAUxJ,UAAUoE,OAAO,SAE/B,CAAE,MAAOrI,GACLkC,QAAQlC,MAAM,yBAA0BA,GACxCgK,GAAIC,KAAKmG,UACLpQ,EAAMmL,UAAqB,OAATlK,EAAgB,4BAA8B,6BAChE,QAER,CAAE,QAEM0O,IACAA,EAAUjI,UAAYkI,EACtBD,EAAUE,UAAW,EAE7B,KA4JAQ,GACiB,YAAVnD,EAtJc,MACzB,IAAIoD,EAAYvN,SAASwG,eAAe,cACpCgH,EAAcxN,SAASwG,eAAe,wBAC1C,MAAMiH,EAAWzN,SAASQ,iBAAiB,qBAG3C,GAAI+M,EAAW,CACX,MAAMG,EAAiBH,EAAUvC,WAAU,GAC3CuC,EAAUtC,YAAYyC,GACtBH,EAAYG,CAChB,CACA,GAAIF,EAAa,CACb,MAAMG,EAAmBH,EAAYxC,WAAU,GAC/CwC,EAAYvC,YAAY0C,GACxBH,EAAcG,CAClB,CAEAJ,GAAWjM,iBAAiB,QAAS,KACjC2F,GAAI8F,UAAUa,iBAGlBJ,GAAalM,iBAAiB,QAAS,KACnC2F,GAAIG,MAAMyG,cACV,MAAMC,EAAMN,EAAYpB,cAAc,QAChC2B,EAAyC,SAAhC9G,GAAIG,MAAMC,SAAS,SAClCyG,GAAK5M,UAAUC,OAAO,gBAAiB4M,GACvCD,GAAK5M,UAAUC,OAAO,aAAc4M,GACpCP,EAAYtM,UAAUC,OAAO,gBAAiB4M,KAGlDN,EAAShN,QAAQW,IACbA,EAAIE,iBAAiB,QAAS,KAC1B,MAAMpD,EAAOkD,EAAIC,QAAQnD,KACzB+I,GAAIG,MAAMnI,YAAYf,GAEtBkM,GAAO4D,yBAoHXC,GACiB,aAAV9D,GA7GW,MACtB,MAAMpB,EAAY/I,SAASwG,eAAe,cACpC0H,EAAUlO,SAASwG,eAAe,YAClC2H,EAAoBnO,SAASwG,eAAe,iBAC5CpN,EAAmB4G,SAASQ,iBAAiB,qBAG7C4N,EAAa,CAACC,EAASC,GAAS,KAClC,MAAMC,GAAO,IAAIvF,MAAOwF,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAEzEC,EAAcL,EAAS,4QAIRD,2GAE0CE,sgBAQ3D,quBASyCF,iHAEwBE,iEAKrEJ,GAAmBS,mBAAmB,YAAaD,GAG/CR,IACAA,EAAkBU,UAAYV,EAAkBvK,eAKlDkL,EAAc,KAChB,MAAM1G,EAAUW,GAAWuD,OAAOyC,OAC7B3G,IAGLgG,EAAWhG,GAAS,GAGhBW,IAAWA,EAAUuD,MAAQ,IAGjC/H,WAAW,KACP,MAAMyK,EAAY,CACd,gIACA,gJACA,wIACA,2JAEEC,EAAiBD,EAAU5L,KAAK8C,MAAM9C,KAAK8L,SAAWF,EAAU3K,SACtE+J,EAAWa,GAAgB,IAC5B,OAIPf,GAAS5M,iBAAiB,QAASwN,GAGnC/F,GAAWzH,iBAAiB,UAAYC,IACtB,UAAVA,EAAE5B,KAAoB4B,EAAE4N,WACxB5N,EAAEE,iBACFqN,OAKR1V,EAAiBqH,QAAQW,IACrBA,EAAIE,iBAAiB,QAAS,KAC1B,MAAM8N,EAAahO,EAAIP,aAAakO,OAChChG,GAAaqG,IACbrG,EAAUuD,MAAQ8C,EAClBrG,EAAUsG,cAqBlBC,ICxjCKC,EAAcvI,UACvB7H,QAAQC,IAAI,uCACN6H,GAAIC,KAAKC,OA5LR,u+DAyBsF,IAAI6B,MAAOwF,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,+oGAmK7H,YAClCvP,QAAQC,IAAI,+CAhHI,MAChBD,QAAQC,IAAI,sCAEZ,MAAMoQ,EAAexP,SAASwG,eAAe,iBACvCiJ,EAAWzP,SAASwG,eAAe,aACnCuC,EAAY/I,SAASwG,eAAe,cACpC0H,EAAUlO,SAASwG,eAAe,YAClCkJ,EAAkB1P,SAASwG,eAAe,oBAiDhD,SAAS4H,EAAWC,EAASzZ,GACzB,MAAMsO,GAAY,IAAI8F,MAAOwF,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAC9EiB,EAAY3P,SAAS6E,cAAc,OACzC8K,EAAU7K,UAAY,yCAGlB6K,EAAUhL,UADD,OAAT/P,EACsB,mtBAQmCgb,EAAWvB,0HAECnL,yDAI/C,gRAImC0M,EAAWvB,qIAEYnL,qgBAUpFsM,EAAaxK,YAAY2K,GACzBE,GACJ,CAEA,SAASA,IACLL,EAAaX,UAAYW,EAAa5L,YAC1C,CAEA,SAASgM,EAAW5L,GAChB,MAAM8L,EAAM9P,SAAS6E,cAAc,OAEnC,OADAiL,EAAIjP,YAAcmD,EACX8L,EAAInL,SACf,CA9FAoE,EAAUzH,iBAAiB,QAAS,KAChC4M,EAAQpB,UAAY/D,EAAUuD,MAAMyC,SAIxCU,EAASnO,iBAAiB,SAAU0F,MAAOzF,IACvCA,EAAEE,iBACF,MAAM2G,EAAUW,EAAUuD,MAAMyC,OAEhC,GAAK3G,EAAL,CAGAgG,EAAWhG,EAAS,QAGpBW,EAAUuD,MAAQ,GAClB4B,EAAQpB,UAAW,EAGnB4C,EAAgBxO,UAAUoE,OAAO,UACjCuK,IAEA,IAEI,MAAM9H,QAAiBY,EAAOG,KAAKV,GAGnCsH,EAAgBxO,UAAU+D,IAAI,UAG1B8C,EAAS7K,SAAW6K,EAASvF,KAAKuF,SAClCqG,EAAWrG,EAASvF,KAAKuF,SAAU,MAEnCqG,EAAW,8CAA+C,KAElE,CAAE,MAAOnR,GACLkC,QAAQlC,MAAM,yBAA0BA,GACxCyS,EAAgBxO,UAAU+D,IAAI,UAC9BmJ,EAAW,0EAA2E,KAC1F,CA9BoB,IAkCxBrF,EAAUsG,QAqDVlQ,QAAQC,IAAI,6BAOZ2Q,IC/LEC,EAAe,4BACfC,EAAe,GAAGD,YAClBE,EAAmB,GAAGF,uBAK5B,SAASG,IACL,IAEI,OADazJ,KAAKC,MAAMhI,aAAaC,QAAQ,kBAAoB,MACrD1D,MAAQ,kBACxB,CAAE,MACE,MAAO,kBACX,CACJ,CAKA,MAAMkV,EAAgB,CAClBC,YAAa,GACbC,eAAgB,GAEhB9Y,eAAgB,GAChBC,kBAAmB,EACnB8Y,WAAY,GACZC,QAAS,GAETC,gBAAiB,EACjBC,gBAAiB,GACjBC,wBAAyB,EACzBC,cAAe,OAEfC,WAAW,EACXnR,OAAQ,MAMNoR,EAAe,CACjB,CAAEC,KAAM,KAAM/M,KAAM,uCAAwCrP,SAAU,KACtE,CAAEoc,KAAM,MAAO/M,KAAM,2CAA4CrP,SAAU,KAC3E,CAAEoc,KAAM,KAAM/M,KAAM,kCAAmCrP,SAAU,OAMxDqc,EAAehK,MAAOkD,IAC/B,MAAMmE,EAYV,WACI,MACM4C,EAA2B,mBADpBd,IAGb,MAAO,wSAKWc,EAAkB,sBAAwB,yHAG1CA,EACR,oFACA,iNAE+FA,EAAkB,iCAAmC,2FAC1GA,EAAkB,eAAiB,+CACrEA,EAAkB,iBAAmB,m/GAsDzBA,EAAkB,+jBAIhB,+gBAOFA,EAAkB,2BAA6B,iHAIvDA,EAAkB,kjDAgBhB,0gDAmBMA,EAAkB,qWAIhB,wmBAOFA,EAAkB,kBAAoB,gHAI9CA,EAAkB,+iFA4BhB,o+SA4H5B,CA7SoBC,SACVjK,GAAIC,KAAKC,OAAOkH,EAAS,YAG/B9J,WAAW,MA8Sf,WACI,MACM0M,EAA2B,mBADpBd,KAiBjB,WACI,MAAMgB,EAAiBnR,SAASwG,eAAe,mBACzC4K,EAAapR,SAASwG,eAAe,eAEvC2K,GACAA,EAAe7P,iBAAiB,QAAUC,IACtC6O,EAAcC,YAAcgB,WAAW9P,EAAElH,OAAOiS,OAChDgF,MAIJF,GACAA,EAAW9P,iBAAiB,QAAUC,IAClC6O,EAAcE,eAAiBe,WAAW9P,EAAElH,OAAOiS,OACnDgF,KAGZ,EA/BIC,GAmDJ,WACI,MAAMC,EAAsBxR,SAASwG,eAAe,mBAC9CiL,EAAmBzR,SAASwG,eAAe,sBAE7CgL,GACAA,EAAoBlQ,iBAAiB,SAAWC,IAC5C6O,EAAc5Y,eAAiB6O,SAAS9E,EAAElH,OAAOiS,QAAU,IAI/DmF,GACAA,EAAiBnQ,iBAAiB,SAAWC,IACzC6O,EAAc3Y,kBAAoB4O,SAAS9E,EAAElH,OAAOiS,QAAU,GAG1E,CAjEIoF,GAwHJ,WACI,MAAMC,EAAc3R,SAASwG,eAAe,gBACtCoL,EAAa5R,SAASwG,eAAe,gBAEvCmL,GACAA,EAAYrQ,iBAAiB,QAAS,IAmG9C0F,iBACI,GAAIoJ,EAAcS,UAAW,OAE7B,MAAMc,EAAc3R,SAASwG,eAAe,gBACtCqL,EAAmB7R,SAASwG,eAAe,qBAC3CsL,EAAkB9R,SAASwG,eAAe,oBAE5CmL,GAAaA,EAAYzQ,UAAU+D,IAAI,UACvC6M,GAAiBA,EAAgB5Q,UAAU+D,IAAI,UAC/C4M,GAAkBA,EAAiB3Q,UAAUoE,OAAO,UAExD8K,EAAcS,WAAY,EAE1B,MAAMkB,EAsIV/K,iBACI,MAAMgL,EAAchS,SAASwG,eAAe,gBACtCyL,EAAcjS,SAASwG,eAAe,gBAE5C,IAAK,IAAI0L,EAAI,EAAGA,EAAIpB,EAAazM,OAAS,EAAG6N,IAAK,CAC9C,MAAMjP,EAAO6N,EAAaoB,GACtBF,IAAaA,EAAYnR,YAAcoC,EAAK8N,MAC5CkB,IAAaA,EAAYpR,YAAcoC,EAAKe,YAC1CmO,EAAMlP,EAAKtO,SACrB,CAEA,MAAMyd,EAAYtB,EAAaA,EAAazM,OAAS,GACjD2N,IAAaA,EAAYnR,YAAcuR,EAAUrB,MACjDkB,IAAaA,EAAYpR,YAAcuR,EAAUpO,KACzD,CApJ2BqO,GAEvB,IACI,MAAM7I,EAyCd,WACI,MACMyH,EAA2B,mBADpBd,IAGPmC,EAAgB,CAClBjC,YAAaD,EAAcC,YAC3BC,eAAgBF,EAAcE,eAC9BiC,cAAe,GACfC,aAAc,IAGlB,IAAIC,EAAoB,UACpBrC,EAAcC,aAAe,EAC7BoC,EAAoB,eACbrC,EAAcC,YAAc,KACnCoC,EAAoB,WAGxB,IAOIC,EAAgBC,EAAkBC,EAPlCC,EAAiB,OASrB,GARIzC,EAAcC,aAAe,EAC7BwC,EAAiB,OACVzC,EAAcC,aAAe,KACpCwC,EAAiB,QAKjB5B,EAAiB,CAEjB,MAAM6B,EAAiB1C,EAAcK,gBAAkBL,EAAcM,gBAGrEgC,EAAiB,CACbK,iBAAkB1B,YAHIyB,EAAiB,GAAM,KAGCE,QAAQ,IACtDH,eAAgBA,EAChBJ,kBAAmBA,EACnBQ,QAAS,SACTC,eAAgB,SAGpBP,EAAmB,CACfQ,mBAAoB/C,EAAcgD,kBAAoB,KAG1D,MAAMC,EAAc,CAAEC,KAAM,qBAAsBC,MAAO,sBAAuBC,MAAO,uBAEvFZ,EACI,kCAAkCH,kBAAkCrC,EAAcC,YAAY2C,QAAQ,eAAe5C,EAAcE,eAAe0C,QAAQ,8BACpI5C,EAAcK,oCAAoCL,EAAcM,qCAAqCN,EAAcO,wEAC/GkC,sBACPQ,EAAYjD,EAAcQ,gBAAkB,oCACnCR,EAAcgD,kBAAoB,KAAMK,uBAC5E,KAAO,CAEH,MAAMV,EAAoB3C,EAAc5Y,eAAiB4Y,EAAcG,WAAc,IAErFmC,EAAiB,CACbK,iBAAkB1B,WAAW0B,EAAiBC,QAAQ,IACtDH,eAAgBA,EAChBJ,kBAAmBA,EACnBQ,QAAS,SACTC,eAAgB,aAGpBP,EAAmB,CACfQ,mBAAoB,KAGxB,MAAMO,EAAatD,EAAcI,QAC5BmD,IAAIC,GAAKA,EAAEhN,KAAO,GAAGgN,EAAEhN,SAASgN,EAAEvK,UAAY,UAAUuK,EAAE5V,QAAQ4V,EAAErF,SAASqF,EAAEvK,WAC/EwK,KAAK,MAEVjB,EACI,oCAAoCH,kBAAkCrC,EAAcC,YAAY2C,QAAQ,eAAe5C,EAAcE,eAAe0C,QAAQ,mBACjJ5C,EAAc5Y,6BAA6B4Y,EAAcG,qBAAqBH,EAAc3Y,qDACrFob,oBACDa,GAAc,mBACvC,CAEA,MAAO,CACHpB,gBACAI,iBACAC,mBACAC,qBAER,CA9HwBkB,GAChB3U,QAAQC,IAAI,iCAAkCoK,GAE9C,MAAMzB,QAAiBC,MAAMiI,EAAc,CACvC3H,OAAQ,OACRR,QAAS,CAAE,eAAgB,oBAC3BU,KAAM9B,KAAK+B,UAAUe,KAGzB,IAAKzB,EAASG,GACV,MAAM,IAAIC,MAAM,uBAAuBJ,EAASsB,UAGpD,MAAM3J,QAAeqI,EAASE,OAC9B9I,QAAQC,IAAI,uBAAwBM,GAEpC0Q,EAAc1Q,OAASA,QACjBqS,EACNgC,EAAsBrU,GAEtBuH,GAAIC,KAAKmG,UAAU,oCAAqC,UAE5D,CAAE,MAAOpQ,GACLkC,QAAQlC,MAAM,2BAA4BA,GAC1CkC,QAAQC,IAAI,+DAEN2S,EAEN,MAAMiC,EAiId,WACI,MACM/C,EAA2B,mBADpBd,IAEP8D,EAAeC,EAA4B9D,EAAcC,aAE/D,IAAI8D,EAAUC,EAEd,GAAInD,EAAiB,CACjB,MAAM6B,EAAiB1C,EAAcK,gBAAkBL,EAAcM,gBACrEyD,EAAW/Q,KAAKiR,MAAOvB,EAAiB,IAAO1C,EAAcgD,kBAAoB,MACjF,MAAMC,EAAc,CAAEC,KAAM,OAAQC,MAAO,QAASC,MAAO,SAE3DY,EAAY,6DAEiBH,wBAAmC7D,EAAcC,YAAY2C,QAAQ,wEAAwEK,EAAYjD,EAAcQ,gBAAkB,yCAAyCR,EAAcK,sCAAsCL,EAAcM,6EAGzTN,EAAcC,aAAe,EAAM,qEAAuE,oDACtHD,EAAcO,kHACEP,EAAcE,eAAe0C,QAAQ,WAAW5C,EAAcE,eAAiB,EAAI,yCAA2C,4RAMpHF,EAAcgD,kBAAoB,KAAMK,iCAC5D1E,MACN,MACIoF,EAAW/Q,KAAKiR,MAAOjE,EAAc5Y,eAAiB4Y,EAAcG,WAAc,KAElF6D,EAAY,6DAEiBH,wBAAmC7D,EAAcC,YAAY2C,QAAQ,yJAG1F5C,EAAcC,aAAe,EAAM,2DAA6D,2CAC5GD,EAAc3Y,qHACE2Y,EAAcE,eAAe0C,QAAQ,WAAW5C,EAAcE,eAAiB,EAAI,gDAAkD,2EAG9HF,EAAc5Y,uNAI/BuX,OAGN,MAAO,CACH7R,SAAS,EACTsF,KAAM,CACF8R,eAAgB,CACZC,uBAAwBN,EACxBO,+BAAgCL,EAChCM,iBAAkB,IAClBC,oBAAgC,GAAXP,GAEzBQ,yBAA0BP,GAGtC,CA5L2BQ,GACnBxE,EAAc1Q,OAASsU,EACvBD,EAAsBC,GAEtB/M,GAAIC,KAAKmG,UAAU,sCAAuC,OAC9D,CAAE,QACE+C,EAAcS,WAAY,CAC9B,CACJ,CAvJoDgE,IAG5CjD,GACAA,EAAWtQ,iBAAiB,QAAS,IAwhB7C,WACI,MAAMqQ,EAAc3R,SAASwG,eAAe,gBACtCqL,EAAmB7R,SAASwG,eAAe,qBAC3CsL,EAAkB9R,SAASwG,eAAe,oBAE5CmL,GAAaA,EAAYzQ,UAAUoE,OAAO,UAC1CuM,GAAkBA,EAAiB3Q,UAAU+D,IAAI,UACjD6M,GAAiBA,EAAgB5Q,UAAU+D,IAAI,UAEnDmL,EAAc1Q,OAAS,IAC3B,CAliBmDoV,GAEnD,CAlIIC,GAEI9D,EAmER,WACI,MAAM+D,EAAiBhV,SAASwG,eAAe,oBACzCyO,EAAiBjV,SAASwG,eAAe,qBACzC0O,EAAyBlV,SAASwG,eAAe,6BACjD2O,EAAwBnV,SAASwG,eAAe,qBAChD4O,EAAepV,SAASQ,iBAAiB,cAE3CwU,GACAA,EAAe1T,iBAAiB,SAAWC,IACvC6O,EAAcK,gBAAkBpK,SAAS9E,EAAElH,OAAOiS,QAAU,IAIhE2I,GACAA,EAAe3T,iBAAiB,SAAWC,IACvC6O,EAAcM,gBAAkBrK,SAAS9E,EAAElH,OAAOiS,QAAU,IAIhE4I,GACAA,EAAuB5T,iBAAiB,SAAWC,IAC/C6O,EAAcO,wBAA0BtK,SAAS9E,EAAElH,OAAOiS,QAAU,IAIxE6I,GACAA,EAAsB7T,iBAAiB,SAAWC,IAC9C6O,EAAcgD,iBAAmB/M,SAAS9E,EAAElH,OAAOiS,QAAU,MAKrE8I,EAAa3U,QAAQW,IACjBA,EAAIE,iBAAiB,QAAS,KAE1B8T,EAAa3U,QAAQ4U,IACjBA,EAAEnU,UAAUoE,OAAO,SAAU,gBAAiB,kBAC9C+P,EAAEnU,UAAU+D,IAAI,kBAAmB,mBAGvC7D,EAAIF,UAAU+D,IAAI,SAAU,gBAAiB,kBAC7C7D,EAAIF,UAAUoE,OAAO,kBAAmB,iBACxC8K,EAAcQ,cAAgBxP,EAAIC,QAAQiU,SAGtD,CA/GQC,GAoIRvO,iBACI,MAAMwO,EAAYxV,SAASwG,eAAe,qBAC1C,GAAKgP,EAEL,IACI,MAAMvgB,EAAQ0J,aAAaC,QAAQ,kBAC7BkJ,EAAU,CAAE,eAAgB,oBAC9B7S,IAAO6S,EAAuB,cAAI,UAAU7S,KAEhD,MAAM8S,QAAiBC,MAAM,GAAGkI,YAA4B,CAAEpI,YAE9D,IAAKC,EAASG,GACV,MAAM,IAAIC,MAAM,QAAQJ,EAASsB,UAGrC,MACMoM,SADe1N,EAASE,QACLzF,MAAQ,GAEjC,GAAyB,IAArBiT,EAAUpR,OAEV,YADAqR,EAAqBF,GAIzBpF,EAAcI,QAAUiF,EAAU9B,IAAIgC,IAAK,CACvC3X,GAAI2X,EAAEC,YACNhP,KAAM+O,EAAEE,YACRC,IAAKH,EAAEG,IACPzM,OAAQsM,EAAEtM,OACV0M,YAAaJ,EAAEK,iBACfC,QAASN,EAAEO,gBAcvB,SAAuBV,EAAWC,GAC9BD,EAAU7Q,UAAY8Q,EAAU9B,IAAIgC,IAChC,MAAMQ,EAAUR,EAAEG,IAAM,IAAI9M,KAAK2M,EAAEG,KAAO,KACpCM,EAAUD,EAAUA,EAAQ3H,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAAe,IAClG2H,EAA0C,cAA5BV,EAAEtM,QAAQvK,eAA6D,YAA5B6W,EAAEtM,QAAQvK,cACnE,6BACA,qCACAwX,EAAaX,EAAEtM,QAAU,YAE/B,MAAO,kOAGyDsM,EAAEE,aAAe,sGACbO,4JAGVT,EAAEO,cAAczC,kBAAoB,kFACrC4C,cAAwBC,mEAIlFzC,KAAK,GACZ,CAjCQ0C,CAAcf,EAAWC,EAE7B,CAAE,MAAOxY,GACLkC,QAAQU,KAAK,0CAA2C5C,EAAMmL,SAC9DsN,EAAqBF,EACzB,CACJ,CAxKQgB,EAER,CA1TQC,IACD,MAoVP,SAASnF,IACL,MAAMoF,EAAgB1W,SAASwG,eAAe,kBACxCmQ,EAAY3W,SAASwG,eAAe,cAEtCkQ,IACAA,EAAc7V,YAAc,GAAGuP,EAAcC,YAAY2C,QAAQ,SAEjE2D,IACAA,EAAU9V,YAAc,GAAGuP,EAAcE,eAAe0C,QAAQ,UAExE,CAiKA,SAAS0C,EAAqBF,GAC1BpF,EAAcI,QAAU,CACpB,CAAExS,GAAI,IAAK4I,KAAM,mBAAoB2H,KAAM,QAASlF,OAAQ,aAC5D,CAAErL,GAAI,IAAK4I,KAAM,eAAgB2H,KAAM,QAASlF,OAAQ,WACxD,CAAErL,GAAI,IAAK4I,KAAM,kBAAmB2H,KAAM,QAASlF,OAAQ,cAG/DmM,EAAU7Q,UAAYyL,EAAcI,QAAQmD,IAAIC,GAAK,oKAELA,EAAEhN,UAAUgN,EAAErF,2GAC2BqF,EAAEvK,uCAExFwK,KAAK,GACZ,CA2KA,SAAS1B,EAAMyE,GACX,OAAO,IAAIC,QAAQC,GAAWvS,WAAWuS,EAASF,GACtD,CAqEA,SAAS1C,EAA4B6C,GACjC,OAAIA,GAAY,EAAY,eACxBA,GAAY,GAAY,UACrB,SACX,CAeA,SAAShD,EAAsBrU,GAC3B,MAAMmS,EAAmB7R,SAASwG,eAAe,qBAC3CsL,EAAkB9R,SAASwG,eAAe,oBAC1CmL,EAAc3R,SAASwG,eAAe,gBAExCqL,GAAkBA,EAAiB3Q,UAAU+D,IAAI,UACjD0M,GAAaA,EAAYzQ,UAAU+D,IAAI,UACvC6M,GAAiBA,EAAgB5Q,UAAUoE,OAAO,UAEtD,MAAMpC,EAAYlD,SAASwG,eAAe,oBAC1C,GAAItD,EAAW,CACX,MAAMyC,EAAM,IAAIqD,KAChB9F,EAAUrC,YAAc,eAAe8E,EAAI8N,eAAe,QAAS,CAC/DuD,IAAK,UAAWC,MAAO,OAAQC,KAAM,UACrCzI,KAAM,UAAWC,OAAQ,aAEjC,EASJ,SAAuBlM,GACnB,MAAM2U,EAAcnX,SAASwG,eAAe,gBAC5C,IAAK2Q,EAAa,OAElB,MAAMC,EAAc5U,EAAK8R,gBAAkB,CAAC,EAEtCL,EAAemD,EAAY7C,wBAC7BL,EAA4B9D,EAAcC,aACxCgH,EA3CV,SAAwBpD,GACpB,MAAMqD,EAAQrD,EAAanV,cAC3B,OAAIwY,EAAMC,SAAS,SAAiB,MAChCD,EAAMC,SAAS,WAAmB,KAC/B,GACX,CAsCwBC,CAAevD,GAE7BE,EAAWiD,EAAY5C,gCACzB4C,EAAYK,mBACoB,GAA/BrH,EAAc5Y,eAEbkgB,EAAaN,EAAY3C,kBAC3B2C,EAAYO,kBAAoB,IAEpCR,EAAYxS,UAAY,4MAGa0S,4KAGkBpD,sFAEzC7D,EAAcC,YAAY2C,QAAQ,qBAAqB5C,EAAcE,eAAe0C,QAAQ,kbASnD5P,KAAKiR,MAAMF,GAAUV,eAAe,weAStB,IAAbiE,GAAkB1E,QAAQ,iOAGpC,IAAb0E,sDAIrC,CAzDIE,CAAclY,EAAO8C,MAAQ9C,GA8DjC,SAA+B8C,GAC3B,MAAMgT,EAAYxV,SAASwG,eAAe,6BAC1C,IAAKgP,EAAW,OAEhB,MAAMpB,EAAY5R,EAAKmS,0BACnBnS,EAAKqV,gBACLrV,EAAKuF,UACL,kCAEE+P,EAwBV,SAAkC1D,GAC9B,MAAM0D,EAAW,CAAEC,SAAU,GAAIC,MAAO,GAAIC,QAAS,IAE/CC,EAAgB9D,EAAU+D,MAAM,sEAChCC,EAAahE,EAAU+D,MAAM,2EAC7BE,EAAejE,EAAU+D,MAAM,0EAYrC,GAVID,GAAiBA,EAAc,KAC/BJ,EAASC,SAAWG,EAAc,GAAGnJ,QAErCqJ,GAAcA,EAAW,KACzBN,EAASE,MAAQI,EAAW,GAAGrJ,QAE/BsJ,GAAgBA,EAAa,KAC7BP,EAASG,QAAUI,EAAa,GAAGtJ,SAGlC+I,EAASC,WAAaD,EAASE,QAAUF,EAASG,QAAS,CAC5D,MAAMK,EAAalE,EAAU3U,MAAM,QAAQsC,OAAO6H,GAAKA,EAAEmF,QACrDuJ,EAAWjU,QAAU,IAAGyT,EAASC,SAAWO,EAAW,IACvDA,EAAWjU,QAAU,IAAGyT,EAASE,MAAQM,EAAW,IACpDA,EAAWjU,QAAU,IAAGyT,EAASG,QAAUK,EAAWC,MAAM,GAAG1E,KAAK,MAC5E,CAEA,OAAOiE,CACX,CAjDqBU,CAAyBpE,GAE1C,IAAIqE,EAAO,GAEPX,EAASC,WACTU,GAAQC,EAAyB,KAAM,iBAAkBZ,EAASC,SAAU,mCAE5ED,EAASE,QACTS,GAAQC,EAAyB,KAAM,oBAAqBZ,EAASE,MAAO,wCAE5EF,EAASG,UACTQ,GAAQC,EAAyB,IAAK,qBAAsBZ,EAASG,QAAS,wCAG7EH,EAASC,UAAaD,EAASE,OAAUF,EAASG,UACnDQ,EAAOC,EAAyB,KAAM,iBAAkBtE,EAAW,mCAGvEoB,EAAU7Q,UAAY8T,CAC1B,CAzFIE,CAAsBjZ,EAAO8C,MAAQ9C,EACzC,CA2HA,SAASgZ,EAAyB3H,EAAMha,EAAOsX,EAASuK,GACpD,IAAIC,EAAexK,EACdyK,QAAQ,mBAAoB,MAC5BA,QAAQ,eAAgB,MACxBA,QAAQ,eAAgB,IACxBA,QAAQ,+DAAgE,IACxE/J,OAEDgK,EAAmBF,EAEvB,GAAIA,EAAatB,SAAS,OAASsB,EAAatB,SAAS,MAAQsB,EAAatB,SAAS,KAAM,CACzF,MAAMyB,EAAQH,EAAapZ,MAAM,UAC5BkU,IAAIsF,GAAQA,EAAKlK,QACjBhN,OAAOkX,GAAQA,EAAK5U,OAAS,GAG9B0U,EADAC,EAAM3U,OAAS,EACI,+CACf2U,EAAMrF,IAAIsF,GAAQ,qCAAqCA,UAAapF,KAAK,IACzE,QAEe,oCAAoCgF,OAE/D,MACIE,EAAmB,oCAAoCF,QAG3D,MAAO,2HAEgCD,8IAEE7H,gGACwCha,oFAGtDgiB,+BAG/B,CChgCA,MAAM,EAAe,4BAKRG,EAAWlS,MAAOkD,IAE3BjD,GAAIC,KAAKiS,mBAGHlS,GAAIC,KAAKC,OAYR,s1qBAZwB,QAG/B5C,WAAW,MAsSf,WACI,MAAM+F,EAAWtK,SAASwG,eAAe,aACnC+D,EAAcvK,SAASwG,eAAe,gBACtCgE,EAAYxK,SAASwG,eAAe,cACpCiE,EAAezK,SAASwG,eAAe,iBAEzC8D,GAAYC,IACZD,EAAShJ,iBAAiB,QAAS,KAC/BgJ,EAASpJ,UAAU+D,IAAI,aAAc,cACrCqF,EAASpJ,UAAUoE,OAAO,yBAC1BiF,EAAYrJ,UAAUoE,OAAO,aAAc,cAC3CiF,EAAYrJ,UAAU+D,IAAI,yBAC1BuF,EAAUtJ,UAAUoE,OAAO,UAC3BmF,EAAavJ,UAAU+D,IAAI,YAG/BsF,EAAYjJ,iBAAiB,QAAS,KAClCiJ,EAAYrJ,UAAU+D,IAAI,aAAc,cACxCsF,EAAYrJ,UAAUoE,OAAO,yBAC7BgF,EAASpJ,UAAUoE,OAAO,aAAc,cACxCgF,EAASpJ,UAAU+D,IAAI,yBACvBwF,EAAavJ,UAAUoE,OAAO,UAC9BkF,EAAUtJ,UAAU+D,IAAI,YAGpC,EApCImU,GAyCJ,WACI,MAAMC,EAAOrZ,SAASwG,eAAe,cAChC6S,GAELA,EAAK/X,iBAAiB,SAAU0F,MAAOzF,IACnCA,EAAEE,iBAEF,MAAM3G,EAAQkF,SAASwG,eAAe,eAAe8F,MAAMyC,OACrDhU,EAAWiF,SAASwG,eAAe,kBAAkB8F,MACrDM,EAAY5M,SAASwG,eAAe,gBACpC8S,EAAU1M,EAAUR,cAAc,oBAGxCQ,EAAUE,UAAW,EACrBwM,EAAQpY,UAAUoE,OAAO,UAEzB,IACI,MAAMyC,QAAiBC,MAAM,GAAG,UAAsB,CAClDM,OAAQ,OACRR,QAAS,CAAE,eAAgB,oBAC3BU,KAAM9B,KAAK+B,UAAU,CAAE3N,QAAOC,eAG5B2E,QAAeqI,EAASE,OAE9B,IAAKF,EAASG,IAAMxI,EAAOzC,MACvB,MAAM,IAAIkL,MAAMzI,EAAO0I,SAAW,eAItCzJ,aAAaoB,QAAQ,qBAAsB,QAC3CpB,aAAaoB,QAAQ,iBAAkBL,EAAO8C,KAAKvN,OACnD0J,aAAaoB,QAAQ,gBAAiB2G,KAAK+B,UAAU,CACjDzK,GAAI0B,EAAO8C,KAAKxE,GAChBlD,MAAOA,EACP8L,KAAMlH,EAAO8C,KAAKqE,KAClB3L,KAAMwE,EAAO8C,KAAKtH,QAItBqe,GAAmB,EAAM7Z,EAAO8C,KAAKqE,MAGrCI,GAAIC,KAAKsS,aAGTjV,WAAW,KACP,MAAMkV,EAAgB9a,aAAaC,QAAQ,sBAAwB,OACnED,aAAa+a,WAAW,qBACxB7N,OAAO8N,SAASC,KAAOH,GACxB,IAEP,CAAE,MAAOxc,GACLgK,GAAIC,KAAKmG,UAAUpQ,EAAMmL,SAAW,4BAA6B,QACrE,CAAE,QACEwE,EAAUE,UAAW,EACrBwM,EAAQpY,UAAU+D,IAAI,SAC1B,GAER,CAnGI4U,GAwGJ,WACI,MAAMR,EAAOrZ,SAASwG,eAAe,iBACrC,IAAK6S,EAAM,OAGX,GAAmC,SAA/BA,EAAKhY,QAAQyY,cAEb,YADA3a,QAAQC,IAAI,kDAGhBia,EAAKhY,QAAQyY,cAAgB,OAE7B,IAAIC,GAAe,EAEnBV,EAAK/X,iBAAiB,SAAU0F,MAAOzF,IAKnC,GAJAA,EAAEE,iBACFF,EAAEyY,2BAGED,EAEA,YADA5a,QAAQC,IAAI,+DAIhB,MAAMwH,EAAO5G,SAASwG,eAAe,iBAAiB8F,MAAMyC,OACtDjU,EAAQkF,SAASwG,eAAe,kBAAkB8F,MAAMyC,OACxDhU,EAAWiF,SAASwG,eAAe,qBAAqB8F,MACxDjP,EAAU2C,SAASwG,eAAe,oBAAoB8F,MACtDpR,EAAO8E,SAASwG,eAAe,iBAAiB8F,MAChDM,EAAY5M,SAASwG,eAAe,mBACpC8S,EAAU1M,EAAUR,cAAc,oBAGxC,GAAIrR,IAAasC,EAKjB,GAAKnC,EAAL,CAMA6e,GAAe,EACfnN,EAAUE,UAAW,EACrBwM,EAAQpY,UAAUoE,OAAO,UAEzB,IAEI,MAAM2U,QAAyBjS,MAAM,GAAG,aAAyB,CAC7DM,OAAQ,OACRR,QAAS,CAAE,eAAgB,oBAC3BU,KAAM9B,KAAK+B,UAAU,CAAE5B,KAAMD,EAAM9L,QAAOC,WAAUG,WAGlDgf,QAAuBD,EAAiBhS,OAE9C,IAAKgS,EAAiB/R,IAAMgS,EAAejd,MACvC,MAAM,IAAIkL,MAAM+R,EAAe9R,SAAW,oBAI9C,MAAM+R,QAAsBnS,MAAM,GAAG,UAAsB,CACvDM,OAAQ,OACRR,QAAS,CAAE,eAAgB,oBAC3BU,KAAM9B,KAAK+B,UAAU,CAAE3N,QAAOC,eAG5Bqf,QAAoBD,EAAclS,OAExC,IAAIoS,EAAgBzT,EAChBuT,EAAcjS,KAAOkS,EAAYnd,QACjC0B,aAAaoB,QAAQ,qBAAsB,QAC3CpB,aAAaoB,QAAQ,iBAAkBqa,EAAY5X,KAAKvN,OACxD0J,aAAaoB,QAAQ,gBAAiB2G,KAAK+B,UAAU,CACjDzK,GAAIoc,EAAY5X,KAAKxE,GACrBlD,MAAOA,EACP8L,KAAMwT,EAAY5X,KAAKqE,KACvB3L,KAAMkf,EAAY5X,KAAKtH,QAE3Bmf,EAAgBD,EAAY5X,KAAKqE,MAIrC0S,GAAmB,EAAMc,GAGzBpT,GAAIC,KAAKsS,aAETjV,WAAW,KACP,MAAMkV,EAAgB9a,aAAaC,QAAQ,sBAAwB,OACnED,aAAa+a,WAAW,qBACxB7N,OAAO8N,SAASC,KAAOH,GACxB,IAEP,CAAE,MAAOxc,GACLgK,GAAIC,KAAKmG,UAAUpQ,EAAMmL,SAAW,mBAAoB,QAC5D,CAAE,QACE2R,GAAe,EACfnN,EAAUE,UAAW,EACrBwM,EAAQpY,UAAU+D,IAAI,SAC1B,CA7DA,MAFIgC,GAAIC,KAAKmG,UAAU,8BAA+B,cALlDpG,GAAIC,KAAKmG,UAAU,kCAAmC,UAsElE,CA9MIiN,GAoNgBta,SAASQ,iBAAiB,oBAClCC,QAAQU,IACZA,EAAOG,iBAAiB,QAAS,KAC7B,MAAMiZ,EAAQpZ,EAAOqZ,cAAcpO,cAAc,SAC3CqO,EAAUtZ,EAAOiL,cAAc,aAC/BsO,EAAYvZ,EAAOiL,cAAc,eAEpB,aAAfmO,EAAM3lB,MACN2lB,EAAM3lB,KAAO,OACb6lB,GAASvZ,UAAU+D,IAAI,UACvByV,GAAWxZ,UAAUoE,OAAO,YAE5BiV,EAAM3lB,KAAO,WACb6lB,GAASvZ,UAAUoE,OAAO,UAC1BoV,GAAWxZ,UAAU+D,IAAI,eA0MzC,WACI,MAAM2F,EAAoB5K,SAASwG,eAAe,uBAC5CmE,EAAqB3K,SAASwG,eAAe,wBAC7CqE,EAAiB7K,SAASwG,eAAe,iBACzCsE,EAAqB9K,SAASwG,eAAe,wBAC7CgE,EAAYxK,SAASwG,eAAe,cACpCiE,EAAezK,SAASwG,eAAe,iBACvCmU,EAAS3a,SAASoM,cAAc,qBAChCwO,EAAa5a,SAASwG,eAAe,eAG3CoE,GAAmBtJ,iBAAiB,QAAS,KACzCkJ,GAAWtJ,UAAU+D,IAAI,UACzBwF,GAAcvJ,UAAU+D,IAAI,UAC5B0V,GAAQzZ,UAAU+D,IAAI,UACtB2V,GAAY1Z,UAAU+D,IAAI,UAC1B0F,GAAoBzJ,UAAUoE,OAAO,YAIzCuF,GAAgBvJ,iBAAiB,QAAS,KACtCqJ,GAAoBzJ,UAAU+D,IAAI,UAClC0V,GAAQzZ,UAAUoE,OAAO,UACzBsV,GAAY1Z,UAAUoE,OAAO,UAC7BkF,GAAWtJ,UAAUoE,OAAO,YAIhCwF,GAAoBxJ,iBAAiB,SAAU0F,MAAOzF,IAClDA,EAAEE,iBAEF,MAAM3G,EAAQkF,SAASwG,eAAe,iBAAiB8F,OAAOyC,OACxDnC,EAAY5M,SAASwG,eAAe,iBACpC8S,EAAU1M,GAAWR,cAAc,oBAEzC,GAAKtR,EAAL,CAMA8R,EAAUE,UAAW,EACrBwM,GAASpY,UAAUoE,OAAO,UAE1B,UAEUqD,EAASxN,eAAeL,GAG9BmM,GAAIC,KAAKmG,UAAU,kDAAmD,WAGtErN,SAASwG,eAAe,gBAAgB8F,MAAQ,GAChD3B,GAAoBzJ,UAAU+D,IAAI,UAClC0V,GAAQzZ,UAAUoE,OAAO,UACzBkF,GAAWtJ,UAAUoE,OAAO,SAEhC,CAAE,MAAOrI,GACLkC,QAAQlC,MAAM,yBAA0BA,GACxCgK,GAAIC,KAAKmG,UAAUpQ,EAAMmL,SAAW,4BAA6B,QACrE,CAAE,QACEwE,EAAUE,UAAW,EACrBwM,GAASpY,UAAU+D,IAAI,SAC3B,CAzBA,MAFIgC,GAAIC,KAAKmG,UAAU,8BAA+B,UA6B9D,CA3eIwN,GAyOJ,WACI,MAAM1P,EAAmBnL,SAASwG,eAAe,qBAC3C4E,EAAwBpL,SAASwG,eAAe,2BAChD6E,EAAoBrL,SAASwG,eAAe,+BAC5C8E,EAAetL,SAASwG,eAAe,0BACvC+E,EAAe,CACjBvL,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,kBACxBxG,SAASwG,eAAe,mBAEtBiF,EAAYzL,SAASwG,eAAe,cACpCkF,EAAe1L,SAASwG,eAAe,iBACvCmF,EAAY3L,SAASwG,eAAe,cAE1C,IAAK2E,IAAqBC,EAAuB,OAGjD,MAAM0P,EAAoB7O,GACP,CAAC,GAAI,QAAS,QAAS,OAAQ,QAChCA,IAAa,GAwBzBH,EAAoB,CAACpL,EAASqL,KAChC,IAAKrL,EAAS,OACd,MAAMqa,EAAOra,EAAQ0L,cAAc,QAC7BpI,EAAO+W,EAAOA,EAAKla,YAAc,GAEnCkL,GACArL,EAAQQ,UAAUoE,OAAO,yBACzB5E,EAAQQ,UAAU+D,IAAI,kBACtBvE,EAAQiE,UAAY,6SAIRX,2BAGZtD,EAAQQ,UAAU+D,IAAI,yBACtBvE,EAAQQ,UAAUoE,OAAO,kBACzB5E,EAAQiE,UAAY,qOAIRX,2BAMdgI,EAAoBC,IACtB,MAQMpE,EARS,CACX,EAAG,CAAEqE,IAAK,eAAgBlI,KAAM,GAAIgX,MAAO,IAC3C,EAAG,CAAE9O,IAAK,aAAclI,KAAM,eAAgBgX,MAAOF,EAAiB,IACtE,EAAG,CAAE5O,IAAK,gBAAiBlI,KAAM,kBAAmBgX,MAAOF,EAAiB,IAC5E,EAAG,CAAE5O,IAAK,gBAAiBlI,KAAM,kBAAmBgX,MAAOF,EAAiB,IAC5E,EAAG,CAAE5O,IAAK,eAAgBlI,KAAM,iBAAkBgX,MAAOF,EAAiB,KAGxD7O,GAGtBV,EAAa9K,QAAQ,CAACyL,EAAK9H,KAClB8H,IACLA,EAAIpH,UAAY,2DACZV,EAAQ6H,EACRC,EAAIhL,UAAU+D,IAAI4C,EAAOqE,KAEzBA,EAAIhL,UAAU+D,IAAI,mBAKtBqG,IACAA,EAAazK,YAAcgH,EAAOmT,MAClC1P,EAAaxG,UAAY,uBAAuB+C,EAAO7D,SAK/DmH,EAAiB7J,iBAAiB,QAAS,KACvC8J,EAAsBlK,UAAUoE,OAAO,YAI3C6F,EAAiB7J,iBAAiB,OAAQ,KACjC6J,EAAiBmB,QAClBlB,EAAsBlK,UAAU+D,IAAI,UACpCoG,GAAmBnK,UAAU+D,IAAI,aAKzCkG,EAAiB7J,iBAAiB,QAAUC,IACxC,MAAMxG,EAAWwG,EAAElH,OAAOiS,MAK1B,GAFAlB,EAAsBlK,UAAUoE,OAAO,UAEnCvK,EAASsJ,OAAS,EAAG,CACrBgH,GAAmBnK,UAAUoE,OAAO,UACpC,MAAM,SAAE2G,EAAQ,OAAEM,GAlGI,CAACxR,IAC3B,IAAIkR,EAAW,EACf,MAAMM,EAAS,CACXlI,OAAQtJ,EAASsJ,QAAU,EAC3BvI,UAAW,QAAQ0Q,KAAKzR,GACxBgB,OAAQ,QAAQyQ,KAAKzR,GACrB2R,UAAW,QAAQF,KAAKzR,GACxB0R,QAAS,yBAAyBD,KAAKzR,IAS3C,OALIwR,EAAOlI,QAAQ4H,IACfM,EAAOzQ,WAAWmQ,IAClBM,EAAOxQ,QAAQkQ,KACfM,EAAOE,SAAYF,EAAOG,WAAa3R,EAASsJ,QAAU,KAAK4H,IAE5D,CAAEA,WAAUM,WAkFcI,CAAsB5R,GAGnD+Q,EAAkBL,EAAWc,EAAOlI,QACpCyH,EAAkBJ,EAAca,EAAOzQ,WACvCgQ,EAAkBH,EAAWY,EAAOxQ,QAGpCiQ,EAAiBC,EACrB,MACIZ,GAAmBnK,UAAU+D,IAAI,UACjC+G,EAAiB,GAGjBF,EAAkBL,GAAW,GAC7BK,EAAkBJ,GAAc,GAChCI,EAAkBH,GAAW,IAGzC,CArXIsP,IA9RG,MAypBP,SAAS1B,EAAmBrkB,EAAYwP,GACpC,MAAMwW,EAAWlb,SAASwG,eAAe,YACnC2U,EAAanb,SAASwG,eAAe,cACrC4U,EAAiBpb,SAASwG,eAAe,kBACzC6U,EAAmBrb,SAASwG,eAAe,oBAEjD,GAAItR,EAAY,CAEZgmB,GAAUha,UAAU+D,IAAI,UACxBiW,GAAUha,UAAUoE,OAAO,WAC3B8V,GAAgBla,UAAU+D,IAAI,UAG9BkW,GAAYja,UAAUoE,OAAO,UAC7B6V,GAAYja,UAAU+D,IAAI,QAC1BoW,GAAkBna,UAAUoE,OAAO,UACnC+V,GAAkBna,UAAU+D,IAAI,QAGhC,MAAMqW,EAAmBtb,SAASQ,iBAAiB,cAC7C+a,EAAsBvb,SAASQ,iBAAiB,iBAEtD8a,EAAiB7a,QAAQ+a,IACrBA,EAAG3a,YAAc6D,GAAY,SAGjC6W,EAAoB9a,QAAQ+a,IACxBA,EAAG3a,aAAe6D,GAAY,KAAKJ,OAAO,GAAGvD,eAErD,MAEIma,GAAUha,UAAUoE,OAAO,UAC3B4V,GAAUha,UAAU+D,IAAI,WACxBmW,GAAgBla,UAAUoE,OAAO,UAGjC6V,GAAYja,UAAU+D,IAAI,UAC1BkW,GAAYja,UAAUoE,OAAO,QAC7B+V,GAAkBna,UAAU+D,IAAI,UAChCoW,GAAkBna,UAAUoE,OAAO,OAE3C,CC5sBA,MAAMmW,EAAmBvd,IACd,CACHnH,MAAuB,iBACvBhB,SAAmB,OAATmI,EAAgB,gCAAkC,8BAC5D2K,YAAsB,OAAT3K,EAAgB,eAAiB,gBAC9ClD,gBAA0B,OAATkD,EAAgB,mBAAqB,sBACtDwd,OAAwB,iBACxBjgB,YAAsB,OAATyC,EAAgB,gBAAkB,mBAC/C7B,iBAA2B,OAAT6B,EAAgB,yBAA2B,uBAC7Dyd,iBAA2B,OAATzd,EAAgB,yCAA2C,8BAC7EhB,QAAkB,OAATgB,EAAgB,wCAA0C,6BACnEjB,MAAgB,OAATiB,EAAgB,2BAA6B,yBACpD0d,aAAuB,OAAT1d,EAAgB,gCAAkC,iDA4K3D2d,EAAoB7U,MAAOkD,IACpC,MAAMhM,EAAOS,aAAaC,QAAQ,sBAAwB,KACpDS,EAAIoc,EAAgBvd,GACpBjJ,EAAQiV,GAAQjV,MAGtB,IAAKA,EAGD,OAFAgS,GAAIC,KAAKmG,UAAUhO,EAAEuc,aAAc,cACnCxR,GAAO0R,SAAS,cAKd7U,GAAIC,KAAKC,OAlLI,CAACjJ,IACpB,MAAMmB,EAAIoc,EAAgBvd,GAE1B,MAAO,43CAkBsEmB,EAAEtI,iFACfsI,EAAEtJ,gSAMkBsJ,EAAEwJ,+3CAoBFxJ,EAAErE,mjDAuBhEqE,EAAEqc,8bASFrc,EAAE5D,6HAkGFsgB,CAAe7d,GAAO,kBAtF1B,CAACjJ,IACnB,MAAMokB,EAAOrZ,SAASwG,eAAe,uBAC/BqE,EAAiB7K,SAASwG,eAAe,iBACzCtI,EAAOS,aAAaC,QAAQ,sBAAwB,KACpDS,EAAIoc,EAAgBvd,GAG1B2M,GAAgBvJ,iBAAiB,QAAS,KACtC8I,GAAO0R,SAAS,UAIpBzC,GAAM/X,iBAAiB,SAAU0F,MAAOzF,IACpCA,EAAEE,iBAEF,MAAMoH,EAAc7I,SAASwG,eAAe,iBAAiB8F,MACvDtR,EAAkBgF,SAASwG,eAAe,yBAAyB8F,MAGzE,GAAIzD,EAAYxE,OAAS,EAErB,YADA4C,GAAIC,KAAKmG,UAAUhO,EAAEsc,iBAAkB,SAI3C,GAAI9S,IAAgB7N,EAEhB,YADAiM,GAAIC,KAAKmG,UAAUhO,EAAEhD,iBAAkB,SAK3C,MAAMuQ,EAAYyM,EAAKjN,cAAc,yBAC/BS,EAAeD,GAAWjI,UAC5BiI,IACAA,EAAUjI,UAAY,8dAMtBiI,EAAUE,UAAW,GAGzB,UAEUnE,EAASrN,cAAcrG,EAAO4T,GAGpC5B,GAAIC,KAAKmG,UAAUhO,EAAEnC,QAAS,WAG9BqH,WAAW,KACP6F,GAAO0R,SAAS,SACjB,IAEP,CAAE,MAAO7e,GACLkC,QAAQlC,MAAM,wBAAyBA,GACvCgK,GAAIC,KAAKmG,UACLpQ,EAAMmL,SAAW/I,EAAEpC,MACnB,QAER,CAAE,QAEM2P,IACAA,EAAUjI,UAAYkI,EACtBD,EAAUE,UAAW,EAE7B,KAuBJkP,CAAc/mB,ICzMZgnB,EAIY,aAJZA,EAQmB,oBARnBA,EASqB,sBATrBA,EAUqB,sBAVrBA,EAWyB,0BAXzBA,EAYW,WAZXA,EAac,cAbdA,EAcS,SASTC,EAAiB,CAEnBC,MAAO,CACHC,WAAY,CAAE9P,MAAO,EAAG+P,OAAQ,EAAGC,KAAM,OAAQtf,SAAS,GAC1Duf,aAAc,CAAEjQ,MAAO,EAAG+P,OAAQ,EAAGC,KAAM,OAAQtf,SAAS,GAC5D9G,WAAY,CAAEoW,MAAO,EAAG+P,OAAQ,EAAGC,KAAM,IAAKtf,SAAS,GACvD1E,aAAc,CAAEgU,MAAO,EAAG+P,OAAQ,EAAGC,KAAM,GAAItf,SAAS,IAG5DrD,QAAS,CACL6iB,YAAa,KACbC,UAAW,aACX1F,SAAU,KACV2F,UAAW,KACX1f,SAAS,GAGbpD,MAAO,CACHX,OAAQ,EACR0jB,MAAO,EACP3f,SAAS,GAGb4f,MAAO,GAEPC,SAAU,CAAEC,UAAU,GAEtBC,MAAO,KACPC,UAAW,OACXC,UAAW,CAAEC,OAAQ,GAAId,WAAY,GAAIG,aAAc,GAAIliB,OAAQ,IAEnE8iB,eAAgB,KAChBC,oBAAqB,KACrBC,oBAAqB,MAMnBC,EAAgBtW,MAAOS,EAAUC,EAAU,CAAC,KAC9C,MAAMzS,EAAQ0J,aAAaC,QAAQ,kBAC7BkJ,EAAU,CACZ,eAAgB,sBACZ7S,GAAS,CAAE,cAAiB,UAAUA,QACvCyS,EAAQI,SAGf,IACI,MAAMyV,EAAa,IAAIC,gBACjBC,EAAYlZ,WAAW,IAAMgZ,EAAWG,QAxDzC,KA0DC3V,QAAiBC,MAAM,4BAAwBP,IAAY,IAC1DC,EACHI,UACA6V,OAAQJ,EAAWI,SAIvB,OADAC,aAAaH,GACN1V,CACX,CAAE,MAAO9K,GAEL,OADAkC,QAAQU,KAAK,oBAAoB4H,IAAYxK,EAAMmL,SAC5C,IACX,GAMEyV,EAAgB7W,UAClB,IACI,MAAMe,QAAiBuV,EAAcrB,EAA+B,CAAE3T,OAAQ,QAE9E,GAAIP,GAAYA,EAASG,GAAI,CACzB,MAAM1F,QAAauF,EAASE,OAAO6V,MAAM,KAAM,CAAG,IAClD5B,EAAeW,SAASC,SAA2B,YAAhBta,EAAK6G,MAC5C,MACI6S,EAAeW,SAASC,UAAW,CAE3C,CAAE,MAAO7f,GACLif,EAAeW,SAASC,UAAW,CACvC,CAEAiB,KAGEA,EAAmB,KACrB,MAAMjQ,EAAM9N,SAASwG,eAAe,UAC9BxC,EAAOhE,SAASwG,eAAe,WAEhCsH,GAAQ9J,IAEb8J,EAAI5M,UAAUoE,OAAO,eAAgB,aAAc,eACnDtB,EAAK9C,UAAUoE,OAAO,iBAAkB,eAAgB,yBAEpD4W,EAAeW,SAASC,UACxBhP,EAAI5M,UAAU+D,IAAI,gBAClBjB,EAAKnD,YAAc,YACnBmD,EAAK9C,UAAU+D,IAAI,oBAEnB6I,EAAI5M,UAAU+D,IAAI,cAClBjB,EAAKnD,YAAc,aACnBmD,EAAK9C,UAAU+D,IAAI,mBAOrB+Y,EAAsBhX,UAExB,GADcrI,aAAaC,QAAQ,kBACnC,CAMA,IAEI,MAAMqf,QAAqBX,EAAcrB,GACzC,GAAIgC,GAAgBA,EAAa/V,GAAI,CACjC,MAAM1F,QAAayb,EAAahW,OAC1BiW,EAAQ1b,EAAKA,MAAQA,GAAQ,GACnC,GAAI2b,MAAMC,QAAQF,IAAUA,EAAM7Z,OAAS,EAAG,CAE1C,MAAMrK,EAAkBkkB,EAAMG,OAAO,CAACC,EAAK/U,IAChC+U,GAAO/U,EAAKgV,mBAAqBhV,EAAK6S,YAAc,GAC5D,GACHF,EAAeC,MAAMC,WAAW9P,MAAQtS,EACxCkiB,EAAeC,MAAMC,WAAWC,OAASmC,EAAgBN,EAC7D,CACJ,CAGA,MAAMO,QAAqBnB,EAAcrB,GACzC,GAAIwC,GAAgBA,EAAavW,GAAI,CACjC,MAAM1F,QAAaic,EAAaxW,OAC1BwN,EAAYjT,EAAKA,MAAQA,GAAQ,GACvC,GAAI2b,MAAMC,QAAQ3I,IAAcA,EAAUpR,OAAS,EAAG,CAClD,MAAMqa,EAAoBjJ,EAAU4I,OAAO,CAACC,EAAKK,IACtCL,GAAOK,EAAS1I,SAAW0I,EAASC,UAAY,GACxD,GACH1C,EAAeC,MAAMI,aAAajQ,MAAQoS,EAC1CxC,EAAeC,MAAMI,aAAaF,OAAS,GAC/C,CACJ,CAGA,MAAMwC,QAAyBvB,EAAcrB,GAC7C,GAAI4C,GAAoBA,EAAiB3W,GAAI,CACzC,MAAM1F,QAAaqc,EAAiB5W,OAC9BkM,EAAW3R,EAAKA,MAAQA,EAC9B,GAAI2R,QAA2C,IAAxBA,EAASje,WAC5BgmB,EAAeC,MAAMjmB,WAAWoW,MAAQ6H,EAASje,WACjDgmB,EAAeC,MAAMjmB,WAAWmmB,OAASlI,EAASkI,QAAU,SACzD,GAAI8B,MAAMC,QAAQjK,IAAaA,EAAS9P,OAAS,EAAG,CAEvD,MAAMya,EAAgB3K,EAASkK,OAAO,CAACC,EAAKS,IAAMT,GAAOS,EAAE7oB,YAAc6oB,EAAEC,MAAQ,GAAI,GAAK7K,EAAS9P,OACrG6X,EAAeC,MAAMjmB,WAAWoW,MAAQlJ,KAAKiR,MAAsB,GAAhByK,GAAsB,EAC7E,CACJ,CAGA,MAAMG,QAA4B3B,EAAcrB,GAChD,GAAIgD,GAAuBA,EAAoB/W,GAAI,CAC/C,MAAM1F,QAAayc,EAAoBhX,OACjCiX,EAAc1c,EAAKA,MAAQA,GAAQ,GACzC,GAAI2b,MAAMC,QAAQc,GAAc,CAE5B,MAAM5mB,EAAe4mB,EAAYnd,OAAOgd,IACvB,IAAbA,EAAE9lB,QACW,aAAb8lB,EAAE1V,QACW,WAAb0V,EAAE1V,QACJhF,QAAU6a,EAAY7a,OACxB6X,EAAeC,MAAM7jB,aAAagU,MAAQhU,EAE1C4jB,EAAeC,MAAM7jB,aAAa+jB,QAAU,CAChD,CACJ,CACJ,CAAE,MAAOpf,GACLkC,QAAQU,KAAK,mCAAoC5C,EACrD,CAGAkiB,IACAC,GAtEA,MAFIC,KA2EFb,EAAmBN,IACrB,GAAIA,EAAM7Z,OAAS,EAAG,OAAO,IAE7B,MAAMib,EAASpB,EAAM,IAAIK,mBAAqBL,EAAM,IAAI9B,YAAc,EAChEmD,EAAWrB,EAAM,IAAIK,mBAAqBL,EAAM,IAAI9B,YAAc,EACxE,OAAiB,IAAbmD,EAAuB,EACpBnc,KAAKiR,OAAQiL,EAASC,GAAYA,EAAY,IAAM,IAAM,IAG/DF,EAAmB,KACrBnD,EAAeC,MAAQ,CACnBC,WAAY,CAAE9P,MAAO,MAAO+P,OAAQ,IAAKC,KAAM,OAAQtf,SAAS,GAChEuf,aAAc,CAAEjQ,MAAO,KAAM+P,OAAQ,IAAKC,KAAM,OAAQtf,SAAS,GACjE9G,WAAY,CAAEoW,MAAO,KAAM+P,OAAQ,IAAKC,KAAM,IAAKtf,SAAS,GAC5D1E,aAAc,CAAEgU,MAAO,EAAG+P,QAAS,EAAGC,KAAM,GAAItf,SAAS,IAG7Dkf,EAAetiB,MAAQ,CAAEX,OAAQ,GAAI0jB,MAAO,GAAI3f,SAAS,IAGvDmiB,EAAqB,KACvB,MAAM,MAAEhD,GAAUD,EAEa,IAA3BC,EAAMC,WAAW9P,QAAa6P,EAAMC,WAAW9P,MAAQ,OAC1B,IAA7B6P,EAAMI,aAAajQ,QAAa6P,EAAMI,aAAajQ,MAAQ,MAChC,IAA3B6P,EAAMjmB,WAAWoW,QAAa6P,EAAMjmB,WAAWoW,MAAQ,MAG3B,IAA5B6P,EAAMC,WAAWC,SAAcF,EAAMC,WAAWC,OAAS,KAC3B,IAA9BF,EAAMI,aAAaF,SAAcF,EAAMI,aAAaF,OAAS,KACjC,IAA5BF,EAAMjmB,WAAWmmB,SAAcF,EAAMjmB,WAAWmmB,OAAS,KAC3B,IAA9BF,EAAM7jB,aAAa+jB,SAAcF,EAAM7jB,aAAa+jB,QAAU,GAElEF,EAAMC,WAAWpf,SAAU,EAC3Bmf,EAAMI,aAAavf,SAAU,EAC7Bmf,EAAMjmB,WAAW8G,SAAU,EAC3Bmf,EAAM7jB,aAAa0E,SAAU,GAG3BoiB,EAAgB,KAClB,MAAM,MAAEjD,GAAUD,EAGZsD,EAAYxf,SAASwG,eAAe,yBACpCiZ,EAAazf,SAASwG,eAAe,0BACvCgZ,IAAWA,EAAU3e,YAAcsb,EAAMC,WAAW9P,MAAMmH,kBAC1DgM,IAAYA,EAAW5e,YAAc,GAAGsb,EAAMC,WAAWC,QAAU,EAAI,IAAM,KAAKF,EAAMC,WAAWC,WAGvG,MAAMqD,EAAY1f,SAASwG,eAAe,2BACpCmZ,EAAa3f,SAASwG,eAAe,4BACvCkZ,IAAWA,EAAU7e,YAAcsb,EAAMI,aAAajQ,MAAMmH,kBAC5DkM,IAAYA,EAAW9e,YAAc,GAAGsb,EAAMI,aAAaF,QAAU,EAAI,IAAM,KAAKF,EAAMI,aAAaF,WAG3G,MAAMuD,EAAW5f,SAASwG,eAAe,yBACnCqZ,EAAY7f,SAASwG,eAAe,0BACtCoZ,IAAUA,EAAS/e,YAAcsb,EAAMjmB,WAAWoW,OAClDuT,IAAWA,EAAUhf,YAAc,GAAGsb,EAAMjmB,WAAWmmB,QAAU,EAAI,IAAM,KAAKF,EAAMjmB,WAAWmmB,WAGrG,MAAMyD,EAAa9f,SAASwG,eAAe,qBACrCuZ,EAAc/f,SAASwG,eAAe,sBACxCsZ,IAAYA,EAAWjf,YAAcsb,EAAM7jB,aAAagU,OACxDyT,IAAaA,EAAYlf,YAAcsb,EAAM7jB,aAAa+jB,SAM5D2D,EAAkBhZ,UACpB,IACI,MAAMe,QAAiBuV,EAAcrB,GAErC,GAAIlU,GAAYA,EAASG,GAAI,CACzB,MAAM1F,QAAauF,EAASE,OACtBtO,EAAU6I,EAAKA,MAAQA,EAEzB7I,IACAuiB,EAAeviB,QAAU,CACrB6iB,YAAa7iB,EAAQ6iB,aAAe7iB,EAAQsmB,MAAQ,GACpDxD,UAAW9iB,EAAQ8iB,WAAa9iB,EAAQumB,eAAiB,QACzDnJ,SAAUpd,EAAQ0W,aAAe1W,EAAQod,UAAY,EACrD2F,UAAW/iB,EAAQ2W,gBAAkB3W,EAAQwmB,YAAc,GAC3DnjB,SAAS,GAGrB,MAEIkf,EAAeviB,QAAU,CACrB6iB,YAAa,GACbC,UAAW,gBACX1F,SAAU,EACV2F,UAAW,GACX1f,SAAS,EAGrB,CAAE,MAAOC,GACLkC,QAAQU,KAAK,0BAA2B5C,GACxCif,EAAeviB,QAAQqD,SAAU,CACrC,CAEAojB,KAGEA,EAAkB,KACpB,MAAM,QAAEzmB,GAAYuiB,EAEdmE,EAASrgB,SAASwG,eAAe,gBACjC8Z,EAAStgB,SAASwG,eAAe,qBACjC+Z,EAASvgB,SAASwG,eAAe,oBACjCga,EAASxgB,SAASwG,eAAe,gBAEnC6Z,IAAQA,EAAOxf,YAAc,GAAGlH,EAAQ6iB,iBACxC8D,IAAQA,EAAOzf,YAAclH,EAAQ8iB,WACrC8D,IAAQA,EAAO1f,YAAc,GAAGlH,EAAQod,cACxCyJ,IAAQA,EAAO3f,YAAc,GAAGlH,EAAQ+iB,mBAM1C+D,EAAkBzZ,UACpB,IACI,MAAMe,QAAiBuV,EAAcrB,GAErC,GAAIlU,GAAYA,EAASG,GAAI,CACzB,MAAM1F,QAAauF,EAASE,OACtByY,EAAale,EAAKA,MAAQA,GAAQ,GAExC,GAAI2b,MAAMC,QAAQsC,IAAeA,EAAWrc,OAAS,EAAG,CACpD6X,EAAetiB,MAAM+iB,MAAQ+D,EAAWrc,OAExC,MAAMsc,EAAcD,EAAW3e,OAAOR,IAClC,MAAM8H,GAAU9H,EAAE8H,QAAU9H,EAAEqf,kBAAoB,IAAI9hB,cACtD,MAAkB,WAAXuK,GACQ,gBAAXA,GACW,cAAXA,GACW,YAAXA,IACa,IAAb9H,EAAEtI,SACc,IAAhBsI,EAAEsf,YACPxc,OAEH6X,EAAetiB,MAAMX,OAAS0nB,EAAc,EAAIA,EAAcD,EAAWrc,MAC7E,CACJ,MAEI6X,EAAetiB,MAAQ,CAAEX,OAAQ,GAAI0jB,MAAO,GAAI3f,SAAS,EAEjE,CAAE,MAAOC,GACLif,EAAetiB,MAAQ,CAAEX,OAAQ,GAAI0jB,MAAO,GAAI3f,SAAS,EAC7D,CAEAkf,EAAetiB,MAAMoD,SAAU,EAC/B8jB,KAGEA,EAAgB,KAClB,MAAM,MAAElnB,GAAUsiB,EACZ6E,EAAU/gB,SAASwG,eAAe,gBACpCua,IACAA,EAAQlgB,YAAc,GAAGjH,EAAMX,UAAUW,EAAM+iB,iBAOjDqE,GAAkBha,UACpB,IACI,MAAMe,QAAiBuV,EAAcrB,GAErC,GAAIlU,GAAYA,EAASG,GAAI,CACzB,MAAM1F,QAAauF,EAASE,OAC5BiU,EAAeU,MAAQpa,EAAKA,MAAQA,GAAQ,EAChD,CACJ,CAAE,MAAOvF,GACLkC,QAAQU,KAAK,wBAAyB5C,EAC1C,CAEAgkB,MAGEA,GAAgB,KAClB,MAAMrE,EAAQV,EAAeU,MAC7B,GAAqB,IAAjBA,EAAMvY,OAAc,OAGxB,MAAM6c,EAAclhB,SAASwG,eAAe,iBACtC2a,EAAcnhB,SAASwG,eAAe,iBAExCoW,EAAM,IAAMsE,IACZA,EAAYrgB,YAAc+b,EAAM,GAAGvT,QAAU,UAE7CuT,EAAM,IAAMuE,IACZA,EAAYtgB,YAAc+b,EAAM,GAAGvT,QAAU,WAkG/CuG,GAAc5L,IAChB,IAAKA,EAAM,MAAO,GAClB,MAAM8L,EAAM9P,SAAS6E,cAAc,OAEnC,OADAiL,EAAIjP,YAAcmD,EACX8L,EAAInL,WAmDT,GAAcyc,GACXA,EACQ,IAAIpY,KAAKoY,GACV5S,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAF9C2S,GAAW,IAAIrY,MAKlCsY,GAAoB,KACtB,MAAM3b,EAAM,IAAIqD,KAChBkT,EAAee,UAAY,CAAEC,OAAQ,GAAId,WAAY,GAAIG,aAAc,GAAIliB,OAAQ,IAEnF,IAAK,IAAI6X,EAAI,GAAIA,GAAK,EAAGA,IAAK,CAC1B,MAAM3D,EAAO,IAAIvF,KAAKrD,EAAI4b,UAAgB,EAAJrP,EAAQ,GAAK,KACnDgK,EAAee,UAAUC,OAAOpb,KAAKuf,GAAW9S,IAChD2N,EAAee,UAAUb,WAAWta,KAAKsB,KAAKiR,MAAM,IAAuB,IAAhBjR,KAAK8L,SAAiB,MACjFgN,EAAee,UAAUV,aAAaza,KAAKsB,KAAKiR,MAAM,IAAsB,IAAhBjR,KAAK8L,SAAiB,MAClFgN,EAAee,UAAU5iB,OAAOyH,KAAK,KACzC,GAGEuf,GAAcG,GAASA,EAAKhT,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,YAEnF+S,GAAc,KAChB,MAAMC,EAAS1hB,SAASwG,eAAe,mBACvC,IAAKkb,EAAQ,OAEb,MAAMC,EAAgB9V,OAAO+V,OAAOC,WAAWH,GAG/C,GAFIC,GAAeA,EAAcG,UAE7B5F,EAAea,MAAO,CACtB,IAAMb,EAAea,MAAM+E,SAAW,CAAE,MAAOvgB,GAAK,CACpD2a,EAAea,MAAQ,IAC3B,CAEA,MAAMgF,EAAML,EAAOM,WAAW,MACxBjU,EAAS/N,SAASC,gBAAgBiB,UAAU+gB,SAAS,QACrDC,EAAYnU,EAAS,wBAA0B,kBAC/CoU,EAAYpU,EAAS,wBAA0B,kBAE/CqU,EAAUvW,OAAO+V,OAASA,MAEhC1F,EAAea,MAAQ,IAAIqF,EAAQL,EAAK,CACpCntB,KAAMsnB,EAAec,UACrBxa,KAAM,CACF0a,OAAQhB,EAAee,UAAUC,OACjCmF,SAAU,CACN,CACIlW,MAAO,aACP3J,KAAM0Z,EAAee,UAAUb,WAC/BkG,YAAa,mBACbC,gBAAiB,yBACjBC,YAAa,EACbC,MAAM,EACNC,QAAS,IAEb,CACIvW,MAAO,eACP3J,KAAM0Z,EAAee,UAAUV,aAC/B+F,YAAa,oBACbC,gBAAiB,0BACjBC,YAAa,EACbC,MAAM,EACNC,QAAS,IAEb,CACIvW,MAAO,SACP3J,KAAM0Z,EAAee,UAAU5iB,OAC/BioB,YAAa,mBACbE,YAAa,EACbG,WAAY,CAAC,EAAG,GAChBF,MAAM,EACNG,YAAa,KAIzBlb,QAAS,CACLmb,YAAY,EACZC,qBAAqB,EACrBC,QAAS,CAAEC,OAAQ,CAAEjgB,SAAS,IAC9BkgB,OAAQ,CACJC,EAAG,CAAEC,KAAM,CAAEnI,MAAOkH,GAAakB,MAAO,CAAEpI,MAAOmH,IACjDkB,EAAG,CAAEhgB,IAAK,IAAKigB,IAAK,KAAMH,KAAM,CAAEnI,MAAOkH,GAAakB,MAAO,CAAEpI,MAAOmH,SAiBhFoB,GAAoB,KACtBrH,EAAekB,oBAAsBoG,YAAY,KAC7C,MAAM7d,EAAM,IAAIqD,MACV,UAAEiU,GAAcf,EAEtBe,EAAUC,OAAOpb,KAAKuf,GAAW1b,IACjC,MAAM8d,EAAWxG,EAAUb,WAAWa,EAAUb,WAAW/X,OAAS,IAAM,IACpEqf,EAAWzG,EAAUV,aAAaU,EAAUV,aAAalY,OAAS,IAAM,IAE9E4Y,EAAUb,WAAWta,KAAKsB,KAAKkgB,IAAI,IAAKlgB,KAAKC,IAAI,KAAMogB,GAAY,IAAuB,GAAhBrgB,KAAK8L,aAC/E+N,EAAUV,aAAaza,KAAKsB,KAAKkgB,IAAI,IAAKlgB,KAAKC,IAAI,KAAMqgB,GAAY,IAAuB,GAAhBtgB,KAAK8L,aACjF+N,EAAU5iB,OAAOyH,KAAK,MAElBmb,EAAUC,OAAO7Y,OAAS,KAC1B4Y,EAAUC,OAAO5H,QACjB2H,EAAUb,WAAW9G,QACrB2H,EAAUV,aAAajH,QACvB2H,EAAU5iB,OAAOib,SAGjB4G,EAAea,QACfb,EAAea,MAAMva,KAAK0a,OAASD,EAAUC,OAC7ChB,EAAea,MAAMva,KAAK6f,SAAS,GAAG7f,KAAOya,EAAUb,WACvDF,EAAea,MAAMva,KAAK6f,SAAS,GAAG7f,KAAOya,EAAUV,aACvDL,EAAea,MAAMva,KAAK6f,SAAS,GAAG7f,KAAOya,EAAU5iB,OACvD6hB,EAAea,MAAM4G,OAAO,UAEjC,MAkBDC,GAAU,KACR1H,EAAeiB,gBAAgB0G,cAAc3H,EAAeiB,gBAC5DjB,EAAekB,qBAAqByG,cAAc3H,EAAekB,qBACjElB,EAAemB,qBAAqBwG,cAAc3H,EAAemB,qBACjEnB,EAAea,QACfb,EAAea,MAAM+E,UACrB5F,EAAea,MAAQ,OAuM/B,IAAI+G,GAAiB,KAKd,MAAMC,GAAgB/c,UAErB8c,KACAA,KACAA,GAAiB,MAIrBF,WAGM3c,GAAIC,KAAKC,OAhNF,MACb,MAAM,MAAEgV,EAAK,QAAExiB,EAAO,MAAEC,GAAUsiB,EAElC,MAAO,mlDAyByFC,EAAMC,WAAWC,uJAEPF,EAAMC,WAAW9P,MAAMmH,ivCAW/B0I,EAAMI,aAAaF,yJAETF,EAAMI,aAAajQ,MAAMmH,sgCAWrC0I,EAAMjmB,WAAWmmB,uJAEPF,EAAMjmB,WAAWoW,27BAWlC6P,EAAM7jB,aAAa+jB,kJAENF,EAAM7jB,aAAagU,u/LA2E8B1S,EAAMX,UAAUW,EAAM+iB,4jCAc9GhjB,EAAQ8iB,iRAKqB9iB,EAAQ6iB,aAAe,0JAEtD7iB,EAAQod,UAAY,qgCA2C3D,GAAY,aAGlCxS,WAAWyC,UAEP6W,UAGMhH,QAAQmN,IAAI,CACdhG,IACAgC,IACAS,IACAO,OAzgBkBha,WAC1B,MAAMwO,EAAYxV,SAASwG,eAAe,wBACrCgP,IAGLA,EAAU7Q,UAAY,+XAUhB,IAAIkS,QAAQC,GAAWvS,WAAWuS,EAAS,MA8CvB,EAACtB,EAAWyO,EAAiBC,GAAa,KACpE,MAAMC,EAAS,CACXhtB,KAAM,CAAEitB,GAAI,gBAAiBpgB,KAAM,eAAgBqgB,OAAQ,qBAC3DpoB,OAAQ,CAAEmoB,GAAI,mBAAoBpgB,KAAM,kBAAmBqgB,OAAQ,wBACnEntB,IAAK,CAAEktB,GAAI,iBAAkBpgB,KAAM,gBAAiBqgB,OAAQ,uBAGhE7O,EAAU7Q,UAAYsf,EAAgBtQ,IAAI,CAAC2Q,EAAKpS,KAC5C,MAAM6M,EAAIoF,EAAOG,EAAIC,WAAaJ,EAAOloB,OACzC,MAAO,uJACyI,GAAJiW,kJAE9EtC,GAAW0U,EAAIvtB,8FACLgoB,EAAEqF,MAAMrF,EAAE/a,QAAQ+a,EAAEsF,WAAWC,EAAIC,0GAEnD3U,GAAW0U,EAAIE,wOAGS5U,GAAW0U,EAAIG,mGAKhG5Q,KAAK,IAEJqQ,IACA1O,EAAU7Q,WAAa,qIApE3B,CAAsB6Q,EAaS,MAE/B,MAAMkP,EAAcxI,EAAetiB,MAAMX,QAAU,GAC7C0rB,EAAazI,EAAetiB,MAAM+iB,OAAS,GAC3CiI,EAAmB1I,EAAeviB,QAAQ8iB,WAAa,QACvDoI,EAAc3I,EAAeC,MAAM7jB,aAAagU,OAAS,EAE/D,MAAO,CACH,CACIvV,MAAO,iDACPytB,YAAa,qGACbD,SAAU,OACVE,cAAe,UAAUC,UAAoBC,iEAEjD,CACI5tB,MAAO,0CACPytB,YAAa,2BAA2BI,kCACxCL,SAAU,SACVE,cAAe,0FAEnB,CACI1tB,MAAO,uCACPytB,YAAa,sBAAsBK,yCACnCN,SAAUM,EAAc,EAAI,OAAS,SACrCJ,cAAe,yEArCUK,IAA8B,KA0f3DC,GAxaU,MACd,IACI,QAA4B,IAAjBlZ,OAAO+V,OAA0C,oBAAVA,MAE9C,YADAziB,QAAQU,KAAK,wCAWHmH,WAElB,IACI,MAAMe,QAAiBuV,EAAc,GAAGrB,cAExC,GAAIlU,GAAYA,EAASG,GAAI,CACzB,MAAM1F,QAAauF,EAASE,OACtBiW,EAAQ1b,EAAKA,MAAQA,GAAQ,GAEnC,GAAI2b,MAAMC,QAAQF,IAAUA,EAAM7Z,OAAS,EASvC,OARA6X,EAAee,UAAY,CACvBC,OAAQgB,EAAMvK,IAAI/J,GAAK,GAAWA,EAAE4X,MAAQ5X,EAAEob,aAAaC,UAC3D7I,WAAY8B,EAAMvK,IAAI/J,GAAKA,EAAE2U,mBAAqB3U,EAAEwS,YAAc,GAAG6I,UACrE1I,aAAc2B,EAAMvK,IAAI/J,GAAKA,EAAE2S,cAAgBnZ,KAAKiR,MAAmC,IAA5BzK,EAAE2U,mBAAqB,KAAW0G,UAC7F5qB,OAAQ6jB,EAAMvK,IAAI,IAAM,OAE5B8N,UACA8B,IAGR,CACJ,CAAE,MAAOtmB,GACLkC,QAAQU,KAAK,sCAAuC5C,EACxD,CAGAqkB,KACAG,KACA8B,MAnCI2B,GA4HgB,MACpB,MAAM9jB,EAAMpB,SAASwG,eAAe,gBAChCpF,GACAA,EAAIE,iBAAiB,QAAS,KAC1B4a,EAAec,UAAyC,SAA7Bd,EAAec,UAAuB,MAAQ,OACzE5b,EAAIgL,cAAc,QAAQvL,YAA2C,SAA7Bqb,EAAec,UAAuB,OAAS,MACvFyE,QAjIJ0D,EACJ,CAAE,MAAOloB,GACLkC,QAAQlC,MAAM,8BAA+BA,EACjD,GAgaImoB,GA3PJlJ,EAAemB,oBAAsBmG,YAAY,KAC7CxF,IACAgC,IACAS,IACA5C,KApqBa,MA+5Bd,KAGHiG,GAAiB5hB,EAASE,GAAG,eAAiB+H,IAC5B,cAAVA,IACAyZ,KACIE,KACAA,KACAA,GAAiB,UCp7B3BxvB,GAAS,CAAC,EAGhB,IAAI+wB,GAAe,KAKZ,MAAMjb,GAAS,CAIlB,IAAApL,GAgBI,OAdAX,KAAKxD,SAAS,OAAQkM,GACtB1I,KAAKxD,SAAS,WAAYmW,GAC1B3S,KAAKxD,SAAS,WAAY0U,GAC1BlR,KAAKxD,SAAS,YAAakpB,IAC3B1lB,KAAKxD,SAAS,OAAQqe,GACtB7a,KAAKxD,SAAS,UAAWoP,GACzB5L,KAAKxD,SAAS,iBAAkBghB,GAGhChQ,OAAOvK,iBAAiB,aAAc,IAAMjD,KAAK2P,qBAGjD3P,KAAK2P,oBAEE3P,IACX,EAOA,QAAAxD,CAAS0E,EAAM+lB,GAEX,OADAhxB,GAAOiL,GAAQ+lB,EACRjnB,IACX,EAMA,QAAAyd,CAASvc,GACLsM,OAAO8N,SAASC,KAAOra,CAC3B,EAKA,uBAAMyO,GACF,MAAM4L,EAAO/N,OAAO8N,SAASC,KAAKrB,MAAM,IAAMvkB,EAAOM,OAAOC,SACrDgxB,EAAWC,GAAe5L,EAAKna,MAAM,KAG5C,GAAIzL,EAAOM,OAAOE,UAAU+iB,SAASgO,IACsC,SAApD5mB,aAAaC,QAAQ5K,EAAOa,QAAQK,YAMnD,OAHAyJ,aAAaoB,QAAQ,oBAAqBwlB,QAE1ClnB,KAAKyd,SAAS,QAMtB,MAAMwJ,EAAUhxB,GAAOixB,GAEvB,GAAID,EAAS,CACTD,GAAeE,EAGf,MAAMrb,EAAS7L,KAAKonB,WAAWD,SAGzBF,EAAQpb,GAGd7L,KAAKqnB,gBAAgBH,EACzB,MAEIlnB,KAAKyd,SAAS9nB,EAAOM,OAAOC,QAEpC,EAOA,UAAAkxB,CAAWD,GACP,IAAKA,EAAa,MAAO,CAAC,EAE1B,MAAMtb,EAAS,CAAC,EAQhB,OAPcsb,EAAY/lB,MAAM,KAE1BgB,QAAQklB,IACV,MAAOhmB,EAAK2M,GAASqZ,EAAKlmB,MAAM,KAChCyK,EAAO0b,mBAAmBjmB,IAAQimB,mBAAmBtZ,GAAS,MAG3DpC,CACX,EAMA,eAAAwb,CAAgBvb,GAEZnK,SAASQ,iBAAiB,iBAAiBC,QAAQolB,IAC/C,MAAMC,EAAYD,EAAKllB,aAAa,SAASmY,QAAQ,IAAK,IAC1D+M,EAAK3kB,UAAUC,OAAO,SAAU2kB,IAAc3b,KAIlDnK,SAASQ,iBAAiB,wBAAwBC,QAAQolB,IACtD,MAAMC,EAAYD,EAAKllB,aAAa,SAASmY,QAAQ,IAAK,IAC1D+M,EAAK3kB,UAAUC,OAAO,SAAU2kB,IAAc3b,KAIlD,MAAM4b,EAAa/lB,SAASwG,eAAe,eAC3Cuf,GAAY7kB,UAAU+D,IAAI,UAG1B/C,EAASK,KAAK,eAAgB4H,EAClC,EAMAE,gBAAe,IACJgb,IC7ITje,GAAQ,CACV4e,MAAO,CACHhxB,KAAM,KACNixB,iBAAiB,EACjBnxB,MAAOd,EAAOmB,SAASL,MACvBC,SAAUf,EAAOmB,SAASJ,SAC1BswB,aAAc,KACdxU,WAAW,GAGf,IAAA7R,GAEIX,KAAK2nB,MAAMlxB,MAAQ6J,aAAaC,QAAQ5K,EAAOa,QAAQC,QAAUd,EAAOmB,SAASL,MACjFuJ,KAAK2nB,MAAMjxB,SAAW4J,aAAaC,QAAQ5K,EAAOa,QAAQE,WAAaf,EAAOmB,SAASJ,SACvFsJ,KAAK2nB,MAAMC,gBAAsE,SAApDtnB,aAAaC,QAAQ5K,EAAOa,QAAQK,YAEjE,MAAMgxB,EAAYvnB,aAAaC,QAAQ5K,EAAOa,QAAQG,MACtD,GAAIkxB,EACA,IACI7nB,KAAK2nB,MAAMhxB,KAAO0R,KAAKC,MAAMuf,EACjC,CAAE,MAAO3kB,GACLlD,KAAK2nB,MAAMhxB,KAAO,IACtB,CAGJ,OAAOqJ,IACX,EAEA,QAAAgJ,CAAS1H,GACL,OAAOA,EAAMtB,KAAK2nB,MAAMrmB,GAAOtB,KAAK2nB,KACxC,EAEA,QAAAG,CAASxmB,EAAK2M,GAGV,OAFAjO,KAAK2nB,MAAMrmB,GAAO2M,EAClBpK,EAASK,KAAK,eAAgB,CAAE5C,MAAK2M,UAC9BjO,IACX,EAGA,KAAA1I,CAAMX,GAMF,OALAqJ,KAAK2nB,MAAMhxB,KAAOA,EAClBqJ,KAAK2nB,MAAMC,iBAAkB,EAC7BtnB,aAAaoB,QAAQ/L,EAAOa,QAAQG,KAAM0R,KAAK+B,UAAUzT,IACzD2J,aAAaoB,QAAQ/L,EAAOa,QAAQK,WAAY,QAChDgN,EAASK,KAAK,cAAe,CAAE0jB,iBAAiB,EAAMjxB,SAC/CqJ,IACX,EAEA,MAAAxI,GAOI,OANAwI,KAAK2nB,MAAMhxB,KAAO,KAClBqJ,KAAK2nB,MAAMC,iBAAkB,EAC7BtnB,aAAa+a,WAAW1lB,EAAOa,QAAQG,MACvC2J,aAAa+a,WAAW1lB,EAAOa,QAAQI,OACvC0J,aAAaoB,QAAQ/L,EAAOa,QAAQK,WAAY,SAChDgN,EAASK,KAAK,cAAe,CAAE0jB,iBAAiB,EAAOjxB,KAAM,OACtDqJ,IACX,EAGA,QAAA+nB,CAAStxB,GAKL,OAJAuJ,KAAK2nB,MAAMlxB,MAAQA,EACnB6J,aAAaoB,QAAQ/L,EAAOa,QAAQC,MAAOA,GAC3CkL,SAASC,gBAAgBiB,UAAUC,OAAO,OAAkB,SAAVrM,GAClDoN,EAASK,KAAK,eAAgBzN,GACvBuJ,IACX,EAEA,WAAAwP,GACI,MAAMwY,EAAgC,SAArBhoB,KAAK2nB,MAAMlxB,MAAmB,QAAU,OACzD,OAAOuJ,KAAK+nB,SAASC,EACzB,EAGA,WAAApnB,CAAYf,GAIR,OAHAG,KAAK2nB,MAAMjxB,SAAWmJ,EACtBS,aAAaoB,QAAQ/L,EAAOa,QAAQE,SAAUmJ,GAC9CgE,EAASK,KAAK,kBAAmBrE,GAC1BG,IACX,GAME6I,GAAO,CACTof,SAAU,CACNjY,QAAS,KACTkY,OAAQ,KACRC,eAAgB,MAGpB,IAAAxnB,GAQI,OAPAX,KAAKioB,SAASjY,QAAUrO,SAASwG,eAAe,eAChDnI,KAAKioB,SAASC,OAASvmB,SAASwG,eAAe,UAC/CnI,KAAKioB,SAASE,eAAiBxmB,SAASwG,eAAe,mBAGvDxG,SAASC,gBAAgBiB,UAAUC,OAAO,OAAoC,SAA5BiG,GAAMC,SAAS,UAE1DhJ,IACX,EAGA,YAAM8I,CAAOsR,EAAMgO,GAEVpoB,KAAKioB,SAASjY,UACfhQ,KAAKioB,SAASjY,QAAUrO,SAASwG,eAAe,gBAGpD,MAAM,QAAE6H,GAAYhQ,KAAKioB,SAEpBjY,GAMgD,KAA7BA,EAAQ1J,UAAUoK,SAItCV,EAAQnN,UAAU+D,IAAI,aACtBoJ,EAAQnN,UAAU+D,IAAI,0BAEhB5G,KAAK+H,MAAM,MAIrBiI,EAAQ1J,UAAY8T,EAGpBpK,EAAQnN,UAAUoE,OAAO,YAAa,oBAGtC+I,EAAQnN,UAAU+D,IAAI,cAGjBoJ,EAAQqY,YAEbrY,EAAQnN,UAAU+D,IAAI,qBAGtB/C,EAASK,KAAK,eAAgBkkB,SAExBpoB,KAAK+H,MAAM,KAGjBiI,EAAQnN,UAAUoE,OAAO,aAAc,qBAGnCuG,OAAO8a,QACP9a,OAAO8a,OAAOC,eAvCdznB,QAAQlC,MAAM,gCAyCtB,EAGA,YAAA4pB,CAAaZ,EAAiBjxB,GAC1B,MAAM8xB,EAAU9mB,SAASwG,eAAe,gBAClCugB,EAAW/mB,SAASwG,eAAe,iBACnCwgB,EAAchnB,SAASwG,eAAe,oBACtC9B,EAAW1E,SAASwG,eAAe,iBACnCygB,EAAYjnB,SAASwG,eAAe,kBAEtCyf,GAAmBjxB,GACnB8xB,GAAS5lB,UAAU+D,IAAI,UACvB8hB,GAAU7lB,UAAUoE,OAAO,UACvB0hB,IAAaA,EAAYnmB,aAAe7L,EAAK4R,MAAQ,KAAKtC,OAAO,GAAGvD,eACpE2D,IAAUA,EAAS7D,YAAc7L,EAAK4R,MAAQ,QAC9CqgB,IAAWA,EAAUpmB,YAAc7L,EAAK8F,OAAS,MAErDgsB,GAAS5lB,UAAUoE,OAAO,UAC1ByhB,GAAU7lB,UAAU+D,IAAI,UAEhC,EAGA,SAAAoI,CAAUjF,EAASxT,EAAO,OAAQD,EAAW,KACzC,MAAM6gB,EAAYnX,KAAKioB,SAASE,eAChC,IAAKhR,EAAW,OAEhB,MAOM0R,EAAQlnB,SAAS6E,cAAc,OACrCqiB,EAAMpiB,UAAY,aAAalQ,IAC/BsyB,EAAMviB,UAAY,iCATJ,CACVzH,QAAS,eACTD,MAAO,WACPkqB,QAAS,iBACTC,KAAM,QAMkBxyB,gFACUwT,qBAGtCoN,EAAUxQ,YAAYkiB,GAElBrb,OAAO8a,QACP9a,OAAO8a,OAAOC,cAGlBriB,WAAW,KACP2iB,EAAMhmB,UAAU+D,IAAI,WACpBV,WAAW,IAAM2iB,EAAM5hB,SAAU,MAClC3Q,EACP,EAGA,UAAAwkB,GACQ9a,KAAKioB,SAASC,QACdloB,KAAKioB,SAASC,OAAOrlB,UAAU+D,IAAI,UAGvC,MAAMoiB,EAASrnB,SAASwG,eAAe,UACnC6gB,GACAA,EAAOnmB,UAAU+D,IAAI,SAE7B,EAGA,UAAAuU,GACQnb,KAAKioB,SAASC,QACdloB,KAAKioB,SAASC,OAAOrlB,UAAUoE,OAAO,UAG1C,MAAM+hB,EAASrnB,SAASwG,eAAe,UACnC6gB,GACAA,EAAOnmB,UAAUoE,OAAO,SAEhC,EAGAc,MAAMwQ,GACK,IAAIC,QAAQC,GAAWvS,WAAWuS,EAASF,KAOpD7J,GAAY,CACd,IAAA/N,GAEI,OADAX,KAAKipB,sBACEjpB,IACX,EAEA,mBAAAipB,GAEIplB,EAASE,GAAG,cAAe,EAAG6jB,kBAAiBjxB,WAC3CkS,GAAK2f,aAAaZ,EAAiBjxB,GAC9BixB,GACD7b,GAAO0R,SAAS,UAKxB5Z,EAASE,GAAG,eAAiBtN,IACzBqK,QAAQC,IAAI,iBAAkBtK,IAEtC,EAGA,iBAAMkY,CAAYlS,EAAOC,GACrB,IAEI,MAAMgN,QAAiBC,MAAM,kCAAmC,CAC5DM,OAAQ,OACRR,QAAS,CACL,eAAgB,oBAEpBU,KAAM9B,KAAK+B,UAAU,CAAE3N,QAAOC,eAG5B2E,QAAeqI,EAASE,OAE9B,IAAKF,EAASG,IAAMxI,EAAOzC,MACvB,MAAM,IAAIkL,MAAMzI,EAAO0I,SAAW,eAGtC,MAAMpT,EAAO,CACTgJ,GAAI0B,EAAO8C,KAAKxE,GAChB4I,KAAMlH,EAAO8C,KAAKqE,KAClB/L,MAAOA,EACPI,KAAMwE,EAAO8C,KAAKtH,KAClBjG,MAAOyK,EAAO8C,KAAKvN,OAavB,OATA0J,aAAaoB,QAAQ,iBAAkBL,EAAO8C,KAAKvN,OAEnDmS,GAAMzR,MAAMX,GACZkS,GAAKmG,UAAU,kBAAmB,WAElC9I,WAAW,KACP6F,GAAO0R,SAAS,SACjB,MAEI,CACX,CAAE,MAAO7e,GAEL,OADAiK,GAAKmG,UAAU,gBAAkBpQ,EAAMmL,QAAS,UACzC,CACX,CACJ,EAGA,oBAAMgF,CAAexG,EAAM9L,EAAOC,EAAUG,GACxC,IAEI,MAAM+e,QAAyBjS,MAAM,qCAAsC,CACvEM,OAAQ,OACRR,QAAS,CACL,eAAgB,oBAEpBU,KAAM9B,KAAK+B,UAAU,CACjB5B,KAAMD,EACN9L,QACAC,WACAG,KAAMA,GAAQ,YAIhBgf,QAAuBD,EAAiBhS,OAG9C,GAFA9I,QAAQC,IAAI,qBAAsB8a,IAE7BD,EAAiB/R,IAAMgS,EAAejd,MACvC,MAAM,IAAIkL,MAAM+R,EAAe9R,SAAW,oBAI9C,MAAM+R,QAAsBnS,MAAM,kCAAmC,CACjEM,OAAQ,OACRR,QAAS,CACL,eAAgB,oBAEpBU,KAAM9B,KAAK+B,UAAU,CAAE3N,QAAOC,eAG5Bqf,QAAoBD,EAAclS,OAExC,GAAIkS,EAAcjS,KAAOkS,EAAYnd,MAAO,CACxC,MAAMjI,EAAO,CACTgJ,GAAIoc,EAAY5X,KAAKxE,GACrB4I,KAAMwT,EAAY5X,KAAKqE,KACvB/L,MAAOA,EACPI,KAAMkf,EAAY5X,KAAKtH,KACvBjG,MAAOmlB,EAAY5X,KAAKvN,OAI5B0J,aAAaoB,QAAQ,iBAAkBqa,EAAY5X,KAAKvN,OAExDmS,GAAMzR,MAAMX,EAChB,KAAO,CAEH,MAAMA,EAAO,CACTgJ,GAAIgL,KAAKrD,MACTiB,KAAMA,EACN9L,MAAOA,EACPI,KAAMA,GAAQ,SAElBkM,GAAMzR,MAAMX,EAChB,CAQA,OANAkS,GAAKmG,UAAU,uBAAwB,WAEvC9I,WAAW,KACP6F,GAAO0R,SAAS,SACjB,MAEI,CACX,CAAE,MAAO7e,GAEL,OADAiK,GAAKmG,UAAU,qBAAuBpQ,EAAMmL,QAAS,UAC9C,CACX,CACJ,EAGA,YAAAwF,GACIxG,GAAMvR,SACNqR,GAAKmG,UAAU,kBAAmB,OACtC,GAMSpG,GAAM,CACfG,SACAF,QACA6F,aAEA,IAAA/N,GASI,OARAoI,GAAMpI,OACNkI,GAAKlI,OACL+N,GAAU/N,OAGVkI,GAAK2f,aAAazf,GAAMC,SAAS,mBAAoBD,GAAMC,SAAS,SAEpElI,QAAQC,IAAI,mBACLf,IACX,GC9YEkpB,GAAoBrpB,IACtB,MAAM5I,EAAM2I,EAAWC,EAAM,OAG7B8B,SAASQ,iBAAiB,wBAAwBC,QAAQolB,IACtD,MAAM2B,EAAO3B,EAAKxkB,QAAQmmB,KACpBzM,EAAO8K,EAAKzZ,cAAc,QAC5B2O,IACa,SAATyM,IAAiBzM,EAAKla,YAAcvL,EAAIC,MAC/B,aAATiyB,IAAqBzM,EAAKla,YAAcvL,EAAIE,UACnC,aAATgyB,IAAqBzM,EAAKla,YAAcvL,EAAIG,SACnC,cAAT+xB,IAAsBzM,EAAKla,YAAcvL,EAAII,cAKzDsK,SAASQ,iBAAiB,+BAA+BC,QAAQolB,IAC7D,MAAM2B,EAAO3B,EAAKxkB,QAAQmmB,KACpBzM,EAAO8K,EAAKzZ,cAAc,QAC5B2O,IACa,SAATyM,IAAiBzM,EAAKla,YAAcvL,EAAIC,MAC/B,aAATiyB,IAAqBzM,EAAKla,YAAcvL,EAAIE,UACnC,aAATgyB,IAAqBzM,EAAKla,YAAcvL,EAAIG,SACnC,cAAT+xB,IAAsBzM,EAAKla,YAAcvL,EAAII,cAKzD,MAAM+xB,EAAeznB,SAASoM,cAAc,kBACtCsb,EAAqB1nB,SAASoM,cAAc,wBAC9Cqb,IAAcA,EAAa5mB,YAAcvL,EAAIK,OAC7C+xB,IAAoBA,EAAmB7mB,YAAcvL,EAAIK,OAG7DqK,SAASQ,iBAAiB,gBAAgBC,QAAQW,IAC9C,MAAMH,EAAWG,EAAIC,QAAQnD,OAASA,EACtCkD,EAAIF,UAAUC,OAAO,aAAcF,GACnCG,EAAIF,UAAUC,OAAO,0BAA2BF,GAChDG,EAAIF,UAAUC,OAAO,YAAaF,GAE9BA,EACAG,EAAIF,UAAUoE,OAAO,uBAErBlE,EAAIF,UAAU+D,IAAI,yBAI1BjF,SAASQ,iBAAiB,uBAAuBC,QAAQW,IACrD,MAAMH,EAAWG,EAAIC,QAAQnD,OAASA,EACtCkD,EAAIF,UAAUC,OAAO,aAAcF,GACnCG,EAAIF,UAAUC,OAAO,0BAA2BF,GAChDG,EAAIF,UAAUC,OAAO,mBAAoBF,MAmF3C0mB,GAAwBxd,IAE1BnK,SAASQ,iBAAiB,aAAaC,QAAQolB,IAC3C,MAAM2B,EAAO3B,EAAKxkB,QAAQmmB,KAC1B3B,EAAK3kB,UAAUC,OAAO,SAAUqmB,IAASrd,KAI7CnK,SAASQ,iBAAiB,oBAAoBC,QAAQolB,IAClD,MAAM2B,EAAO3B,EAAKxkB,QAAQmmB,KAC1B3B,EAAK3kB,UAAUC,OAAO,SAAUqmB,IAASrd,MAO3C0c,GAAe,KACjB,MAAM3xB,EAAa+R,GAAIG,MAAMC,SAAS,mBAChCrS,EAAOiS,GAAIG,MAAMC,SAAS,QAE1B6T,EAAWlb,SAASwG,eAAe,YACnC2U,EAAanb,SAASwG,eAAe,cACrC4U,EAAiBpb,SAASwG,eAAe,kBACzC6U,EAAmBrb,SAASwG,eAAe,oBAEjD,GAAItR,GAAcF,EAAM,CACpBkmB,GAAUha,UAAU+D,IAAI,UACxBkW,GAAYja,UAAUoE,OAAO,UAC7B6V,GAAYja,UAAU+D,IAAI,QAC1BmW,GAAgBla,UAAU+D,IAAI,UAC9BoW,GAAkBna,UAAUoE,OAAO,UACnC+V,GAAkBna,UAAU+D,IAAI,QAGhC,MAAM2iB,GAAW5yB,EAAK4R,MAAQ,KAAKtC,OAAO,GAAGvD,cAC7Cf,SAASQ,iBAAiB,iBAAiBC,QAAQ+a,GAAMA,EAAG3a,YAAc+mB,GAC1E5nB,SAASQ,iBAAiB,cAAcC,QAAQ+a,GAAMA,EAAG3a,YAAc7L,EAAK4R,MAAQ,OACxF,MACIsU,GAAUha,UAAUoE,OAAO,UAC3B4V,GAAUha,UAAU+D,IAAI,QACxBkW,GAAYja,UAAU+D,IAAI,UAC1BkW,GAAYja,UAAUoE,OAAO,QAC7B8V,GAAgBla,UAAUoE,OAAO,UACjC8V,GAAgBla,UAAU+D,IAAI,QAC9BoW,GAAkBna,UAAU+D,IAAI,UAChCoW,GAAkBna,UAAUoE,OAAO,SAOrC+H,GAAY,CAACjF,EAASxT,EAAO,OAAQD,EAAW,OAClD,MAAM6gB,EAAYxV,SAASwG,eAAe,mBAC1C,IAAKgP,EAAW,OAEhB,MAAMqS,EAAQ,CACV3qB,QAAS,kOACTD,MAAO,uPACPmqB,KAAM,6OAGJF,EAAQlnB,SAAS6E,cAAc,OACrCqiB,EAAMpiB,UAAY,SAASlQ,IAC3BsyB,EAAMviB,UAAY,GAAGkjB,EAAMjzB,IAASizB,EAAMT,aAAahf,WAEvDoN,EAAUxQ,YAAYkiB,GAEtB3iB,WAAW,KACP2iB,EAAMrkB,MAAMC,QAAU,IACtBokB,EAAMrkB,MAAMilB,UAAY,mBACxBZ,EAAMrkB,MAAMnO,WAAa,gBACzB6P,WAAW,IAAM2iB,EAAM5hB,SAAU,MAClC3Q,IAIPkX,OAAOwB,UAAYA,GAGnBxB,OAAOxM,EbkJU,CAACnB,EAAMqB,KACpB,MAAMC,EAAOD,EAAKE,MAAM,KACxB,IAAIC,EAAStK,EAAa8I,IAAS9I,EAAiB,GAEpD,IAAK,MAAMuK,KAAOH,EAAM,CACpB,IAAIE,GAA4B,iBAAXA,KAAuBC,KAAOD,GAI/C,OADAP,QAAQU,KAAK,0BAA0BN,mBAAsBrB,KACtDqB,EAHPG,EAASA,EAAOC,EAKxB,CAEA,OAAOD,Ga9JXmM,OAAO5N,WAAaA,EACpB4N,OAAO0b,iBAAmBA,GAG1B1b,OAAOkc,gBAAkB,EAGzB/nB,SAASsB,iBAAiB,mBAAoB,KAE1C2F,GAAIjI,OAGJ,EAAgBA,OA1KQ,MAExB,MAAMwO,EAAcxN,SAASwG,eAAe,gBAC5CgH,GAAalM,iBAAiB,QAAS,KACnC2F,GAAIG,MAAMyG,gBAId,MAAMma,EAAahoB,SAASwG,eAAe,eACrCyhB,EAAejoB,SAASwG,eAAe,iBAE7CwhB,GAAY1mB,iBAAiB,QAAUC,IACnCA,EAAE2mB,kBACFD,GAAc/mB,UAAUC,OAAO,YAInCnB,SAASQ,iBAAiB,gBAAgBC,QAAQW,IAC9CA,EAAIE,iBAAiB,QAAS,KAC1B,MAAMpD,EAAOkD,EAAIC,QAAQnD,KACzB+I,GAAIG,MAAMnI,YAAYf,GACtB+pB,GAAc/mB,UAAU+D,IAAI,UAC5BsiB,GAAiBrpB,GAEjBkM,GAAO4D,wBAKfhO,SAASQ,iBAAiB,uBAAuBC,QAAQW,IACrDA,EAAIE,iBAAiB,QAAS,KAC1B,MAAMpD,EAAOkD,EAAIC,QAAQnD,KACzB+I,GAAIG,MAAMnI,YAAYf,GACtBqpB,GAAiBrpB,GAEjBkM,GAAO4D,wBAKf,MAAMma,EAAgBnoB,SAASwG,eAAe,mBACxCuf,EAAa/lB,SAASwG,eAAe,eACrC4hB,EAAWpoB,SAASwG,eAAe,aACnC6hB,EAAYroB,SAASwG,eAAe,cAE1C2hB,GAAe7mB,iBAAiB,QAAS,KACrC,MAAMgnB,GAAUvC,GAAY7kB,UAAU+gB,SAAS,UAC/C8D,GAAY7kB,UAAUC,OAAO,SAAUmnB,GACvCF,GAAUlnB,UAAUC,OAAO,UAAWmnB,GACtCD,GAAWnnB,UAAUC,OAAO,SAAUmnB,KAI1CtoB,SAASQ,iBAAiB,oBAAoBC,QAAQolB,IAClDA,EAAKvkB,iBAAiB,QAAS,KAC3BykB,GAAY7kB,UAAU+D,IAAI,UAC1BmjB,GAAUlnB,UAAUoE,OAAO,UAC3B+iB,GAAWnnB,UAAU+D,IAAI,cAKjCjF,SAASsB,iBAAiB,QAAUC,IAC3BymB,GAAY/F,SAAS1gB,EAAElH,SAAY4tB,GAAchG,SAAS1gB,EAAElH,SAC7D4tB,GAAc/mB,UAAU+D,IAAI,YAKpC,MAAMsjB,EAActhB,GAAIG,MAAMC,SAAS,aAAe,KACtDkgB,GAAiBgB,IAuGjBC,GAGA3B,KAGA3kB,EAASE,GAAG,eAAgBulB,IAG5BzlB,EAASE,GAAG,cAAeykB,IAG3B3kB,EAASE,GAAG,kBAAoBlE,IAC5BqpB,GAAiBrpB,GAEjB,MAAMmnB,EAAejb,GAAOC,kBACxBgb,GACAjb,GAAO0R,SAASuJ,KAKxB,EAAgBzjB,UAAW1D,IACvB,MAAMmnB,EAAejb,GAAOC,kBACxBgb,GACAjb,GAAO0R,SAASuJ,KAKxBjb,GAAOpL,OAEPG,QAAQC,IAAI,8BAIhByM,OAAO4c,SAAW,CACdxhB,IAAG,GACHmD,OAAM,GACNiD,a","sources":["webpack://optimine-ui/./src/config.js","webpack://optimine-ui/./src/scripts/utils/translations.js","webpack://optimine-ui/./src/scripts/utils/LanguageManager.js","webpack://optimine-ui/./src/scripts/utils/index.js","webpack://optimine-ui/./src/scripts/pages/home/home-page.js","webpack://optimine-ui/./src/scripts/data/api.js","webpack://optimine-ui/./src/scripts/pages/about/about-page.js","webpack://optimine-ui/./src/scripts/pages/ai-tools/ai-tools-page.js","webpack://optimine-ui/./src/scripts/pages/planning/planning-page.js","webpack://optimine-ui/./src/scripts/pages/auth/auth-page.js","webpack://optimine-ui/./src/scripts/pages/auth/reset-password-page.js","webpack://optimine-ui/./src/scripts/pages/dashboard/dashboard-page.js","webpack://optimine-ui/./src/scripts/routes/routes.js","webpack://optimine-ui/./src/scripts/app.js","webpack://optimine-ui/./src/index.js"],"sourcesContent":["/**\r\n * OptiMine SPA Configuration\r\n */\r\n\r\nexport const Config = {\r\n    // App Info\r\n    appName: 'OptiMine',\r\n    version: '1.0.0',\r\n\r\n    // API Configuration\r\n    api: {\r\n        baseUrl: 'http://139.59.224.58:5000',\r\n        timeout: 10000\r\n    },\r\n\r\n    // Routes Configuration\r\n    routes: {\r\n        default: 'home',\r\n        protected: ['planning', 'ai-tools', 'dashboard', 'profile'],\r\n        public: ['home', 'auth']\r\n    },\r\n\r\n    // Transition Configuration\r\n    transition: {\r\n        duration: 400,\r\n        type: 'slide' // 'slide', 'fade', 'none'\r\n    },\r\n\r\n    // Storage Keys\r\n    storage: {\r\n        theme: 'optimine-theme',\r\n        language: 'optimine-language',\r\n        user: 'optimine-user',\r\n        token: 'optimine-token',\r\n        isLoggedIn: 'optimine-logged-in'\r\n    },\r\n\r\n    // Default Settings\r\n    defaults: {\r\n        theme: 'dark',\r\n        language: 'id'\r\n    }\r\n};\r\n","/**\r\n * OptiMine SPA - Translations / i18n\r\n * Dual Language Support: English (en) & Indonesian (id)\r\n */\r\n\r\nexport const translations = {\r\n    en: {\r\n        // Navbar\r\n        nav: {\r\n            home: 'Home',\r\n            planning: 'Planning',\r\n            aiTools: 'AI Tools',\r\n            dashboard: 'Dashboard',\r\n            login: 'Login',\r\n            profile: 'Profile',\r\n            logout: 'Sign Out'\r\n        },\r\n        \r\n        // Home Page\r\n        home: {\r\n            welcomeBack: 'Welcome Back',\r\n            subtitle: 'Mining Value Chain Optimization',\r\n            activeSites: 'Active Sites',\r\n            fleetUnits: 'Fleet Units',\r\n            efficiency: 'Efficiency',\r\n            quickAccess: 'QUICK ACCESS',\r\n            aiScenario: 'AI Scenario Simulator',\r\n            aiScenarioDesc: 'Simulate various operational scenarios and generate optimized production & distribution recommendations based on real-time field conditions.',\r\n            aiChatbot: 'AI Assistant Chatbot',\r\n            aiChatbotDesc: 'Interactive Q&A chatbot for field conditions, operational queries, and AI-powered recommendations with contextual responses.',\r\n            opsDashboard: 'Operations Dashboard',\r\n            opsDashboardDesc: 'Comprehensive data visualization with real-time monitoring, analytics, and justification for every AI recommendation.',\r\n            accessDashboard: 'Access Dashboard',\r\n            aiPoweredAnalysis: 'AI-Powered Analysis',\r\n            realtimeMonitoring: 'Real-time Monitoring',\r\n            riskMitigation: 'Risk Mitigation',\r\n            costOptimization: 'Cost Optimization'\r\n        },\r\n        \r\n        // Planning Page\r\n        planning: {\r\n            title: 'Production Planning',\r\n            subtitle: 'Input operational conditions to generate optimized plans',\r\n            weatherConditions: 'Weather Conditions',\r\n            rainfallLevel: 'Rainfall Level',\r\n            low: 'Low',\r\n            high: 'High',\r\n            waveHeight: 'Wave Height',\r\n            calm: 'Calm',\r\n            rough: 'Rough',\r\n            fleetStatus: 'Fleet Status',\r\n            activeVehicles: 'Active Vehicles',\r\n            maintenanceStatus: 'Maintenance Status',\r\n            fleetAvailability: 'Fleet Availability',\r\n            truckCount: 'Truck Count',\r\n            excavatorCount: 'Excavator Count',\r\n            shipSchedule: 'Ship Schedule',\r\n            vesselName: 'Vessel Name',\r\n            estimatedArrival: 'Estimated Arrival',\r\n            cargoCapacity: 'Cargo Capacity (tons)',\r\n            addVessel: 'Add Vessel',\r\n            generatePlan: 'Generate Optimization Plan',\r\n            systemStatus: 'System Status',\r\n            aiSystemOnline: 'AI System Online',\r\n            n8nReady: 'n8n Integration Ready',\r\n            activeAlerts: 'Active Alerts',\r\n            alertRainfall: 'High rainfall expected at Mine Site B',\r\n            alertMaintenance: '2 vehicles scheduled for maintenance',\r\n            weatherData: 'Weather Data',\r\n            connected: 'Connected',\r\n            fleetTracking: 'Fleet Tracking',\r\n            online: 'Online',\r\n            aiEngine: 'AI Engine',\r\n            ready: 'Ready',\r\n            lastUpdate: 'Last Updated',\r\n            justNow: 'Just now',\r\n            active: 'Active'\r\n        },\r\n        \r\n        // AI Tools Page\r\n        aiTools: {\r\n            title: 'AI Assistant',\r\n            subtitle: 'Ask questions about field conditions and get AI recommendations',\r\n            aiOnline: 'AI Online',\r\n            responseTime: 'Response time',\r\n            suggestedPrompts: 'Suggested Prompts',\r\n            prompt1: 'What is the impact of current rainfall on mining operations?',\r\n            prompt2: 'Recommend optimal fleet allocation for today',\r\n            prompt3: 'Analyze shipping delays due to high waves',\r\n            integration: 'Integration',\r\n            integrationDesc: 'Ready for n8n workflow integration and Lovable AI connection',\r\n            connectedSystems: 'Connected Systems',\r\n            weather: 'Weather',\r\n            fleet: 'Fleet',\r\n            shipping: 'Shipping',\r\n            placeholder: 'Ask about weather impact, fleet optimization, or production planning...',\r\n            greeting: \"Hello! I'm your AI Mining Operations Assistant. How can I help you optimize your operations today?\"\r\n        },\r\n        \r\n        // Dashboard Page\r\n        dashboard: {\r\n            title: 'Operations Dashboard',\r\n            subtitle: 'Real-time monitoring and analytics',\r\n            totalProduction: 'Total Production',\r\n            fromLastMonth: 'from last month',\r\n            activeEquipment: 'Active Equipment',\r\n            outOfTotal: 'out of 48 total units',\r\n            efficiencyRate: 'Efficiency Rate',\r\n            target: 'Target',\r\n            costSavings: 'Cost Savings',\r\n            thisQuarter: 'This quarter',\r\n            productionTrends: 'Production Trends',\r\n            equipmentStatus: 'Equipment Status',\r\n            chartPlaceholder: 'Chart visualization here',\r\n            statusPlaceholder: 'Status overview here'\r\n        },\r\n        \r\n        // Auth Page\r\n        auth: {\r\n            login: 'Login',\r\n            register: 'Register',\r\n            email: 'Email',\r\n            password: 'Password',\r\n            confirmPassword: 'Confirm Password',\r\n            fullName: 'Full Name',\r\n            role: 'Role',\r\n            forgotPassword: 'Forgot Password?',\r\n            signIn: 'Sign In',\r\n            createAccount: 'Create Account',\r\n            resetPassword: 'Reset Password',\r\n            resetDesc: \"Enter your email address and we'll send you a link to reset your password.\",\r\n            sendResetLink: 'Send Reset Link',\r\n            backToLogin: 'Back to Login',\r\n            miningPlanner: 'Mining Planner',\r\n            shippingPlanner: 'Shipping Planner',\r\n            // Password strength\r\n            passwordRequirements: 'Password Requirements:',\r\n            minLength: 'Minimum 6 characters',\r\n            uppercase: 'Uppercase letter (A-Z)',\r\n            number: 'Number (0-9)',\r\n            weak: 'Weak',\r\n            medium: 'Medium',\r\n            fair: 'Fair',\r\n            strong: 'Strong',\r\n            passwordError: 'Password must be at least 6 characters, contain uppercase letter and number!',\r\n            passwordMismatch: 'Passwords do not match!'\r\n        },\r\n        \r\n        // Profile Page\r\n        profile: {\r\n            title: 'Profile Settings',\r\n            subtitle: 'Manage your account preferences',\r\n            accountInfo: 'Account Information',\r\n            displayName: 'Display Name',\r\n            email: 'Email',\r\n            preferences: 'Preferences',\r\n            darkMode: 'Dark Mode',\r\n            useDarkTheme: 'Use dark theme',\r\n            language: 'Language',\r\n            selectLanguage: 'Select your language',\r\n            signOut: 'Sign Out',\r\n            theme: 'Theme',\r\n            dark: 'Dark',\r\n            light: 'Light'\r\n        },\r\n        \r\n        // Common\r\n        common: {\r\n            loading: 'Loading...',\r\n            error: 'Error',\r\n            success: 'Success',\r\n            save: 'Save',\r\n            cancel: 'Cancel',\r\n            confirm: 'Confirm',\r\n            delete: 'Delete',\r\n            edit: 'Edit',\r\n            view: 'View',\r\n            search: 'Search',\r\n            noData: 'No data available',\r\n            languageChanged: 'Language changed to English',\r\n            copyright: ' 2025 OptiMine. All rights reserved.',\r\n            privacy: 'Privacy',\r\n            terms: 'Terms',\r\n            contact: 'Contact'\r\n        }\r\n    },\r\n    \r\n    id: {\r\n        // Navbar\r\n        nav: {\r\n            home: 'Beranda',\r\n            planning: 'Perencanaan',\r\n            aiTools: 'AI Tools',\r\n            dashboard: 'Dashboard',\r\n            login: 'Masuk',\r\n            profile: 'Profil',\r\n            logout: 'Keluar'\r\n        },\r\n        \r\n        // Home Page\r\n        home: {\r\n            welcomeBack: 'Selamat Datang',\r\n            subtitle: 'Optimasi Rantai Nilai Pertambangan',\r\n            activeSites: 'Lokasi Aktif',\r\n            fleetUnits: 'Unit Armada',\r\n            efficiency: 'Efisiensi',\r\n            quickAccess: 'AKSES CEPAT',\r\n            aiScenario: 'Simulator Skenario AI',\r\n            aiScenarioDesc: 'Simulasikan berbagai skenario operasional dan hasilkan rekomendasi produksi & distribusi yang dioptimalkan berdasarkan kondisi lapangan real-time.',\r\n            aiChatbot: 'Chatbot Asisten AI',\r\n            aiChatbotDesc: 'Chatbot Q&A interaktif untuk kondisi lapangan, pertanyaan operasional, dan rekomendasi bertenaga AI dengan respons kontekstual.',\r\n            opsDashboard: 'Dashboard Operasi',\r\n            opsDashboardDesc: 'Visualisasi data komprehensif dengan pemantauan real-time, analitik, dan justifikasi untuk setiap rekomendasi AI.',\r\n            accessDashboard: 'Akses Dashboard',\r\n            aiPoweredAnalysis: 'Analisis Bertenaga AI',\r\n            realtimeMonitoring: 'Pemantauan Real-time',\r\n            riskMitigation: 'Mitigasi Risiko',\r\n            costOptimization: 'Optimasi Biaya'\r\n        },\r\n        \r\n        // Planning Page\r\n        planning: {\r\n            title: 'Perencanaan Produksi',\r\n            subtitle: 'Masukkan kondisi operasional untuk menghasilkan rencana yang dioptimalkan',\r\n            weatherConditions: 'Kondisi Cuaca',\r\n            rainfallLevel: 'Tingkat Curah Hujan',\r\n            low: 'Rendah',\r\n            high: 'Tinggi',\r\n            waveHeight: 'Tinggi Gelombang',\r\n            calm: 'Tenang',\r\n            rough: 'Bergelombang',\r\n            fleetStatus: 'Status Armada',\r\n            activeVehicles: 'Kendaraan Aktif',\r\n            maintenanceStatus: 'Status Perawatan',\r\n            fleetAvailability: 'Ketersediaan Armada',\r\n            truckCount: 'Jumlah Truk',\r\n            excavatorCount: 'Jumlah Excavator',\r\n            shipSchedule: 'Jadwal Kapal',\r\n            vesselName: 'Nama Kapal',\r\n            estimatedArrival: 'Perkiraan Kedatangan',\r\n            cargoCapacity: 'Kapasitas Kargo (ton)',\r\n            addVessel: 'Tambah Kapal',\r\n            generatePlan: 'Hasilkan Rencana Optimal',\r\n            systemStatus: 'Status Sistem',\r\n            aiSystemOnline: 'Sistem AI Online',\r\n            n8nReady: 'Integrasi n8n Siap',\r\n            activeAlerts: 'Peringatan Aktif',\r\n            alertRainfall: 'Curah hujan tinggi diperkirakan di Lokasi Tambang B',\r\n            alertMaintenance: '2 kendaraan dijadwalkan untuk perawatan',\r\n            weatherData: 'Data Cuaca',\r\n            connected: 'Terhubung',\r\n            fleetTracking: 'Pelacakan Armada',\r\n            online: 'Online',\r\n            aiEngine: 'Mesin AI',\r\n            ready: 'Siap',\r\n            lastUpdate: 'Terakhir Diperbarui',\r\n            justNow: 'Baru saja',\r\n            active: 'Aktif'\r\n        },\r\n        \r\n        // AI Tools Page\r\n        aiTools: {\r\n            title: 'Asisten AI',\r\n            subtitle: 'Ajukan pertanyaan tentang kondisi lapangan dan dapatkan rekomendasi AI',\r\n            aiOnline: 'AI Online',\r\n            responseTime: 'Waktu respons',\r\n            suggestedPrompts: 'Prompt Disarankan',\r\n            prompt1: 'Apa dampak curah hujan saat ini terhadap operasi tambang?',\r\n            prompt2: 'Rekomendasikan alokasi armada optimal untuk hari ini',\r\n            prompt3: 'Analisis keterlambatan pengiriman akibat gelombang tinggi',\r\n            integration: 'Integrasi',\r\n            integrationDesc: 'Siap untuk integrasi alur kerja n8n dan koneksi Lovable AI',\r\n            connectedSystems: 'Sistem Terhubung',\r\n            weather: 'Cuaca',\r\n            fleet: 'Armada',\r\n            shipping: 'Pengiriman',\r\n            placeholder: 'Tanyakan tentang dampak cuaca, optimasi armada, atau perencanaan produksi...',\r\n            greeting: 'Halo! Saya Asisten AI Operasi Tambang Anda. Bagaimana saya bisa membantu mengoptimalkan operasi Anda hari ini?'\r\n        },\r\n        \r\n        // Dashboard Page\r\n        dashboard: {\r\n            title: 'Dashboard Operasi',\r\n            subtitle: 'Pemantauan dan analitik real-time',\r\n            totalProduction: 'Total Produksi',\r\n            fromLastMonth: 'dari bulan lalu',\r\n            activeEquipment: 'Peralatan Aktif',\r\n            outOfTotal: 'dari 48 unit total',\r\n            efficiencyRate: 'Tingkat Efisiensi',\r\n            target: 'Target',\r\n            costSavings: 'Penghematan Biaya',\r\n            thisQuarter: 'Kuartal ini',\r\n            productionTrends: 'Tren Produksi',\r\n            equipmentStatus: 'Status Peralatan',\r\n            chartPlaceholder: 'Visualisasi grafik di sini',\r\n            statusPlaceholder: 'Ringkasan status di sini'\r\n        },\r\n        \r\n        // Auth Page\r\n        auth: {\r\n            login: 'Masuk',\r\n            register: 'Daftar',\r\n            email: 'Email',\r\n            password: 'Kata Sandi',\r\n            confirmPassword: 'Konfirmasi Kata Sandi',\r\n            fullName: 'Nama Lengkap',\r\n            role: 'Peran',\r\n            forgotPassword: 'Lupa Kata Sandi?',\r\n            signIn: 'Masuk',\r\n            createAccount: 'Buat Akun',\r\n            resetPassword: 'Reset Kata Sandi',\r\n            resetDesc: 'Masukkan alamat email Anda dan kami akan mengirimkan link untuk mereset kata sandi.',\r\n            sendResetLink: 'Kirim Link Reset',\r\n            backToLogin: 'Kembali ke Login',\r\n            miningPlanner: 'Perencana Tambang',\r\n            shippingPlanner: 'Perencana Pengiriman',\r\n            // Password strength\r\n            passwordRequirements: 'Persyaratan Password:',\r\n            minLength: 'Minimal 6 karakter',\r\n            uppercase: 'Huruf kapital (A-Z)',\r\n            number: 'Angka (0-9)',\r\n            weak: 'Lemah',\r\n            medium: 'Sedang',\r\n            fair: 'Cukup Kuat',\r\n            strong: 'Kuat',\r\n            passwordError: 'Password harus minimal 6 karakter, mengandung huruf kapital dan angka!',\r\n            passwordMismatch: 'Password tidak cocok!'\r\n        },\r\n        \r\n        // Profile Page\r\n        profile: {\r\n            title: 'Pengaturan Profil',\r\n            subtitle: 'Kelola preferensi akun Anda',\r\n            accountInfo: 'Informasi Akun',\r\n            displayName: 'Nama Tampilan',\r\n            email: 'Email',\r\n            preferences: 'Preferensi',\r\n            darkMode: 'Mode Gelap',\r\n            useDarkTheme: 'Gunakan tema gelap',\r\n            language: 'Bahasa',\r\n            selectLanguage: 'Pilih bahasa Anda',\r\n            signOut: 'Keluar',\r\n            theme: 'Tema',\r\n            dark: 'Gelap',\r\n            light: 'Terang'\r\n        },\r\n        \r\n        // Common\r\n        common: {\r\n            loading: 'Memuat...',\r\n            error: 'Kesalahan',\r\n            success: 'Berhasil',\r\n            save: 'Simpan',\r\n            cancel: 'Batal',\r\n            confirm: 'Konfirmasi',\r\n            delete: 'Hapus',\r\n            edit: 'Edit',\r\n            view: 'Lihat',\r\n            search: 'Cari',\r\n            noData: 'Tidak ada data',\r\n            languageChanged: 'Bahasa diubah ke Indonesia',\r\n            copyright: ' 2025 OptiMine. Hak cipta dilindungi.',\r\n            privacy: 'Privasi',\r\n            terms: 'Ketentuan',\r\n            contact: 'Kontak'\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Get translation by key path\r\n * @param {string} lang - Language code ('en' or 'id')\r\n * @param {string} path - Dot notation path (e.g., 'nav.home', 'home.welcomeBack')\r\n * @returns {string} - Translated string or key if not found\r\n */\r\nexport const t = (lang, path) => {\r\n    const keys = path.split('.');\r\n    let result = translations[lang] || translations['en'];\r\n    \r\n    for (const key of keys) {\r\n        if (result && typeof result === 'object' && key in result) {\r\n            result = result[key];\r\n        } else {\r\n            console.warn(`Translation not found: ${path} for language: ${lang}`);\r\n            return path; // Return the key if translation not found\r\n        }\r\n    }\r\n    \r\n    return result;\r\n};\r\n\r\n/**\r\n * Get all translations for a section\r\n * @param {string} lang - Language code\r\n * @param {string} section - Section name (e.g., 'nav', 'home')\r\n * @returns {object} - All translations for that section\r\n */\r\nexport const getSection = (lang, section) => {\r\n    return translations[lang]?.[section] || translations['en']?.[section] || {};\r\n};\r\n\r\nexport default translations;\r\n","/**\r\n * LanguageManager - Handles multi-language functionality\r\n * Uses localStorage for persistence\r\n * Supports dynamic DOM updates via data-i18n attributes\r\n */\r\n\r\nimport { translations } from './translations.js';\r\n\r\nclass LanguageManager {\r\n    constructor() {\r\n        this.currentLanguage = this.getSavedLanguage();\r\n        this.listeners = [];\r\n        this.isInitialized = false;\r\n    }\r\n\r\n    /**\r\n     * Get saved language from localStorage or default to 'id'\r\n     */\r\n    getSavedLanguage() {\r\n        const saved = localStorage.getItem('optimine-language');\r\n        if (saved && (saved === 'en' || saved === 'id')) {\r\n            return saved;\r\n        }\r\n        // Detect browser language\r\n        const browserLang = navigator.language.toLowerCase();\r\n        if (browserLang.startsWith('id')) {\r\n            return 'id';\r\n        }\r\n        return 'id'; // Default to Indonesian\r\n    }\r\n\r\n    /**\r\n     * Initialize language manager\r\n     */\r\n    init() {\r\n        if (this.isInitialized) return this;\r\n        \r\n        this.setLanguage(this.currentLanguage, false); // Don't notify on init\r\n        this.setupLanguageSwitcher();\r\n        this.isInitialized = true;\r\n        \r\n        console.log('LanguageManager initialized. Current language:', this.currentLanguage);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Get current translations object\r\n     */\r\n    get t() {\r\n        return translations[this.currentLanguage] || translations['id'];\r\n    }\r\n\r\n    /**\r\n     * Get specific translation by dot notation path\r\n     * @param {string} path - e.g., 'nav.home', 'features.simulator.title'\r\n     * @returns {string} Translation or path if not found\r\n     */\r\n    translate(path) {\r\n        const keys = path.split('.');\r\n        let result = this.t;\r\n        \r\n        for (const key of keys) {\r\n            if (result && result[key] !== undefined) {\r\n                result = result[key];\r\n            } else {\r\n                console.warn(`Translation not found: ${path}`);\r\n                return path;\r\n            }\r\n        }\r\n        \r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Set language and update all elements\r\n     * @param {string} lang - 'en' or 'id'\r\n     * @param {boolean} notify - Whether to notify listeners (default: true)\r\n     */\r\n    setLanguage(lang, notify = true) {\r\n        if (lang !== 'en' && lang !== 'id') {\r\n            console.error('Invalid language:', lang);\r\n            return;\r\n        }\r\n\r\n        this.currentLanguage = lang;\r\n        localStorage.setItem('optimine-language', lang);\r\n        \r\n        // Update document language attribute\r\n        document.documentElement.setAttribute('lang', lang);\r\n        \r\n        // Update all elements with data-i18n attribute\r\n        this.updateAllTranslations();\r\n        \r\n        // Update language indicator\r\n        this.updateLanguageIndicator();\r\n        \r\n        // Notify listeners\r\n        if (notify) {\r\n            this.notifyListeners();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Toggle between languages\r\n     */\r\n    toggleLanguage() {\r\n        const newLang = this.currentLanguage === 'en' ? 'id' : 'en';\r\n        this.setLanguage(newLang);\r\n        return newLang;\r\n    }\r\n\r\n    /**\r\n     * Update all DOM elements with data-i18n attribute\r\n     */\r\n    updateAllTranslations() {\r\n        // Elements with text content\r\n        const textElements = document.querySelectorAll('[data-i18n]');\r\n        textElements.forEach(element => {\r\n            const key = element.getAttribute('data-i18n');\r\n            const translation = this.translate(key);\r\n            if (translation !== key) {\r\n                element.textContent = translation;\r\n            }\r\n        });\r\n\r\n        // Elements with placeholder\r\n        const placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');\r\n        placeholderElements.forEach(element => {\r\n            const key = element.getAttribute('data-i18n-placeholder');\r\n            const translation = this.translate(key);\r\n            if (translation !== key) {\r\n                element.setAttribute('placeholder', translation);\r\n            }\r\n        });\r\n\r\n        // Elements with title attribute\r\n        const titleElements = document.querySelectorAll('[data-i18n-title]');\r\n        titleElements.forEach(element => {\r\n            const key = element.getAttribute('data-i18n-title');\r\n            const translation = this.translate(key);\r\n            if (translation !== key) {\r\n                element.setAttribute('title', translation);\r\n            }\r\n        });\r\n\r\n        // Elements with aria-label\r\n        const ariaElements = document.querySelectorAll('[data-i18n-aria]');\r\n        ariaElements.forEach(element => {\r\n            const key = element.getAttribute('data-i18n-aria');\r\n            const translation = this.translate(key);\r\n            if (translation !== key) {\r\n                element.setAttribute('aria-label', translation);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update language indicator in UI\r\n     */\r\n    updateLanguageIndicator() {\r\n        // Update text indicators\r\n        const indicators = document.querySelectorAll('[data-language-indicator]');\r\n        indicators.forEach(indicator => {\r\n            indicator.textContent = this.currentLanguage.toUpperCase();\r\n        });\r\n\r\n        // Update active state on language buttons\r\n        const langButtons = document.querySelectorAll('[data-lang-button]');\r\n        langButtons.forEach(button => {\r\n            const lang = button.getAttribute('data-lang-button');\r\n            const isActive = lang === this.currentLanguage;\r\n            \r\n            // Toggle classes\r\n            button.classList.toggle('bg-primary', isActive);\r\n            button.classList.toggle('text-primary-foreground', isActive);\r\n            button.classList.toggle('shadow-lg', isActive);\r\n        });\r\n        \r\n        // Update .lang-option buttons (legacy support)\r\n        document.querySelectorAll('.lang-option').forEach(btn => {\r\n            const lang = btn.dataset.lang;\r\n            const isActive = lang === this.currentLanguage;\r\n            \r\n            btn.classList.toggle('bg-primary', isActive);\r\n            btn.classList.toggle('text-primary-foreground', isActive);\r\n            btn.classList.toggle('shadow-lg', isActive);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Setup language switcher click handlers\r\n     */\r\n    setupLanguageSwitcher() {\r\n        // Use event delegation for language buttons\r\n        document.addEventListener('click', (e) => {\r\n            // Language toggle button (toggles between en/id)\r\n            const toggleBtn = e.target.closest('[data-language-toggle]');\r\n            if (toggleBtn) {\r\n                e.preventDefault();\r\n                this.toggleLanguage();\r\n                return;\r\n            }\r\n\r\n            // Specific language button with data-lang-button\r\n            const langBtn = e.target.closest('[data-lang-button]');\r\n            if (langBtn) {\r\n                e.preventDefault();\r\n                const lang = langBtn.getAttribute('data-lang-button');\r\n                this.setLanguage(lang);\r\n                return;\r\n            }\r\n            \r\n            // Legacy .lang-option buttons\r\n            const langOption = e.target.closest('.lang-option');\r\n            if (langOption) {\r\n                e.preventDefault();\r\n                const lang = langOption.dataset.lang;\r\n                if (lang) {\r\n                    this.setLanguage(lang);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Subscribe to language changes\r\n     * @param {Function} callback - Called when language changes with (lang, translations)\r\n     * @returns {Function} Unsubscribe function\r\n     */\r\n    subscribe(callback) {\r\n        this.listeners.push(callback);\r\n        return () => {\r\n            this.listeners = this.listeners.filter(cb => cb !== callback);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Notify all subscribers of language change\r\n     */\r\n    notifyListeners() {\r\n        this.listeners.forEach(callback => {\r\n            try {\r\n                callback(this.currentLanguage, this.t);\r\n            } catch (error) {\r\n                console.error('Language listener error:', error);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get translation for use in templates\r\n     * Shorthand for translate()\r\n     */\r\n    $(path) {\r\n        return this.translate(path);\r\n    }\r\n}\r\n\r\n// Singleton instance\r\nconst languageManager = new LanguageManager();\r\n\r\nexport { languageManager, LanguageManager };\r\nexport default languageManager;\r\n","/**\r\n * OptiMine SPA - Utilities\r\n * Common utility functions\r\n */\r\n\r\n// ============================================\r\n// EVENT BUS - Pub/Sub Pattern\r\n// ============================================\r\nexport const EventBus = {\r\n    events: {},\r\n\r\n    on(event, callback) {\r\n        if (!this.events[event]) {\r\n            this.events[event] = [];\r\n        }\r\n        this.events[event].push(callback);\r\n        return () => this.off(event, callback);\r\n    },\r\n\r\n    off(event, callback) {\r\n        if (!this.events[event]) return;\r\n        this.events[event] = this.events[event].filter(cb => cb !== callback);\r\n    },\r\n\r\n    emit(event, data) {\r\n        if (!this.events[event]) return;\r\n        this.events[event].forEach(callback => callback(data));\r\n    },\r\n\r\n    once(event, callback) {\r\n        const wrapper = (data) => {\r\n            callback(data);\r\n            this.off(event, wrapper);\r\n        };\r\n        this.on(event, wrapper);\r\n    }\r\n};\r\n\r\n// ============================================\r\n// DOM HELPERS\r\n// ============================================\r\nexport const $ = (selector) => document.querySelector(selector);\r\nexport const $$ = (selector) => document.querySelectorAll(selector);\r\n\r\nexport const createElement = (tag, attributes = {}, children = []) => {\r\n    const element = document.createElement(tag);\r\n    \r\n    Object.entries(attributes).forEach(([key, value]) => {\r\n        if (key === 'className') {\r\n            element.className = value;\r\n        } else if (key === 'innerHTML') {\r\n            element.innerHTML = value;\r\n        } else if (key.startsWith('on')) {\r\n            element.addEventListener(key.slice(2).toLowerCase(), value);\r\n        } else {\r\n            element.setAttribute(key, value);\r\n        }\r\n    });\r\n    \r\n    children.forEach(child => {\r\n        if (typeof child === 'string') {\r\n            element.appendChild(document.createTextNode(child));\r\n        } else {\r\n            element.appendChild(child);\r\n        }\r\n    });\r\n    \r\n    return element;\r\n};\r\n\r\n// ============================================\r\n// STORAGE HELPERS\r\n// ============================================\r\nexport const Storage = {\r\n    get(key, defaultValue = null) {\r\n        try {\r\n            const value = localStorage.getItem(key);\r\n            return value ? JSON.parse(value) : defaultValue;\r\n        } catch {\r\n            return localStorage.getItem(key) || defaultValue;\r\n        }\r\n    },\r\n\r\n    set(key, value) {\r\n        try {\r\n            localStorage.setItem(key, typeof value === 'string' ? value : JSON.stringify(value));\r\n        } catch (e) {\r\n            console.error('Storage error:', e);\r\n        }\r\n    },\r\n\r\n    remove(key) {\r\n        localStorage.removeItem(key);\r\n    },\r\n\r\n    clear() {\r\n        localStorage.clear();\r\n    }\r\n};\r\n\r\n// ============================================\r\n// DEBOUNCE & THROTTLE\r\n// ============================================\r\nexport const debounce = (func, wait) => {\r\n    let timeout;\r\n    return function executedFunction(...args) {\r\n        const later = () => {\r\n            clearTimeout(timeout);\r\n            func(...args);\r\n        };\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n    };\r\n};\r\n\r\nexport const throttle = (func, limit) => {\r\n    let inThrottle;\r\n    return function executedFunction(...args) {\r\n        if (!inThrottle) {\r\n            func(...args);\r\n            inThrottle = true;\r\n            setTimeout(() => inThrottle = false, limit);\r\n        }\r\n    };\r\n};\r\n\r\n// ============================================\r\n// FORMAT HELPERS\r\n// ============================================\r\nexport const formatNumber = (num) => {\r\n    return new Intl.NumberFormat('id-ID').format(num);\r\n};\r\n\r\nexport const formatCurrency = (num, currency = 'IDR') => {\r\n    return new Intl.NumberFormat('id-ID', {\r\n        style: 'currency',\r\n        currency: currency\r\n    }).format(num);\r\n};\r\n\r\nexport const formatDate = (date, options = {}) => {\r\n    return new Intl.DateTimeFormat('id-ID', options).format(new Date(date));\r\n};\r\n\r\n// ============================================\r\n// ANIMATION HELPERS\r\n// ============================================\r\nexport const animate = {\r\n    fadeIn(element, duration = 300) {\r\n        element.style.opacity = '0';\r\n        element.style.display = 'block';\r\n        \r\n        let start = null;\r\n        const step = (timestamp) => {\r\n            if (!start) start = timestamp;\r\n            const progress = Math.min((timestamp - start) / duration, 1);\r\n            element.style.opacity = progress;\r\n            if (progress < 1) {\r\n                requestAnimationFrame(step);\r\n            }\r\n        };\r\n        requestAnimationFrame(step);\r\n    },\r\n\r\n    fadeOut(element, duration = 300) {\r\n        let start = null;\r\n        const step = (timestamp) => {\r\n            if (!start) start = timestamp;\r\n            const progress = Math.min((timestamp - start) / duration, 1);\r\n            element.style.opacity = 1 - progress;\r\n            if (progress < 1) {\r\n                requestAnimationFrame(step);\r\n            } else {\r\n                element.style.display = 'none';\r\n            }\r\n        };\r\n        requestAnimationFrame(step);\r\n    },\r\n\r\n    slideDown(element, duration = 300) {\r\n        element.style.height = '0px';\r\n        element.style.overflow = 'hidden';\r\n        element.style.display = 'block';\r\n        \r\n        const targetHeight = element.scrollHeight;\r\n        let start = null;\r\n        \r\n        const step = (timestamp) => {\r\n            if (!start) start = timestamp;\r\n            const progress = Math.min((timestamp - start) / duration, 1);\r\n            element.style.height = `${targetHeight * progress}px`;\r\n            if (progress < 1) {\r\n                requestAnimationFrame(step);\r\n            } else {\r\n                element.style.height = '';\r\n                element.style.overflow = '';\r\n            }\r\n        };\r\n        requestAnimationFrame(step);\r\n    },\r\n\r\n    slideUp(element, duration = 300) {\r\n        const startHeight = element.scrollHeight;\r\n        element.style.height = `${startHeight}px`;\r\n        element.style.overflow = 'hidden';\r\n        \r\n        let start = null;\r\n        \r\n        const step = (timestamp) => {\r\n            if (!start) start = timestamp;\r\n            const progress = Math.min((timestamp - start) / duration, 1);\r\n            element.style.height = `${startHeight * (1 - progress)}px`;\r\n            if (progress < 1) {\r\n                requestAnimationFrame(step);\r\n            } else {\r\n                element.style.display = 'none';\r\n                element.style.height = '';\r\n                element.style.overflow = '';\r\n            }\r\n        };\r\n        requestAnimationFrame(step);\r\n    },\r\n\r\n    // Typewriter Effect\r\n    typewriter(element, text, speed = 100, callback = null) {\r\n        element.textContent = '';\r\n        element.style.borderRight = '2px solid currentColor';\r\n        element.style.animation = 'blink-caret 0.75s step-end infinite';\r\n        \r\n        let index = 0;\r\n        \r\n        const type = () => {\r\n            if (index < text.length) {\r\n                element.textContent += text.charAt(index);\r\n                index++;\r\n                setTimeout(type, speed);\r\n            } else {\r\n                setTimeout(() => {\r\n                    element.style.borderRight = 'none';\r\n                    element.style.animation = 'none';\r\n                    if (callback) callback();\r\n                }, 500);\r\n            }\r\n        };\r\n        \r\n        type();\r\n    },\r\n\r\n    // Typewriter with welcome message and username\r\n    typewriterWelcome(element, welcomeText, userName, speed = 80) {\r\n        element.innerHTML = '';\r\n        \r\n        const welcomeSpan = document.createElement('span');\r\n        welcomeSpan.className = 'typewriter-welcome';\r\n        \r\n        const userSpan = document.createElement('span');\r\n        userSpan.className = 'typewriter-username text-primary';\r\n        \r\n        element.appendChild(welcomeSpan);\r\n        element.appendChild(userSpan);\r\n        \r\n        element.classList.add('typewriter-active');\r\n        \r\n        let welcomeIndex = 0;\r\n        let userIndex = 0;\r\n        \r\n        const typeWelcome = () => {\r\n            if (welcomeIndex < welcomeText.length) {\r\n                welcomeSpan.textContent += welcomeText.charAt(welcomeIndex);\r\n                welcomeIndex++;\r\n                setTimeout(typeWelcome, speed);\r\n            } else {\r\n                setTimeout(typeUser, 200);\r\n            }\r\n        };\r\n        \r\n        const typeUser = () => {\r\n            if (userIndex < userName.length) {\r\n                userSpan.textContent += userName.charAt(userIndex);\r\n                userIndex++;\r\n                setTimeout(typeUser, speed);\r\n            } else {\r\n                setTimeout(() => {\r\n                    element.classList.remove('typewriter-active');\r\n                    element.classList.add('typewriter-complete');\r\n                }, 500);\r\n            }\r\n        };\r\n        \r\n        setTimeout(typeWelcome, 300);\r\n    },\r\n\r\n    // Counter Animation - Count up from 0 to target number\r\n    countUp(element, target, duration = 2000, suffix = '') {\r\n        const startTime = performance.now();\r\n        const startValue = 0;\r\n        \r\n        // Easing function for smooth animation\r\n        const easeOutQuart = (t) => 1 - Math.pow(1 - t, 4);\r\n        \r\n        const updateCount = (currentTime) => {\r\n            const elapsed = currentTime - startTime;\r\n            const progress = Math.min(elapsed / duration, 1);\r\n            const easedProgress = easeOutQuart(progress);\r\n            \r\n            const currentValue = Math.floor(startValue + (target - startValue) * easedProgress);\r\n            element.textContent = currentValue + suffix;\r\n            \r\n            if (progress < 1) {\r\n                requestAnimationFrame(updateCount);\r\n            } else {\r\n                element.textContent = target + suffix;\r\n                element.classList.add('complete');\r\n            }\r\n        };\r\n        \r\n        requestAnimationFrame(updateCount);\r\n    },\r\n\r\n    // Initialize all stat counters on page\r\n    initStatCounters(delay = 800) {\r\n        setTimeout(() => {\r\n            const statElements = document.querySelectorAll('.stat-value[data-target]');\r\n            \r\n            statElements.forEach((element, index) => {\r\n                const target = parseInt(element.getAttribute('data-target')) || 0;\r\n                const suffix = element.getAttribute('data-suffix') || '';\r\n                const duration = parseInt(element.getAttribute('data-duration')) || 2000;\r\n                \r\n                // Set initial value to 0\r\n                element.textContent = '0' + suffix;\r\n                \r\n                // Stagger animation for each stat\r\n                setTimeout(() => {\r\n                    animate.countUp(element, target, duration, suffix);\r\n                }, index * 200);\r\n            });\r\n        }, delay);\r\n    }\r\n};\r\n\r\n// ============================================\r\n// DELAY HELPER\r\n// ============================================\r\nexport const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\n// ============================================\r\n// LANGUAGE MANAGER\r\n// ============================================\r\nexport { default as LanguageManager } from './LanguageManager.js';\r\n","/**\r\n * OptiMine SPA - Home Page\r\n */\r\n\r\nimport { App } from '../../app.js';\r\nimport { t, getSection } from '../../utils/translations.js';\r\nimport { animate } from '../../utils/index.js';\r\n\r\n/**\r\n * Get user name from localStorage\r\n * @returns {string} User name or empty string\r\n */\r\nconst getUserName = () => {\r\n    try {\r\n        const userData = localStorage.getItem('optimine-user');\r\n        if (userData) {\r\n            const user = JSON.parse(userData);\r\n            return user.name || user.nama || '';\r\n        }\r\n    } catch (e) {\r\n        console.error('Error parsing user data:', e);\r\n    }\r\n    return '';\r\n};\r\n\r\n/**\r\n * Check if user is logged in\r\n */\r\nconst isLoggedIn = () => {\r\n    return localStorage.getItem('optimine-logged-in') === 'true';\r\n};\r\n\r\n/**\r\n * Initialize typewriter effect for welcome message\r\n */\r\nconst initTypewriter = () => {\r\n    const welcomeElement = document.getElementById('welcome-title');\r\n    if (!welcomeElement) return;\r\n    \r\n    const userName = getUserName();\r\n    \r\n    if (isLoggedIn() && userName) {\r\n        animate.typewriterWelcome(welcomeElement, 'Welcome Back, ', userName, 70);\r\n    } else {\r\n        animate.typewriterWelcome(welcomeElement, 'Welcome to ', 'OptiMine', 70);\r\n    }\r\n};\r\n\r\nconst template = () => {\r\n    const lang = App.Model.getState('language') || 'id';\r\n    const home = getSection(lang, 'home');\r\n    \r\n    return `\r\n<div class=\"min-h-[calc(100vh-4rem)] pt-6\">\r\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        \r\n        <!-- ========================================\r\n             WELCOME SECTION\r\n        ======================================== -->\r\n        <section class=\"mb-8 animate-fade-in stagger-1\">\r\n            <div class=\"glass border border-border rounded-2xl p-6 md:p-8 border-glow\">\r\n                <div class=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6\">\r\n                    <!-- Left: Title & Subtitle -->\r\n                    <div>\r\n                        <h1 id=\"welcome-title\" class=\"font-heading text-2xl md:text-3xl font-bold text-foreground mb-2 welcome-typewriter\">\r\n                            <!-- Typewriter effect will be inserted here -->\r\n                        </h1>\r\n                        <p class=\"text-muted-foreground\">\r\n                            ${home.subtitle}\r\n                        </p>\r\n                    </div>\r\n                    \r\n                    <!-- Right: Stats Cards -->\r\n                    <div class=\"flex flex-wrap gap-3 lg:gap-4\">\r\n                        <!-- Active Sites -->\r\n                        <div class=\"stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]\">\r\n                            <p class=\"stat-value text-2xl lg:text-3xl font-bold text-primary\" data-target=\"24\" data-suffix=\"\" data-duration=\"2000\">0</p>\r\n                            <p class=\"text-xs text-muted-foreground uppercase tracking-wide\">${home.activeSites}</p>\r\n                        </div>\r\n                        <!-- Fleet Units -->\r\n                        <div class=\"stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]\">\r\n                            <p class=\"stat-value text-2xl lg:text-3xl font-bold text-emerald-400\" data-target=\"156\" data-suffix=\"\" data-duration=\"2000\">0</p>\r\n                            <p class=\"text-xs text-muted-foreground uppercase tracking-wide\">${home.fleetUnits}</p>\r\n                        </div>\r\n                        <!-- Efficiency -->\r\n                        <div class=\"stat-card rounded-xl bg-secondary/50 border border-border px-5 py-3 text-center min-w-[100px]\">\r\n                            <p class=\"stat-value text-2xl lg:text-3xl font-bold text-orange-400\" data-target=\"98\" data-suffix=\"%\" data-duration=\"2000\">0%</p>\r\n                            <p class=\"text-xs text-muted-foreground uppercase tracking-wide\">${home.efficiency}</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- ========================================\r\n             QUICK ACCESS SECTION\r\n        ======================================== -->\r\n        <section class=\"mb-8\">\r\n            <h2 class=\"text-sm font-semibold text-muted-foreground uppercase tracking-wider mb-4\">\r\n                ${home.quickAccess}\r\n            </h2>\r\n            <div class=\"grid md:grid-cols-3 gap-4\">\r\n                \r\n                <!-- Card 1: AI Scenario Simulator -->\r\n                <a href=\"#planning\" class=\"glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-2\">\r\n                    <div class=\"w-12 h-12 rounded-xl bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n                        <svg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h3 class=\"font-semibold text-foreground mb-2\">${home.aiScenario}</h3>\r\n                    <p class=\"text-sm text-muted-foreground mb-4 leading-relaxed\">\r\n                        ${home.aiScenarioDesc}\r\n                    </p>\r\n                    <span class=\"text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300\">\r\n                        ${home.accessDashboard}\r\n                        <svg class=\"w-4 h-4 transition-transform duration-300 group-hover:translate-x-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\" />\r\n                        </svg>\r\n                    </span>\r\n                </a>\r\n\r\n                <!-- Card 2: AI Assistant Chatbot -->\r\n                <a href=\"#ai-tools\" class=\"glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-3\">\r\n                    <div class=\"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n                        <svg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h3 class=\"font-semibold text-foreground mb-2\">${home.aiChatbot}</h3>\r\n                    <p class=\"text-sm text-muted-foreground mb-4 leading-relaxed\">\r\n                        ${home.aiChatbotDesc}\r\n                    </p>\r\n                    <span class=\"text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300\">\r\n                        ${home.accessDashboard}\r\n                        <svg class=\"w-4 h-4 transition-transform duration-300 group-hover:translate-x-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\" />\r\n                        </svg>\r\n                    </span>\r\n                </a>\r\n\r\n                <!-- Card 3: Operations Dashboard -->\r\n                <a href=\"#dashboard\" class=\"glass border border-border rounded-xl p-6 hover:border-primary/30 hover:bg-card/80 transition-all duration-300 group animate-fade-in stagger-4\">\r\n                    <div class=\"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-primary flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300 shadow-lg\">\r\n                        <svg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h3 class=\"font-semibold text-foreground mb-2\">${home.opsDashboard}</h3>\r\n                    <p class=\"text-sm text-muted-foreground mb-4 leading-relaxed\">\r\n                        ${home.opsDashboardDesc}\r\n                    </p>\r\n                    <span class=\"text-primary text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all duration-300\">\r\n                        ${home.accessDashboard}\r\n                        <svg class=\"w-4 h-4 transition-transform duration-300 group-hover:translate-x-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\" />\r\n                        </svg>\r\n                    </span>\r\n                </a>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- ========================================\r\n             CAPABILITIES SECTION\r\n        ======================================== -->\r\n        <section class=\"mb-8 animate-fade-in stagger-5\">\r\n            <div class=\"flex flex-wrap justify-center gap-3\">\r\n                <!-- AI-Powered Analysis -->\r\n                <div class=\"rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default\">\r\n                    <svg class=\"w-4 h-4 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n                    </svg>\r\n                    <span class=\"text-sm text-muted-foreground\">${home.aiPoweredAnalysis}</span>\r\n                </div>\r\n                \r\n                <!-- Real-time Monitoring -->\r\n                <div class=\"rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default\">\r\n                    <svg class=\"w-4 h-4 text-emerald-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                    </svg>\r\n                    <span class=\"text-sm text-muted-foreground\">${home.realtimeMonitoring}</span>\r\n                </div>\r\n                \r\n                <!-- Risk Mitigation -->\r\n                <div class=\"rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default\">\r\n                    <svg class=\"w-4 h-4 text-amber-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\r\n                    </svg>\r\n                    <span class=\"text-sm text-muted-foreground\">${home.riskMitigation}</span>\r\n                </div>\r\n                \r\n                <!-- Cost Optimization -->\r\n                <div class=\"rounded-full bg-secondary/30 border border-border px-4 py-2 flex items-center gap-2 hover:border-primary/30 hover:text-primary transition-all duration-300 cursor-default\">\r\n                    <svg class=\"w-4 h-4 text-blue-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6\" />\r\n                    </svg>\r\n                    <span class=\"text-sm text-muted-foreground\">${home.costOptimization}</span>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        \r\n    </div>\r\n</div>\r\n`;\r\n};\r\n\r\n/**\r\n * Home page handler\r\n */\r\nexport const homePage = async () => {\r\n    await App.View.render(template(), 'home');\r\n    // Initialize typewriter effect after render\r\n    setTimeout(initTypewriter, 100);\r\n    // Initialize stat counter animation\r\n    animate.initStatCounters(800);\r\n};\r\n","/**\r\n * OptiMine SPA - API Service\r\n * Handle all API calls to backend\r\n */\r\n\r\nimport { Config } from '../../config.js';\r\n\r\nconst BASE_URL = Config.api.baseUrl;\r\n\r\n/**\r\n * API Helper\r\n */\r\nconst api = {\r\n    /**\r\n     * Make HTTP request\r\n     * @param {string} endpoint \r\n     * @param {Object} options \r\n     * @returns {Promise}\r\n     */\r\n    async request(endpoint, options = {}) {\r\n        const url = `${BASE_URL}${endpoint}`;\r\n        const token = localStorage.getItem(Config.storage.token);\r\n\r\n        const defaultHeaders = {\r\n            'Content-Type': 'application/json'\r\n        };\r\n\r\n        if (token) {\r\n            defaultHeaders['Authorization'] = `Bearer ${token}`;\r\n        }\r\n\r\n        const config = {\r\n            ...options,\r\n            headers: {\r\n                ...defaultHeaders,\r\n                ...options.headers\r\n            }\r\n        };\r\n\r\n        try {\r\n            const response = await fetch(url, config);\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.message || 'Request failed');\r\n            }\r\n\r\n            return data;\r\n        } catch (error) {\r\n            console.error('API Error:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * GET request\r\n     */\r\n    get(endpoint) {\r\n        return this.request(endpoint, { method: 'GET' });\r\n    },\r\n\r\n    /**\r\n     * POST request\r\n     */\r\n    post(endpoint, body) {\r\n        return this.request(endpoint, {\r\n            method: 'POST',\r\n            body: JSON.stringify(body)\r\n        });\r\n    },\r\n\r\n    /**\r\n     * PUT request\r\n     */\r\n    put(endpoint, body) {\r\n        return this.request(endpoint, {\r\n            method: 'PUT',\r\n            body: JSON.stringify(body)\r\n        });\r\n    },\r\n\r\n    /**\r\n     * DELETE request\r\n     */\r\n    delete(endpoint) {\r\n        return this.request(endpoint, { method: 'DELETE' });\r\n    }\r\n};\r\n\r\n/**\r\n * API Endpoints\r\n */\r\nexport const API = {\r\n    // Auth endpoints\r\n    auth: {\r\n        login: (credentials) => api.post('/auth/login', credentials),\r\n        register: (userData) => api.post('/auth/register', userData),\r\n        logout: () => api.post('/auth/logout'),\r\n        profile: () => api.get('/auth/profile'),\r\n\r\n        // Password Reset\r\n        forgotPassword: (email) => api.post('/forgot-password', { email }),\r\n        resetPassword: (token, newPassword) => api.post('/reset-password', { token, newPassword })\r\n    },\r\n\r\n    // Mining data endpoints\r\n    mining: {\r\n        getAll: () => api.get('/mining'),\r\n        getById: (id) => api.get(`/mining/${id}`),\r\n        create: (data) => api.post('/mining', data),\r\n        update: (id, data) => api.put(`/mining/${id}`, data),\r\n        delete: (id) => api.delete(`/mining/${id}`)\r\n    },\r\n\r\n    // Production endpoints\r\n    production: {\r\n        getStats: () => api.get('/production/stats'),\r\n        getPlan: (params) => api.get(`/production/plan?${new URLSearchParams(params)}`),\r\n        optimize: (data) => api.post('/production/optimize', data)\r\n    },\r\n\r\n    // AI Assistant endpoints - Connected to Backend AI Service\r\n    ai: {\r\n        chat: async (message) => {\r\n            // Use backend proxy to AI Service (Docker container on port 8000)\r\n            const token = localStorage.getItem(Config.storage.token);\r\n\r\n            console.log(' Sending to Backend AI Service:', `${BASE_URL}/ai/chat`);\r\n            console.log('Message:', message);\r\n\r\n            try {\r\n                const headers = {\r\n                    'Content-Type': 'application/json',\r\n                };\r\n\r\n                // Add Authorization header if token exists\r\n                if (token) {\r\n                    headers['Authorization'] = `Bearer ${token}`;\r\n                }\r\n\r\n                const response = await fetch(`${BASE_URL}/ai/chat`, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify({\r\n                        chatInput: message,\r\n                        message: message,\r\n                        timestamp: new Date().toISOString(),\r\n                        userId: localStorage.getItem('user') || 'anonymous',\r\n                        language: document.documentElement.lang || 'id'\r\n                    })\r\n                });\r\n\r\n                // Try to get response body even if status is not ok\r\n                let data;\r\n                try {\r\n                    const responseText = await response.text();\r\n                    console.log(' Raw response:', responseText);\r\n                    data = responseText ? JSON.parse(responseText) : {};\r\n                } catch (parseError) {\r\n                    console.error('Parse error:', parseError);\r\n                    data = {};\r\n                }\r\n\r\n                console.log(' AI Service response status:', response.status);\r\n                console.log(' AI Service response data:', data);\r\n\r\n                // Check if this is an error message\r\n                if (data.error) {\r\n                    throw new Error(data.message || 'AI Service Error');\r\n                }\r\n\r\n                if (!response.ok) {\r\n                    throw new Error(`HTTP error! status: ${response.status}`);\r\n                }\r\n\r\n                // Return response in expected format\r\n                // Backend returns: { success: true, data: { response: \"...\", model_used: \"...\" } }\r\n                const aiResponse = data.data?.response || data.response || data.output || data.text || data.message || 'No response';\r\n\r\n                return {\r\n                    success: true,\r\n                    data: {\r\n                        response: aiResponse\r\n                    }\r\n                };\r\n            } catch (error) {\r\n                console.error(' Error connecting to AI Service:', error);\r\n                throw error;\r\n            }\r\n        },\r\n\r\n        // AI Planning - Auto Recommend endpoint\r\n        plan: async (payload) => {\r\n            const token = localStorage.getItem(Config.storage.token);\r\n\r\n            console.log(' Sending to AI Plan Service:', `${BASE_URL}/ai/plan`);\r\n            console.log('Payload:', payload);\r\n\r\n            try {\r\n                const headers = {\r\n                    'Content-Type': 'application/json',\r\n                };\r\n\r\n                if (token) {\r\n                    headers['Authorization'] = `Bearer ${token}`;\r\n                }\r\n\r\n                const response = await fetch(`${BASE_URL}/ai/plan`, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(payload)\r\n                });\r\n\r\n                let data;\r\n                try {\r\n                    const responseText = await response.text();\r\n                    console.log(' Raw plan response:', responseText);\r\n                    data = responseText ? JSON.parse(responseText) : {};\r\n                } catch (parseError) {\r\n                    console.error('Parse error:', parseError);\r\n                    data = {};\r\n                }\r\n\r\n                console.log(' AI Plan response status:', response.status);\r\n                console.log(' AI Plan response data:', data);\r\n\r\n                if (data.error) {\r\n                    throw new Error(data.message || 'AI Plan Service Error');\r\n                }\r\n\r\n                if (!response.ok) {\r\n                    throw new Error(`HTTP error! status: ${response.status}`);\r\n                }\r\n\r\n                return data;\r\n            } catch (error) {\r\n                console.error(' Error connecting to AI Plan Service:', error);\r\n                throw error;\r\n            }\r\n        },\r\n\r\n        recommend: (context) => api.post('/ai/recommend', context)\r\n    },\r\n\r\n    // Dashboard endpoints\r\n    dashboard: {\r\n        getSummary: () => api.get('/dashboard/summary'),\r\n        getCharts: () => api.get('/dashboard/charts'),\r\n        getAlerts: () => api.get('/dashboard/alerts')\r\n    }\r\n};\r\n\r\nexport default API;\r\n","/**\r\n * OptiMine SPA - About/Generic Page\r\n * Used as placeholder for routes under development\r\n */\r\n\r\nimport { App } from '../../app.js';\r\nimport { Router } from '../../routes/routes.js';\r\nimport { getSection } from '../../utils/translations.js';\r\nimport { API } from '../../data/api.js';\r\n\r\nconst templates = {\r\n    planning: () => {\r\n        const lang = App.Model.getState('language') || 'id';\r\n        const p = getSection(lang, 'planning');\r\n\r\n        return `\r\n    <div class=\"min-h-[calc(100vh-4rem)] pt-6 relative\">\r\n        <!-- Background Effects -->\r\n        <div class=\"absolute inset-0 -z-10 overflow-hidden\">\r\n            <div class=\"radial-gradient absolute inset-0\"></div>\r\n            <div class=\"absolute top-20 right-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl\"></div>\r\n            <div class=\"absolute bottom-20 left-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl\"></div>\r\n        </div>\r\n        \r\n        <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n            <!-- Header -->\r\n            <div class=\"mb-8 animate-fade-in\">\r\n                <h1 class=\"font-heading text-3xl md:text-4xl font-bold text-foreground\">\r\n                    ${p.title}\r\n                </h1>\r\n                <p class=\"text-muted-foreground mt-2\">\r\n                    ${p.subtitle}\r\n                </p>\r\n            </div>\r\n\r\n            <!-- Main Grid: 2/3 Input, 1/3 Status -->\r\n            <div class=\"grid lg:grid-cols-3 gap-6\">\r\n                \r\n                <!-- LEFT: Input Section (2/3) -->\r\n                <div class=\"lg:col-span-2 space-y-6\">\r\n                    \r\n                    <!-- Weather Conditions Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-1\">\r\n                        <h2 class=\"font-semibold text-lg text-foreground mb-6 flex items-center gap-2\">\r\n                            <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z\" />\r\n                            </svg>\r\n                            ${p.weatherConditions}\r\n                        </h2>\r\n                        \r\n                        <div class=\"space-y-6\">\r\n                            <!-- Rainfall Level Slider -->\r\n                            <div>\r\n                                <label class=\"block text-sm font-medium text-muted-foreground mb-3\">${p.rainfallLevel}</label>\r\n                                <input \r\n                                    type=\"range\" \r\n                                    min=\"0\" \r\n                                    max=\"100\" \r\n                                    value=\"50\"\r\n                                    class=\"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer slider-primary\"\r\n                                >\r\n                                <div class=\"flex justify-between text-xs text-muted-foreground mt-2\">\r\n                                    <span>${p.low}</span>\r\n                                    <span>${p.high}</span>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <!-- Wave Height Slider -->\r\n                            <div>\r\n                                <label class=\"block text-sm font-medium text-muted-foreground mb-3\">${p.waveHeight}</label>\r\n                                <input \r\n                                    type=\"range\" \r\n                                    min=\"0\" \r\n                                    max=\"100\" \r\n                                    value=\"35\"\r\n                                    class=\"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer slider-primary\"\r\n                                >\r\n                                <div class=\"flex justify-between text-xs text-muted-foreground mt-2\">\r\n                                    <span>${p.calm}</span>\r\n                                    <span>${p.rough}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Fleet Status Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-2\">\r\n                        <h2 class=\"font-semibold text-lg text-foreground mb-6 flex items-center gap-2\">\r\n                            <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4\" />\r\n                            </svg>\r\n                            ${p.fleetStatus}\r\n                        </h2>\r\n                        \r\n                        <div class=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label class=\"block text-sm font-medium text-muted-foreground mb-2\">${p.activeVehicles}</label>\r\n                                <input \r\n                                    type=\"number\" \r\n                                    value=\"25\"\r\n                                    class=\"w-full px-4 py-3 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                                >\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"block text-sm font-medium text-muted-foreground mb-2\">${p.maintenanceStatus}</label>\r\n                                <input \r\n                                    type=\"number\" \r\n                                    value=\"3\"\r\n                                    class=\"w-full px-4 py-3 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                                >\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Ship Schedule Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-3\">\r\n                        <h2 class=\"font-semibold text-lg text-foreground mb-6 flex items-center gap-2\">\r\n                            <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 13h2m-2 4h2m-2-8h2m4 8v-2a2 2 0 012-2h6a2 2 0 012 2v2M7 9V7a2 2 0 012-2h6a2 2 0 012 2v2m-4 4h.01M12 17h.01\" />\r\n                            </svg>\r\n                            ${p.shipSchedule}\r\n                        </h2>\r\n                        \r\n                        <div class=\"space-y-3\">\r\n                            <div class=\"flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg\">\r\n                                <span class=\"text-foreground\">Vessel A - 08:00</span>\r\n                                <span class=\"px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full\">${p.active}</span>\r\n                            </div>\r\n                            <div class=\"flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg\">\r\n                                <span class=\"text-foreground\">Vessel B - 14:00</span>\r\n                                <span class=\"px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full\">${p.active}</span>\r\n                            </div>\r\n                            <div class=\"flex items-center justify-between p-3 bg-secondary/30 border border-border rounded-lg\">\r\n                                <span class=\"text-foreground\">Vessel C - 20:00</span>\r\n                                <span class=\"px-3 py-1 text-xs font-medium bg-primary/20 text-primary rounded-full\">${p.active}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Generate Button -->\r\n                    <button class=\"w-full h-14 bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl font-semibold transition-all duration-300 flex items-center justify-center gap-2 glow-hover animate-fade-in stagger-4\">\r\n                        <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z\" />\r\n                        </svg>\r\n                        ${p.generatePlan}\r\n                    </button>\r\n                </div>\r\n                \r\n                <!-- RIGHT: Status Panel (1/3) -->\r\n                <div class=\"lg:col-span-1 space-y-6\">\r\n                    \r\n                    <!-- System Status Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 border-glow animate-fade-in stagger-2\">\r\n                        <h2 class=\"font-semibold text-lg text-foreground mb-6 flex items-center gap-2\">\r\n                            <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                            </svg>\r\n                            ${p.systemStatus}\r\n                        </h2>\r\n                        \r\n                        <div class=\"space-y-3\">\r\n                            <div class=\"flex items-center gap-3 p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg\">\r\n                                <span class=\"relative flex h-3 w-3\">\r\n                                    <span class=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75\"></span>\r\n                                    <span class=\"relative inline-flex rounded-full h-3 w-3 bg-emerald-500\"></span>\r\n                                </span>\r\n                                <span class=\"text-emerald-400 font-medium\">${p.aiSystemOnline}</span>\r\n                            </div>\r\n                            <div class=\"flex items-center gap-3 p-3 bg-primary/10 border border-primary/30 rounded-lg\">\r\n                                <span class=\"relative flex h-3 w-3\">\r\n                                    <span class=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75\"></span>\r\n                                    <span class=\"relative inline-flex rounded-full h-3 w-3 bg-primary\"></span>\r\n                                </span>\r\n                                <span class=\"text-primary font-medium\">${p.n8nReady}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Active Alerts Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-3\">\r\n                        <h2 class=\"font-semibold text-lg text-foreground mb-6 flex items-center gap-2\">\r\n                            <svg class=\"w-5 h-5 text-amber-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n                            </svg>\r\n                            ${p.activeAlerts}\r\n                        </h2>\r\n                        \r\n                        <div class=\"space-y-3\">\r\n                            <div class=\"p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg\">\r\n                                <p class=\"text-amber-400 text-sm\">${p.alertRainfall}</p>\r\n                            </div>\r\n                            <div class=\"p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg\">\r\n                                <p class=\"text-orange-400 text-sm\">${p.alertMaintenance}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n    },\r\n\r\n    'ai-tools': () => {\r\n        const lang = App.Model.getState('language') || 'id';\r\n        const ai = getSection(lang, 'aiTools');\r\n\r\n        return `\r\n    <div class=\"h-[calc(100vh-4rem)] pt-6\">\r\n        <div class=\"h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\r\n            <!-- Header -->\r\n            <div class=\"mb-6 animate-fade-in\">\r\n                <h1 class=\"font-heading text-3xl md:text-4xl font-bold text-foreground\">${ai.title}</h1>\r\n                <p class=\"text-muted-foreground mt-1\">${ai.subtitle}</p>\r\n            </div>\r\n            \r\n            <!-- Main Grid: Chat 3/4, Sidebar 1/4 -->\r\n            <div class=\"grid lg:grid-cols-4 gap-6 h-[calc(100%-6rem)]\">\r\n                \r\n                <!-- CHAT AREA (3/4) -->\r\n                <div class=\"lg:col-span-3 flex flex-col glass border border-border rounded-xl overflow-hidden animate-fade-in stagger-1\">\r\n                    \r\n                    <!-- Messages Area -->\r\n                    <div class=\"flex-1 overflow-y-auto p-6 space-y-4\" id=\"chat-messages\">\r\n                        \r\n                        <!-- AI Message -->\r\n                        <div class=\"flex items-start gap-3\">\r\n                            <div class=\"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0\">\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div class=\"flex-1 max-w-[85%]\">\r\n                                <div class=\"bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4\">\r\n                                    <p class=\"text-foreground\">${ai.greeting}</p>\r\n                                </div>\r\n                                <span class=\"text-xs text-muted-foreground mt-1 block\">12:29 PM</span>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                    </div>\r\n                    \r\n                    <!-- Input Area -->\r\n                    <div class=\"border-t border-border p-4\">\r\n                        <div class=\"flex gap-3\">\r\n                            <input \r\n                                type=\"text\" \r\n                                id=\"chat-input\"\r\n                                placeholder=\"${ai.placeholder}\" \r\n                                class=\"flex-1 px-4 py-3 bg-secondary/30 border border-border rounded-xl text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\"\r\n                            >\r\n                            <button id=\"send-btn\" class=\"px-5 py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl transition-all duration-300 glow-hover flex items-center justify-center\">\r\n                                <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\r\n                                </svg>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <!-- SIDEBAR (1/4) -->\r\n                <div class=\"lg:col-span-1 space-y-4\">\r\n                    \r\n                    <!-- AI Status Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-4 border-glow animate-fade-in stagger-2\">\r\n                        <div class=\"flex items-center gap-2 mb-2\">\r\n                            <span class=\"relative flex h-3 w-3\">\r\n                                <span class=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75\"></span>\r\n                                <span class=\"relative inline-flex rounded-full h-3 w-3 bg-emerald-500\"></span>\r\n                            </span>\r\n                            <span class=\"text-emerald-400 font-semibold\">${ai.aiOnline}</span>\r\n                        </div>\r\n                        <div class=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                            <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                            </svg>\r\n                            <span>${ai.responseTime}: &lt;2s</span>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Suggested Prompts Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-3\">\r\n                        <h3 class=\"font-semibold text-foreground mb-3 flex items-center gap-2\">\r\n                            <svg class=\"w-4 h-4 text-amber-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\r\n                            </svg>\r\n                            ${ai.suggestedPrompts}\r\n                        </h3>\r\n                        <div class=\"space-y-2\">\r\n                            <button class=\"suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all\">\r\n                                ${ai.prompt1}\r\n                            </button>\r\n                            <button class=\"suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all\">\r\n                                ${ai.prompt2}\r\n                            </button>\r\n                            <button class=\"suggested-prompt w-full text-left p-3 text-xs text-muted-foreground bg-secondary/30 border border-border rounded-lg hover:border-primary/30 hover:text-foreground transition-all\">\r\n                                ${ai.prompt3}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Integration Info Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-4\">\r\n                        <h3 class=\"font-semibold text-foreground mb-2 flex items-center gap-2\">\r\n                            <svg class=\"w-4 h-4 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z\" />\r\n                            </svg>\r\n                            ${ai.integration}\r\n                        </h3>\r\n                        <p class=\"text-xs text-muted-foreground\">\r\n                            ${ai.integrationDesc}\r\n                        </p>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n    },\r\n\r\n    dashboard: () => {\r\n        const lang = App.Model.getState('language') || 'id';\r\n        const d = getSection(lang, 'dashboard');\r\n\r\n        return `\r\n    <div class=\"min-h-screen pt-6 pb-8 px-4 sm:px-6 lg:px-8\">\r\n        <div class=\"max-w-7xl mx-auto\">\r\n            <div class=\"mb-8 animate-fade-in\">\r\n                <h1 class=\"font-heading text-3xl md:text-4xl font-bold text-foreground\">\r\n                    ${d.title}\r\n                </h1>\r\n                <p class=\"text-muted-foreground mt-2\">\r\n                    ${d.subtitle}\r\n                </p>\r\n            </div>\r\n\r\n            <div class=\"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\r\n                <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-1\">\r\n                    <div class=\"flex items-center justify-between mb-2\">\r\n                        <span class=\"text-sm text-muted-foreground\">${d.totalProduction}</span>\r\n                        <i data-lucide=\"trending-up\" class=\"w-4 h-4 text-green-500\"></i>\r\n                    </div>\r\n                    <p class=\"text-2xl font-bold text-foreground\">24,580</p>\r\n                    <p class=\"text-xs text-green-500\">+12.5% ${d.fromLastMonth}</p>\r\n                </div>\r\n                \r\n                <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-2\">\r\n                    <div class=\"flex items-center justify-between mb-2\">\r\n                        <span class=\"text-sm text-muted-foreground\">${d.activeEquipment}</span>\r\n                        <i data-lucide=\"truck\" class=\"w-4 h-4 text-primary\"></i>\r\n                    </div>\r\n                    <p class=\"text-2xl font-bold text-foreground\">42</p>\r\n                    <p class=\"text-xs text-muted-foreground\">${d.outOfTotal}</p>\r\n                </div>\r\n                \r\n                <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-3\">\r\n                    <div class=\"flex items-center justify-between mb-2\">\r\n                        <span class=\"text-sm text-muted-foreground\">${d.efficiencyRate}</span>\r\n                        <i data-lucide=\"gauge\" class=\"w-4 h-4 text-amber-500\"></i>\r\n                    </div>\r\n                    <p class=\"text-2xl font-bold text-foreground\">94.2%</p>\r\n                    <p class=\"text-xs text-amber-500\">${d.target}: 95%</p>\r\n                </div>\r\n                \r\n                <div class=\"glass border border-border rounded-xl p-4 animate-fade-in stagger-4\">\r\n                    <div class=\"flex items-center justify-between mb-2\">\r\n                        <span class=\"text-sm text-muted-foreground\">${d.costSavings}</span>\r\n                        <i data-lucide=\"dollar-sign\" class=\"w-4 h-4 text-green-500\"></i>\r\n                    </div>\r\n                    <p class=\"text-2xl font-bold text-foreground\">$1.2M</p>\r\n                    <p class=\"text-xs text-green-500\">${d.thisQuarter}</p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"grid lg:grid-cols-2 gap-6\">\r\n                <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-5\">\r\n                    <h3 class=\"font-semibold text-foreground mb-4 flex items-center gap-2\">\r\n                        <i data-lucide=\"line-chart\" class=\"w-5 h-5 text-primary\"></i>\r\n                        ${d.productionTrends}\r\n                    </h3>\r\n                    <div class=\"h-64 flex items-center justify-center bg-secondary/20 rounded-lg\">\r\n                        <p class=\"text-muted-foreground\">${d.chartPlaceholder}</p>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div class=\"glass border border-border rounded-xl p-6 animate-fade-in stagger-5\">\r\n                    <h3 class=\"font-semibold text-foreground mb-4 flex items-center gap-2\">\r\n                        <i data-lucide=\"truck\" class=\"w-5 h-5 text-primary\"></i>\r\n                        ${d.equipmentStatus}\r\n                    </h3>\r\n                    <div class=\"h-64 flex items-center justify-center bg-secondary/20 rounded-lg\">\r\n                        <p class=\"text-muted-foreground\">${d.statusPlaceholder}</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n    },\r\n\r\n    auth: () => {\r\n        const lang = localStorage.getItem('optimine-language') || 'id';\r\n        const a = getSection(lang, 'auth');\r\n\r\n        return `\r\n    <div class=\"min-h-screen flex items-center justify-center px-4 pt-6 pb-8\">\r\n        <div class=\"w-full max-w-md\">\r\n            <!-- Main Auth Card -->\r\n            <div id=\"auth-card\" class=\"glass border border-border rounded-2xl p-6 sm:p-8 animate-scale-in\">\r\n                <!-- Header with Logo -->\r\n                <div class=\"text-center mb-6\">\r\n                    <img \r\n                        src=\"assets/images/b (192 x 192 piksel) (1).png\" \r\n                        alt=\"OptiMine Logo\" \r\n                        class=\"w-16 h-16 mx-auto mb-4 rounded-full border-2 border-amber-500/50 shadow-lg\"\r\n                    >\r\n                    <h1 class=\"font-heading text-2xl font-bold\">\r\n                        <span class=\"text-primary\">Opti</span><span class=\"text-foreground\">Mine</span>\r\n                    </h1>\r\n                    <p class=\"text-sm text-muted-foreground mt-1\">Mining Value Chain Optimization Platform</p>\r\n                </div>\r\n                \r\n                <!-- Tab Navigation -->\r\n                <div class=\"grid grid-cols-2 bg-secondary/50 border border-border rounded-lg p-1 mb-6\">\r\n                    <button id=\"login-tab\" class=\"auth-tab active py-2.5 px-4 text-sm font-medium rounded-md transition-all duration-300\">\r\n                        ${a.login}\r\n                    </button>\r\n                    <button id=\"register-tab\" class=\"auth-tab py-2.5 px-4 text-sm font-medium rounded-md transition-all duration-300\">\r\n                        ${a.register}\r\n                    </button>\r\n                </div>\r\n                \r\n                <!-- LOGIN FORM -->\r\n                <form id=\"login-form\" class=\"space-y-4\">\r\n                    <!-- Email -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.email}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"email\" \r\n                                id=\"login-email\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"email@example.com\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Password -->\r\n                    <div>\r\n                        <div class=\"flex items-center justify-between mb-2\">\r\n                            <label class=\"block text-sm font-medium text-foreground\">${a.password}</label>\r\n                            <button type=\"button\" id=\"forgot-password-btn\" class=\"text-xs text-primary hover:text-primary/80 transition-colors\">\r\n                                ${a.forgotPassword}\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"password\" \r\n                                id=\"login-password\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Submit Button -->\r\n                    <button \r\n                        type=\"submit\" \r\n                        class=\"w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover mt-6\"\r\n                    >\r\n                        ${a.signIn}\r\n                    </button>\r\n                </form>\r\n                \r\n                <!-- REGISTER FORM -->\r\n                <form id=\"register-form\" class=\"space-y-4 hidden\">\r\n                    <!-- Full Name -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.fullName}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"text\" \r\n                                id=\"register-name\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"John Doe\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Email -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.email}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"email\" \r\n                                id=\"register-email\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"email@example.com\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Password -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.password}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"password\" \r\n                                id=\"register-password\" \r\n                                required \r\n                                minlength=\"6\"\r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"\"\r\n                            >\r\n                        </div>\r\n                        <!-- Password Strength Container (hidden by default) -->\r\n                        <div id=\"password-info-container\" class=\"hidden mt-3 p-3 bg-secondary/30 border border-border rounded-lg animate-fade-in\">\r\n                            <!-- Password Strength Indicator -->\r\n                            <div id=\"password-strength-container\" class=\"hidden mb-3\">\r\n                                <div class=\"flex gap-1 mb-1\">\r\n                                    <div id=\"strength-bar-1\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                    <div id=\"strength-bar-2\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                    <div id=\"strength-bar-3\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                    <div id=\"strength-bar-4\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                </div>\r\n                                <p id=\"password-strength-text\" class=\"text-xs font-medium\"></p>\r\n                            </div>\r\n                            <!-- Password Requirements -->\r\n                            <div id=\"password-requirements\" class=\"space-y-1.5 text-xs\">\r\n                                <p id=\"req-title\" class=\"text-muted-foreground font-medium mb-2\"></p>\r\n                                <p id=\"req-length\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                    <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                    </svg>\r\n                                    <span></span>\r\n                                </p>\r\n                                <p id=\"req-uppercase\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                    <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                    </svg>\r\n                                    <span></span>\r\n                                </p>\r\n                                <p id=\"req-number\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                    <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                    </svg>\r\n                                    <span></span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Confirm Password -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.confirmPassword}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"password\" \r\n                                id=\"register-confirm-password\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Role Dropdown -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.role}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <select \r\n                                id=\"register-role\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-10 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all appearance-none cursor-pointer\"\r\n                            >\r\n                                <option value=\"mine_planner\">${a.miningPlanner}</option>\r\n                                <option value=\"shipping_planner\">${a.shippingPlanner}</option>\r\n                            </select>\r\n                            <div class=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\" />\r\n                                </svg>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Submit Button -->\r\n                    <button \r\n                        type=\"submit\" \r\n                        class=\"w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover mt-2\"\r\n                    >\r\n                        ${a.createAccount}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n            \r\n            <!-- FORGOT PASSWORD CARD -->\r\n            <div id=\"forgot-password-card\" class=\"glass border border-border rounded-2xl p-6 sm:p-8 animate-scale-in hidden\">\r\n                <!-- Header -->\r\n                <div class=\"text-center mb-6\">\r\n                    <div class=\"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/20 flex items-center justify-center\">\r\n                        <svg class=\"w-8 h-8 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h2 class=\"font-heading text-xl font-bold text-foreground\">${a.resetPassword}</h2>\r\n                    <p class=\"text-sm text-muted-foreground mt-2\">${a.resetDesc}</p>\r\n                </div>\r\n                \r\n                <form id=\"forgot-password-form\" class=\"space-y-4\">\r\n                    <!-- Email -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${a.email}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"email\" \r\n                                id=\"forgot-email\" \r\n                                required \r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"email@example.com\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Submit Button -->\r\n                    <button \r\n                        type=\"submit\" \r\n                        class=\"w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover\"\r\n                    >\r\n                        ${a.sendResetLink}\r\n                    </button>\r\n                    \r\n                    <!-- Back to Login -->\r\n                    <button \r\n                        type=\"button\" \r\n                        id=\"back-to-login-btn\"\r\n                        class=\"w-full py-3 bg-secondary/50 hover:bg-secondary/70 text-foreground border border-border rounded-lg font-medium transition-all duration-300\"\r\n                    >\r\n                        ${a.backToLogin}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n    },\r\n\r\n    profile: () => {\r\n        const user = JSON.parse(localStorage.getItem('optimine-user') || '{}');\r\n        const theme = localStorage.getItem('optimine-theme') || 'dark';\r\n        const lang = localStorage.getItem('optimine-language') || 'id';\r\n        const pr = getSection(lang, 'profile');\r\n\r\n        return `\r\n        <div class=\"min-h-screen pt-6 pb-8 px-4 sm:px-6 lg:px-8\">\r\n            <div class=\"max-w-2xl mx-auto\">\r\n                <div class=\"mb-8 animate-fade-in\">\r\n                    <h1 class=\"font-heading text-3xl md:text-4xl font-bold text-foreground\">\r\n                        ${pr.title}\r\n                    </h1>\r\n                    <p class=\"text-muted-foreground mt-2\">\r\n                        ${pr.subtitle}\r\n                    </p>\r\n                </div>\r\n\r\n                <div class=\"glass border border-border rounded-xl p-6 mb-6 animate-fade-in stagger-1\">\r\n                    <div class=\"flex items-center gap-4 mb-6\">\r\n                        <div class=\"w-20 h-20 rounded-full bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center text-white text-2xl font-bold\">\r\n                            ${(user.name || 'U').charAt(0).toUpperCase()}\r\n                        </div>\r\n                        <div>\r\n                            <h2 class=\"text-xl font-semibold text-foreground\">${user.name || 'User'}</h2>\r\n                            <p class=\"text-muted-foreground\">${user.email || 'user@example.com'}</p>\r\n                            <span class=\"inline-block mt-1 px-2 py-0.5 text-xs bg-primary/10 text-primary rounded-full\">${user.role || 'member'}</span>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"space-y-4\">\r\n                        <div>\r\n                            <label class=\"block text-sm font-medium text-foreground mb-1\">${pr.displayName}</label>\r\n                            <input type=\"text\" value=\"${user.name || ''}\" class=\"w-full px-4 py-2.5 bg-secondary/50 border border-border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\">\r\n                        </div>\r\n                        <div>\r\n                            <label class=\"block text-sm font-medium text-foreground mb-1\">${pr.email}</label>\r\n                            <input type=\"email\" value=\"${user.email || ''}\" disabled class=\"w-full px-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-muted-foreground\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"glass border border-border rounded-xl p-6 mb-6 animate-fade-in stagger-2\">\r\n                    <h3 class=\"font-semibold text-foreground mb-4\">${pr.preferences}</h3>\r\n                    \r\n                    <div class=\"space-y-4\">\r\n                        <div class=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p class=\"font-medium text-foreground\">${pr.darkMode}</p>\r\n                                <p class=\"text-sm text-muted-foreground\">${pr.useDarkTheme}</p>\r\n                            </div>\r\n                            <button id=\"profile-theme-toggle\" class=\"relative w-12 h-6 bg-secondary rounded-full transition-colors ${theme === 'dark' ? 'bg-primary/30' : ''}\">\r\n                                <span class=\"absolute left-1 top-1 w-4 h-4 bg-foreground rounded-full transition-transform ${theme === 'dark' ? 'translate-x-6 bg-primary' : ''}\"></span>\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        <div class=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p class=\"font-medium text-foreground\">${pr.language}</p>\r\n                                <p class=\"text-sm text-muted-foreground\">${pr.selectLanguage}</p>\r\n                            </div>\r\n                            <div class=\"flex gap-2\">\r\n                                <button class=\"profile-lang-btn px-3 py-1.5 text-sm rounded-md transition-colors ${lang === 'en' ? 'bg-primary/10 text-primary' : 'hover:bg-secondary/50'}\" data-lang=\"en\"> EN</button>\r\n                                <button class=\"profile-lang-btn px-3 py-1.5 text-sm rounded-md transition-colors ${lang === 'id' ? 'bg-primary/10 text-primary' : 'hover:bg-secondary/50'}\" data-lang=\"id\"> ID</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <button id=\"logout-btn\" class=\"w-full py-2.5 border border-red-500/50 text-red-500 hover:bg-red-500/10 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 animate-fade-in stagger-3\">\r\n                    <i data-lucide=\"log-out\" class=\"w-4 h-4\"></i>\r\n                    ${pr.signOut}\r\n                </button>\r\n            </div>\r\n        </div>\r\n        `;\r\n    }\r\n};\r\n\r\n/**\r\n * Setup auth form handlers\r\n */\r\nconst setupAuthHandlers = () => {\r\n    const loginTab = document.getElementById('login-tab');\r\n    const registerTab = document.getElementById('register-tab');\r\n    let loginForm = document.getElementById('login-form');\r\n    let registerForm = document.getElementById('register-form');\r\n    const authCard = document.getElementById('auth-card');\r\n    const forgotPasswordCard = document.getElementById('forgot-password-card');\r\n    const forgotPasswordBtn = document.getElementById('forgot-password-btn');\r\n    const backToLoginBtn = document.getElementById('back-to-login-btn');\r\n    const forgotPasswordForm = document.getElementById('forgot-password-form');\r\n\r\n    // Clone forms to remove all previous event listeners (prevent duplicate handlers)\r\n    if (loginForm) {\r\n        const loginFormClone = loginForm.cloneNode(true);\r\n        loginForm.replaceWith(loginFormClone);\r\n        loginForm = loginFormClone;\r\n    }\r\n    if (registerForm) {\r\n        const registerFormClone = registerForm.cloneNode(true);\r\n        registerForm.replaceWith(registerFormClone);\r\n        registerForm = registerFormClone;\r\n    }\r\n\r\n    // Tab switching - Login\r\n    loginTab?.addEventListener('click', () => {\r\n        loginTab.classList.add('active');\r\n        registerTab?.classList.remove('active');\r\n        loginForm?.classList.remove('hidden');\r\n        registerForm?.classList.add('hidden');\r\n    });\r\n\r\n    // Tab switching - Register\r\n    registerTab?.addEventListener('click', () => {\r\n        registerTab.classList.add('active');\r\n        loginTab?.classList.remove('active');\r\n        registerForm?.classList.remove('hidden');\r\n        loginForm?.classList.add('hidden');\r\n    });\r\n\r\n    // Password Strength Checker\r\n    const registerPassword = document.getElementById('register-password');\r\n    const passwordInfoContainer = document.getElementById('password-info-container');\r\n    const strengthContainer = document.getElementById('password-strength-container');\r\n    const strengthText = document.getElementById('password-strength-text');\r\n    const strengthBars = [\r\n        document.getElementById('strength-bar-1'),\r\n        document.getElementById('strength-bar-2'),\r\n        document.getElementById('strength-bar-3'),\r\n        document.getElementById('strength-bar-4')\r\n    ];\r\n    const reqTitle = document.getElementById('req-title');\r\n    const reqLength = document.getElementById('req-length');\r\n    const reqUppercase = document.getElementById('req-uppercase');\r\n    const reqNumber = document.getElementById('req-number');\r\n\r\n    // Get current language translations\r\n    const getAuthTranslations = () => {\r\n        const lang = localStorage.getItem('optimine-language') || 'id';\r\n        return window.getSection ? window.getSection(lang, 'auth') : {\r\n            passwordRequirements: lang === 'en' ? 'Password Requirements:' : 'Persyaratan Password:',\r\n            minLength: lang === 'en' ? 'Minimum 6 characters' : 'Minimal 6 karakter',\r\n            uppercase: lang === 'en' ? 'Uppercase letter (A-Z)' : 'Huruf kapital (A-Z)',\r\n            number: lang === 'en' ? 'Number (0-9)' : 'Angka (0-9)',\r\n            weak: lang === 'en' ? 'Weak' : 'Lemah',\r\n            medium: lang === 'en' ? 'Medium' : 'Sedang',\r\n            fair: lang === 'en' ? 'Fair' : 'Cukup Kuat',\r\n            strong: lang === 'en' ? 'Strong' : 'Kuat',\r\n            passwordError: lang === 'en' ? 'Password must be at least 6 characters, contain uppercase letter and number!' : 'Password harus minimal 6 karakter, mengandung huruf kapital dan angka!',\r\n            passwordMismatch: lang === 'en' ? 'Passwords do not match!' : 'Password tidak cocok!'\r\n        };\r\n    };\r\n\r\n    // Initialize requirement texts\r\n    const initPasswordRequirements = () => {\r\n        const t = getAuthTranslations();\r\n        if (reqTitle) reqTitle.textContent = t.passwordRequirements;\r\n        if (reqLength) reqLength.querySelector('span').textContent = t.minLength;\r\n        if (reqUppercase) reqUppercase.querySelector('span').textContent = t.uppercase;\r\n        if (reqNumber) reqNumber.querySelector('span').textContent = t.number;\r\n    };\r\n\r\n    const checkPasswordStrength = (password) => {\r\n        const t = getAuthTranslations();\r\n        let strength = 0;\r\n        const checks = {\r\n            length: password.length >= 6,\r\n            uppercase: /[A-Z]/.test(password),\r\n            number: /[0-9]/.test(password),\r\n            special: /[!@#$%^&*(),.?\":{}|<>]/.test(password),\r\n            lowercase: /[a-z]/.test(password)\r\n        };\r\n\r\n        // Update requirement indicators\r\n        updateRequirement(reqLength, checks.length, t.minLength);\r\n        updateRequirement(reqUppercase, checks.uppercase, t.uppercase);\r\n        updateRequirement(reqNumber, checks.number, t.number);\r\n\r\n        // Calculate strength\r\n        if (checks.length) strength++;\r\n        if (checks.uppercase) strength++;\r\n        if (checks.number) strength++;\r\n        if (checks.special || (checks.lowercase && password.length >= 8)) strength++;\r\n\r\n        return { strength, checks };\r\n    };\r\n\r\n    const updateRequirement = (element, isValid, text) => {\r\n        if (!element) return;\r\n        if (isValid) {\r\n            element.classList.remove('text-muted-foreground');\r\n            element.classList.add('text-green-500');\r\n            element.innerHTML = `\r\n                <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\r\n                </svg>\r\n                <span>${text}</span>\r\n            `;\r\n        } else {\r\n            element.classList.add('text-muted-foreground');\r\n            element.classList.remove('text-green-500');\r\n            element.innerHTML = `\r\n                <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                </svg>\r\n                <span>${text}</span>\r\n            `;\r\n        }\r\n    };\r\n\r\n    const updateStrengthUI = (strength) => {\r\n        const t = getAuthTranslations();\r\n        const colors = {\r\n            0: { bar: 'bg-secondary', text: '', label: '' },\r\n            1: { bar: 'bg-red-500', text: 'text-red-500', label: t.weak },\r\n            2: { bar: 'bg-orange-500', text: 'text-orange-500', label: t.medium },\r\n            3: { bar: 'bg-yellow-500', text: 'text-yellow-500', label: t.fair },\r\n            4: { bar: 'bg-green-500', text: 'text-green-500', label: t.strong }\r\n        };\r\n\r\n        const config = colors[strength];\r\n\r\n        // Update bars\r\n        strengthBars.forEach((bar, index) => {\r\n            if (!bar) return;\r\n            bar.className = 'h-1.5 flex-1 rounded-full transition-colors duration-300';\r\n            if (index < strength) {\r\n                bar.classList.add(config.bar);\r\n            } else {\r\n                bar.classList.add('bg-secondary');\r\n            }\r\n        });\r\n\r\n        // Update text\r\n        if (strengthText) {\r\n            strengthText.textContent = config.label;\r\n            strengthText.className = `text-xs font-medium ${config.text}`;\r\n        }\r\n    };\r\n\r\n    // Show password info on focus\r\n    registerPassword?.addEventListener('focus', () => {\r\n        initPasswordRequirements();\r\n        passwordInfoContainer?.classList.remove('hidden');\r\n    });\r\n\r\n    // Hide password info on blur (only if empty)\r\n    registerPassword?.addEventListener('blur', () => {\r\n        if (!registerPassword.value) {\r\n            passwordInfoContainer?.classList.add('hidden');\r\n            strengthContainer?.classList.add('hidden');\r\n        }\r\n    });\r\n\r\n    registerPassword?.addEventListener('input', (e) => {\r\n        const password = e.target.value;\r\n        const t = getAuthTranslations();\r\n\r\n        // Always show container when typing\r\n        passwordInfoContainer?.classList.remove('hidden');\r\n\r\n        if (password.length > 0) {\r\n            strengthContainer?.classList.remove('hidden');\r\n            const { strength } = checkPasswordStrength(password);\r\n            updateStrengthUI(strength);\r\n        } else {\r\n            strengthContainer?.classList.add('hidden');\r\n            updateStrengthUI(0);\r\n            // Reset requirements with translations\r\n            updateRequirement(reqLength, false, t.minLength);\r\n            updateRequirement(reqUppercase, false, t.uppercase);\r\n            updateRequirement(reqNumber, false, t.number);\r\n        }\r\n    });\r\n\r\n    // Show Forgot Password\r\n    forgotPasswordBtn?.addEventListener('click', () => {\r\n        authCard?.classList.add('hidden');\r\n        forgotPasswordCard?.classList.remove('hidden');\r\n    });\r\n\r\n    // Back to Login from Forgot Password\r\n    backToLoginBtn?.addEventListener('click', () => {\r\n        forgotPasswordCard?.classList.add('hidden');\r\n        authCard?.classList.remove('hidden');\r\n        // Reset to login tab\r\n        loginTab?.classList.add('active');\r\n        registerTab?.classList.remove('active');\r\n        loginForm?.classList.remove('hidden');\r\n        registerForm?.classList.add('hidden');\r\n    });\r\n\r\n    // Login Form Submit\r\n    loginForm?.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('login-email')?.value;\r\n        const password = document.getElementById('login-password')?.value;\r\n\r\n        // Add loading state\r\n        const submitBtn = loginForm.querySelector('button[type=\"submit\"]');\r\n        const originalText = submitBtn?.innerHTML;\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = `\r\n                <svg class=\"animate-spin h-5 w-5 mx-auto\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n            `;\r\n            submitBtn.disabled = true;\r\n        }\r\n\r\n        await App.Presenter.handleLogin(email, password);\r\n\r\n        // Reset button\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = originalText;\r\n            submitBtn.disabled = false;\r\n        }\r\n    });\r\n\r\n    // Register Form Submit\r\n    registerForm?.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const name = document.getElementById('register-name')?.value;\r\n        const email = document.getElementById('register-email')?.value;\r\n        const password = document.getElementById('register-password')?.value;\r\n        const confirmPassword = document.getElementById('register-confirm-password')?.value;\r\n        const role = document.getElementById('register-role')?.value;\r\n\r\n        // Get translations for error messages\r\n        const t = getAuthTranslations();\r\n\r\n        // Validate password requirements\r\n        const hasMinLength = password.length >= 6;\r\n        const hasUppercase = /[A-Z]/.test(password);\r\n        const hasNumber = /[0-9]/.test(password);\r\n\r\n        if (!hasMinLength || !hasUppercase || !hasNumber) {\r\n            // Don't show toast here - let Presenter handle it\r\n            return;\r\n        }\r\n\r\n        // Validate passwords match\r\n        if (password !== confirmPassword) {\r\n            // Don't show toast here - let Presenter handle it\r\n            return;\r\n        }\r\n\r\n        // Add loading state\r\n        const submitBtn = registerForm.querySelector('button[type=\"submit\"]');\r\n        const originalText = submitBtn?.innerHTML;\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = `\r\n                <svg class=\"animate-spin h-5 w-5 mx-auto\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n            `;\r\n            submitBtn.disabled = true;\r\n        }\r\n\r\n        await App.Presenter.handleRegister(name, email, password, role);\r\n\r\n        // Reset button\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = originalText;\r\n            submitBtn.disabled = false;\r\n        }\r\n    });\r\n\r\n    // Forgot Password Form Submit\r\n    forgotPasswordForm?.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('forgot-email')?.value;\r\n        const lang = localStorage.getItem('optimine-language') || 'id';\r\n\r\n        if (!email) {\r\n            App.View.showToast(lang === 'en' ? 'Please enter your email' : 'Silakan masukkan email Anda', 'error');\r\n            return;\r\n        }\r\n\r\n        // Add loading state\r\n        const submitBtn = forgotPasswordForm.querySelector('button[type=\"submit\"]');\r\n        const originalText = submitBtn?.innerHTML;\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = `\r\n                <svg class=\"animate-spin h-5 w-5 mx-auto\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n            `;\r\n            submitBtn.disabled = true;\r\n        }\r\n\r\n        try {\r\n            // Call backend API to send reset password email\r\n            await API.auth.forgotPassword(email);\r\n\r\n            // Show success message\r\n            App.View.showToast(\r\n                lang === 'en'\r\n                    ? 'Password reset link has been sent to your email'\r\n                    : 'Link reset password telah dikirim ke email Anda',\r\n                'success'\r\n            );\r\n\r\n            // Clear form and go back to login\r\n            document.getElementById('forgot-email').value = '';\r\n            forgotPasswordCard?.classList.add('hidden');\r\n            authCard?.classList.remove('hidden');\r\n\r\n        } catch (error) {\r\n            console.error('Forgot password error:', error);\r\n            App.View.showToast(\r\n                error.message || (lang === 'en' ? 'Failed to send reset link' : 'Gagal mengirim link reset'),\r\n                'error'\r\n            );\r\n        } finally {\r\n            // Reset button\r\n            if (submitBtn) {\r\n                submitBtn.innerHTML = originalText;\r\n                submitBtn.disabled = false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Setup profile handlers\r\n */\r\nconst setupProfileHandlers = () => {\r\n    let logoutBtn = document.getElementById('logout-btn');\r\n    let themeToggle = document.getElementById('profile-theme-toggle');\r\n    const langBtns = document.querySelectorAll('.profile-lang-btn');\r\n\r\n    // Clone buttons to remove all previous event listeners (prevent duplicate handlers)\r\n    if (logoutBtn) {\r\n        const logoutBtnClone = logoutBtn.cloneNode(true);\r\n        logoutBtn.replaceWith(logoutBtnClone);\r\n        logoutBtn = logoutBtnClone;\r\n    }\r\n    if (themeToggle) {\r\n        const themeToggleClone = themeToggle.cloneNode(true);\r\n        themeToggle.replaceWith(themeToggleClone);\r\n        themeToggle = themeToggleClone;\r\n    }\r\n\r\n    logoutBtn?.addEventListener('click', () => {\r\n        App.Presenter.handleLogout();\r\n    });\r\n\r\n    themeToggle?.addEventListener('click', () => {\r\n        App.Model.toggleTheme();\r\n        const dot = themeToggle.querySelector('span');\r\n        const isDark = App.Model.getState('theme') === 'dark';\r\n        dot?.classList.toggle('translate-x-6', isDark);\r\n        dot?.classList.toggle('bg-primary', isDark);\r\n        themeToggle.classList.toggle('bg-primary/30', isDark);\r\n    });\r\n\r\n    langBtns.forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            const lang = btn.dataset.lang;\r\n            App.Model.setLanguage(lang);\r\n            // Re-render profile page to apply translations\r\n            Router.handleRouteChange();\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * Setup AI Chat handlers\r\n */\r\nconst setupChatHandlers = () => {\r\n    const chatInput = document.getElementById('chat-input');\r\n    const sendBtn = document.getElementById('send-btn');\r\n    const messagesContainer = document.getElementById('chat-messages');\r\n    const suggestedPrompts = document.querySelectorAll('.suggested-prompt');\r\n\r\n    // Function to add a message to chat\r\n    const addMessage = (content, isUser = false) => {\r\n        const time = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });\r\n\r\n        const messageHTML = isUser ? `\r\n            <div class=\"flex items-start gap-3 justify-end\">\r\n                <div class=\"flex-1 max-w-[85%] flex flex-col items-end\">\r\n                    <div class=\"bg-primary text-primary-foreground rounded-2xl rounded-br-sm p-4\">\r\n                        <p>${content}</p>\r\n                    </div>\r\n                    <span class=\"text-xs text-muted-foreground mt-1\">${time}</span>\r\n                </div>\r\n                <div class=\"w-10 h-10 rounded-lg bg-secondary flex items-center justify-center flex-shrink-0\">\r\n                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n        ` : `\r\n            <div class=\"flex items-start gap-3\">\r\n                <div class=\"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0\">\r\n                    <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                    </svg>\r\n                </div>\r\n                <div class=\"flex-1 max-w-[85%]\">\r\n                    <div class=\"bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4\">\r\n                        <p class=\"text-foreground\">${content}</p>\r\n                    </div>\r\n                    <span class=\"text-xs text-muted-foreground mt-1 block\">${time}</span>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        messagesContainer?.insertAdjacentHTML('beforeend', messageHTML);\r\n\r\n        // Auto-scroll to bottom\r\n        if (messagesContainer) {\r\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\r\n        }\r\n    };\r\n\r\n    // Function to send message\r\n    const sendMessage = () => {\r\n        const message = chatInput?.value?.trim();\r\n        if (!message) return;\r\n\r\n        // Add user message\r\n        addMessage(message, true);\r\n\r\n        // Clear input\r\n        if (chatInput) chatInput.value = '';\r\n\r\n        // Simulate AI response (in real app, this would call an API)\r\n        setTimeout(() => {\r\n            const responses = [\r\n                \"Based on current weather conditions and fleet status, I recommend adjusting the mining schedule to avoid peak rainfall hours.\",\r\n                \"I've analyzed your query. The current conditions suggest optimal production can be achieved by reallocating 3 vehicles from Site A to Site B.\",\r\n                \"According to the latest data, shipping delays are expected to be minimal today. I recommend proceeding with the scheduled departures.\",\r\n                \"I've processed your request. The AI analysis indicates that maintenance should be scheduled during low-activity periods to minimize operational impact.\"\r\n            ];\r\n            const randomResponse = responses[Math.floor(Math.random() * responses.length)];\r\n            addMessage(randomResponse, false);\r\n        }, 1000);\r\n    };\r\n\r\n    // Send button click\r\n    sendBtn?.addEventListener('click', sendMessage);\r\n\r\n    // Enter key to send\r\n    chatInput?.addEventListener('keydown', (e) => {\r\n        if (e.key === 'Enter' && !e.shiftKey) {\r\n            e.preventDefault();\r\n            sendMessage();\r\n        }\r\n    });\r\n\r\n    // Suggested prompts click\r\n    suggestedPrompts.forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            const promptText = btn.textContent?.trim();\r\n            if (chatInput && promptText) {\r\n                chatInput.value = promptText;\r\n                chatInput.focus();\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * About page handler - generic page renderer\r\n */\r\nexport const aboutPage = async (params) => {\r\n    const route = Router.getCurrentRoute();\r\n    const template = templates[route] || templates.planning;\r\n\r\n    await App.View.render(typeof template === 'function' ? template() : template, route);\r\n\r\n    // Setup handlers based on route\r\n    if (route === 'auth') {\r\n        setupAuthHandlers();\r\n    } else if (route === 'profile') {\r\n        setupProfileHandlers();\r\n    } else if (route === 'ai-tools') {\r\n        setupChatHandlers();\r\n    }\r\n};\r\n","/**\r\n * OptiMine SPA - AI Tools Page Component\r\n * Chatbot interface integrated with n8n AI\r\n */\r\n\r\nimport { API } from '../../data/api.js';\r\nimport { LanguageManager } from '../../utils/LanguageManager.js';\r\nimport { App } from '../../app.js';\r\n\r\nconst template = () => {\r\n    const t = (key) => LanguageManager.t(key);\r\n\r\n    return `\r\n            <div class=\"min-h-screen bg-background\">\r\n                <!-- AI Tools Content -->\r\n                <div class=\"container mx-auto px-4 py-8\">\r\n                    <div class=\"max-w-4xl mx-auto\">\r\n                        <h1 class=\"text-3xl font-bold mb-2\">Asisten AI</h1>\r\n                        <p class=\"text-muted-foreground mb-8\">\r\n                            Ajukan pertanyaan tentang kondisi lapangan dan dapatkan rekomendasi AI\r\n                        </p>\r\n\r\n                        <!-- Chat Container -->\r\n                        <div class=\"bg-card border border-border rounded-xl overflow-hidden\">\r\n                            <!-- Chat Messages -->\r\n                            <div id=\"chat-messages\" class=\"h-[500px] overflow-y-auto p-6 space-y-4\">\r\n                                <!-- Welcome Message -->\r\n                                <div class=\"flex items-start gap-3\">\r\n                                    <div class=\"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0\">\r\n                                        <svg class=\"w-6 h-6 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                        </svg>\r\n                                    </div>\r\n                                    <div class=\"flex-1\">\r\n                                        <div class=\"bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4\">\r\n                                            <p class=\"text-sm\">Halo! Saya Asisten AI Operasi Tambang Anda. Bagaimana saya bisa membantu mengoptimalkan operasi Anda hari ini?</p>\r\n                                        </div>\r\n                                        <span class=\"text-xs text-muted-foreground mt-1 block\">${new Date().toLocaleTimeString('id-ID', { hour: 'numeric', minute: '2-digit' })}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <!-- Typing Indicator (hidden by default) -->\r\n                            <div id=\"typing-indicator\" class=\"hidden px-6 pb-4\">\r\n                                <div class=\"flex items-center gap-2 text-muted-foreground text-sm\">\r\n                                    <div class=\"flex gap-1\">\r\n                                        <span class=\"w-2 h-2 bg-primary rounded-full animate-bounce\" style=\"animation-delay: 0s\"></span>\r\n                                        <span class=\"w-2 h-2 bg-primary rounded-full animate-bounce\" style=\"animation-delay: 0.2s\"></span>\r\n                                        <span class=\"w-2 h-2 bg-primary rounded-full animate-bounce\" style=\"animation-delay: 0.4s\"></span>\r\n                                    </div>\r\n                                    <span>AI sedang mengetik...</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <!-- Input Area -->\r\n                            <div class=\"border-t border-border p-4 bg-background/50\">\r\n                                <form id=\"chat-form\" class=\"flex gap-2\">\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        id=\"chat-input\"\r\n                                        class=\"flex-1 px-4 py-3 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary\"\r\n                                        placeholder=\"Tanyakan tentang dampak cuaca, optimasi armada, atau perencanaan produksi...\"\r\n                                        autocomplete=\"off\"\r\n                                    />\r\n                                    <button\r\n                                        type=\"submit\"\r\n                                        id=\"send-btn\"\r\n                                        class=\"px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                        disabled\r\n                                    >\r\n                                        <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\r\n                                        </svg>\r\n                                    </button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- Status Indicator -->\r\n                        <div class=\"mt-4 flex items-center justify-center gap-2 text-sm\">\r\n                            <span class=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></span>\r\n                            <span class=\"text-muted-foreground\">AI Online - Terhubung ke AI Service</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n};\r\n\r\nconst afterRender = () => {\r\n    console.log(' AI Tools Page - Initializing...');\r\n\r\n    const chatMessages = document.getElementById('chat-messages');\r\n    const chatForm = document.getElementById('chat-form');\r\n    const chatInput = document.getElementById('chat-input');\r\n    const sendBtn = document.getElementById('send-btn');\r\n    const typingIndicator = document.getElementById('typing-indicator');\r\n\r\n    // Enable/disable send button based on input\r\n    chatInput.addEventListener('input', () => {\r\n        sendBtn.disabled = !chatInput.value.trim();\r\n    });\r\n\r\n    // Handle form submit\r\n    chatForm.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const message = chatInput.value.trim();\r\n\r\n        if (!message) return;\r\n\r\n        // Add user message\r\n        addMessage(message, 'user');\r\n\r\n        // Clear input\r\n        chatInput.value = '';\r\n        sendBtn.disabled = true;\r\n\r\n        // Show typing indicator\r\n        typingIndicator.classList.remove('hidden');\r\n        scrollToBottom();\r\n\r\n        try {\r\n            // Send to n8n via API\r\n            const response = await API.ai.chat(message);\r\n\r\n            // Hide typing indicator\r\n            typingIndicator.classList.add('hidden');\r\n\r\n            // Add AI response\r\n            if (response.success && response.data.response) {\r\n                addMessage(response.data.response, 'ai');\r\n            } else {\r\n                addMessage('Maaf, terjadi kesalahan. Silakan coba lagi.', 'ai');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sending message:', error);\r\n            typingIndicator.classList.add('hidden');\r\n            addMessage('Maaf, saya tidak dapat terhubung ke AI server. Silakan coba lagi nanti.', 'ai');\r\n        }\r\n    });\r\n\r\n    // Focus input\r\n    chatInput.focus();\r\n\r\n    // Helper functions\r\n    function addMessage(content, type) {\r\n        const timestamp = new Date().toLocaleTimeString('id-ID', { hour: 'numeric', minute: '2-digit' });\r\n        const messageEl = document.createElement('div');\r\n        messageEl.className = 'flex items-start gap-3 animate-fade-in';\r\n\r\n        if (type === 'ai') {\r\n            messageEl.innerHTML = `\r\n                    <div class=\"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0\">\r\n                        <svg class=\"w-6 h-6 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <div class=\"flex-1\">\r\n                        <div class=\"bg-secondary/50 border border-border rounded-2xl rounded-bl-sm p-4\">\r\n                            <p class=\"text-sm whitespace-pre-wrap\">${escapeHtml(content)}</p>\r\n                        </div>\r\n                        <span class=\"text-xs text-muted-foreground mt-1 block\">${timestamp}</span>\r\n                    </div>\r\n                `;\r\n        } else {\r\n            messageEl.innerHTML = `\r\n                    <div class=\"flex-1\"></div>\r\n                    <div class=\"flex-shrink-0 max-w-[70%]\">\r\n                        <div class=\"bg-primary text-white rounded-2xl rounded-br-sm p-4\">\r\n                            <p class=\"text-sm whitespace-pre-wrap\">${escapeHtml(content)}</p>\r\n                        </div>\r\n                        <span class=\"text-xs text-muted-foreground mt-1 block text-right\">${timestamp}</span>\r\n                    </div>\r\n                    <div class=\"w-10 h-10 rounded-lg bg-primary flex items-center justify-center flex-shrink-0\">\r\n                        <svg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                        </svg>\r\n                    </div>\r\n                `;\r\n        }\r\n\r\n        chatMessages.appendChild(messageEl);\r\n        scrollToBottom();\r\n    }\r\n\r\n    function scrollToBottom() {\r\n        chatMessages.scrollTop = chatMessages.scrollHeight;\r\n    }\r\n\r\n    function escapeHtml(text) {\r\n        const div = document.createElement('div');\r\n        div.textContent = text;\r\n        return div.innerHTML;\r\n    }\r\n\r\n    console.log(' AI Tools Page - Ready!');\r\n};\r\n\r\nexport const aiToolsPage = async () => {\r\n    console.log(' AI Tools Page - Loading...');\r\n    await App.View.render(template(), 'ai-tools');\r\n    console.log(' AI Tools Page - Rendered, initializing...');\r\n    afterRender();\r\n};\r\n","/**\r\n * OptiMine SPA - Planning Page\r\n * Production Planning with AI-powered optimization\r\n */\r\n\r\nimport { App } from '../../app.js';\r\n\r\n// ========================================\r\n// API Configuration\r\n// ========================================\r\n// Always use VPS Backend URL\r\nconst API_BASE_URL = 'http://139.59.224.58:5000';\r\nconst PLAN_API_URL = `${API_BASE_URL}/ai/plan`;\r\nconst SHIPPING_API_URL = `${API_BASE_URL}/shipping-schedules`;\r\n\r\n// ========================================\r\n// Helper: Get User Role from LocalStorage\r\n// ========================================\r\nfunction getUserRole() {\r\n    try {\r\n        const user = JSON.parse(localStorage.getItem('optimine-user') || '{}');\r\n        return user.role || 'shipping_planner'; // default to shipping_planner\r\n    } catch {\r\n        return 'shipping_planner';\r\n    }\r\n}\r\n\r\n// ========================================\r\n// Planning Page State\r\n// ========================================\r\nconst PlanningState = {\r\n    rainfall_mm: 0.5,\r\n    wind_speed_kmh: 0.4,\r\n    // Shipping Planner fields\r\n    activeVehicles: 25,\r\n    maintenanceStatus: 3,\r\n    totalFleet: 40,\r\n    vessels: [],\r\n    // Mining Planner fields\r\n    excavatorActive: 8,\r\n    dumpTruckActive: 15,\r\n    miningMaintenanceStatus: 2,\r\n    selectedShift: 'pagi',\r\n    // Common\r\n    isLoading: false,\r\n    result: null\r\n};\r\n\r\n// ========================================\r\n// Loading Steps\r\n// ========================================\r\nconst loadingSteps = [\r\n    { icon: '', text: 'Mengirim data telemetri ke Server...', duration: 2000 },\r\n    { icon: '', text: 'Menganalisis dampak cuaca & gelombang...', duration: 2000 },\r\n    { icon: '', text: 'AI menyusun strategi optimal...', duration: null }\r\n];\r\n\r\n/**\r\n * Planning Page Handler\r\n */\r\nexport const planningPage = async (params) => {\r\n    const content = getPlanningTemplate();\r\n    await App.View.render(content, 'planning');\r\n\r\n    // Initialize after render\r\n    setTimeout(() => {\r\n        initPlanningPage();\r\n    }, 100);\r\n};\r\n\r\n/**\r\n * Get Planning Page Template\r\n */\r\nfunction getPlanningTemplate() {\r\n    const role = getUserRole();\r\n    const isMiningPlanner = role === 'mining_planner';\r\n\r\n    return `\r\n        <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n            <!-- Page Header -->\r\n            <section id=\"page-header\" class=\"mb-8 animate-fade-in\">\r\n                <h1 class=\"font-heading text-3xl md:text-4xl font-bold text-foreground mb-2\">\r\n                    ${isMiningPlanner ? 'Perencanaan Tambang' : 'Perencanaan Produksi'}\r\n                </h1>\r\n                <p class=\"text-muted-foreground\">\r\n                    ${isMiningPlanner\r\n            ? 'Masukkan kondisi operasional tambang untuk menghasilkan rencana yang dioptimalkan'\r\n            : 'Masukkan kondisi operasional untuk menghasilkan rencana yang dioptimalkan'}\r\n                </p>\r\n                <div class=\"mt-2 inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium ${isMiningPlanner ? 'bg-amber-500/20 text-amber-400' : 'bg-cyan-500/20 text-cyan-400'}\">\r\n                    <span class=\"w-2 h-2 rounded-full ${isMiningPlanner ? 'bg-amber-400' : 'bg-cyan-400'}\"></span>\r\n                    ${isMiningPlanner ? 'Mining Planner' : 'Shipping Planner'}\r\n                </div>\r\n            </section>\r\n\r\n            <!-- Main Grid Layout -->\r\n            <div class=\"grid lg:grid-cols-3 gap-6\">\r\n                <!-- Input Section (2/3 width) -->\r\n                <div class=\"lg:col-span-2 space-y-6\">\r\n                    <!-- Weather Conditions Card (Same for both roles) -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in\" style=\"animation-delay: 0.1s;\">\r\n                        <div class=\"flex items-center gap-3 mb-6\">\r\n                            <div class=\"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center\">\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <h2 class=\"font-heading font-semibold text-lg text-foreground\">Kondisi Cuaca</h2>\r\n                        </div>\r\n\r\n                        <!-- Rainfall Slider -->\r\n                        <div class=\"mb-6\">\r\n                            <div class=\"flex justify-between items-center mb-3\">\r\n                                <label class=\"block text-sm text-muted-foreground\">Curah Hujan</label>\r\n                                <span id=\"rainfall-value\" class=\"text-sm font-medium text-primary\">0.5 mm</span>\r\n                            </div>\r\n                            <div class=\"slider-container\">\r\n                                <input type=\"range\" id=\"rainfall-slider\" class=\"slider-primary w-full\" min=\"0\" max=\"50\" step=\"0.1\" value=\"0.5\">\r\n                                <div class=\"flex justify-between text-xs text-muted-foreground mt-2\">\r\n                                    <span>0 mm</span>\r\n                                    <span>50 mm</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- Wind Speed Slider -->\r\n                        <div>\r\n                            <div class=\"flex justify-between items-center mb-3\">\r\n                                <label class=\"block text-sm text-muted-foreground\">Kecepatan Angin</label>\r\n                                <span id=\"wind-value\" class=\"text-sm font-medium text-primary\">0.4 km/h</span>\r\n                            </div>\r\n                            <div class=\"slider-container\">\r\n                                <input type=\"range\" id=\"wave-slider\" class=\"slider-primary w-full\" min=\"0\" max=\"10\" step=\"0.1\" value=\"0.4\">\r\n                                <div class=\"flex justify-between text-xs text-muted-foreground mt-2\">\r\n                                    <span>0 km/h</span>\r\n                                    <span>10 km/h</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Fleet/Equipment Status Card (Role-based) -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in\" style=\"animation-delay: 0.2s;\">\r\n                        <div class=\"flex items-center gap-3 mb-6\">\r\n                            <div class=\"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center\">\r\n                                ${isMiningPlanner ? `\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z\" />\r\n                                </svg>\r\n                                ` : `\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4\" />\r\n                                </svg>\r\n                                `}\r\n                            </div>\r\n                            <h2 class=\"font-heading font-semibold text-lg text-foreground\">\r\n                                ${isMiningPlanner ? 'Status Peralatan Tambang' : 'Status Armada'}\r\n                            </h2>\r\n                        </div>\r\n\r\n                        ${isMiningPlanner ? `\r\n                        <!-- Mining Planner: Equipment Status -->\r\n                        <div class=\"grid sm:grid-cols-3 gap-4\">\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Excavator Aktif</label>\r\n                                <input type=\"number\" id=\"excavator-active\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"8\" min=\"0\">\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Dump Truck Aktif</label>\r\n                                <input type=\"number\" id=\"dump-truck-active\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"15\" min=\"0\">\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Status Perawatan</label>\r\n                                <input type=\"number\" id=\"mining-maintenance-status\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"2\" min=\"0\">\r\n                            </div>\r\n                        </div>\r\n                        ` : `\r\n                        <!-- Shipping Planner: Fleet Status -->\r\n                        <div class=\"grid sm:grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Kendaraan Aktif</label>\r\n                                <input type=\"number\" id=\"active-vehicles\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"25\" min=\"0\">\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Status Perawatan</label>\r\n                                <input type=\"number\" id=\"maintenance-status\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"3\" min=\"0\">\r\n                            </div>\r\n                        </div>\r\n                        `}\r\n                    </div>\r\n\r\n                    <!-- Schedule Card (Role-based) -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in\" style=\"animation-delay: 0.3s;\">\r\n                        <div class=\"flex items-center gap-3 mb-6\">\r\n                            <div class=\"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center\">\r\n                                ${isMiningPlanner ? `\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                                </svg>\r\n                                ` : `\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\r\n                                </svg>\r\n                                `}\r\n                            </div>\r\n                            <h2 class=\"font-heading font-semibold text-lg text-foreground\">\r\n                                ${isMiningPlanner ? 'Jadwal Produksi' : 'Jadwal Kapal'}\r\n                            </h2>\r\n                        </div>\r\n\r\n                        ${isMiningPlanner ? `\r\n                        <!-- Mining Planner: Production Schedule -->\r\n                        <div class=\"space-y-4\">\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-3\">Pilih Shift Produksi</label>\r\n                                <div class=\"grid grid-cols-3 gap-3\">\r\n                                    <button type=\"button\" id=\"shift-pagi\" class=\"shift-btn active p-4 bg-primary/20 border-2 border-primary rounded-lg text-center transition-all hover:bg-primary/30\" data-shift=\"pagi\">\r\n                                        <div class=\"text-2xl mb-1\"></div>\r\n                                        <div class=\"text-sm font-medium text-foreground\">Pagi</div>\r\n                                        <div class=\"text-xs text-muted-foreground\">06:00 - 14:00</div>\r\n                                    </button>\r\n                                    <button type=\"button\" id=\"shift-siang\" class=\"shift-btn p-4 bg-secondary/50 border-2 border-border rounded-lg text-center transition-all hover:bg-secondary\" data-shift=\"siang\">\r\n                                        <div class=\"text-2xl mb-1\"></div>\r\n                                        <div class=\"text-sm font-medium text-foreground\">Siang</div>\r\n                                        <div class=\"text-xs text-muted-foreground\">14:00 - 22:00</div>\r\n                                    </button>\r\n                                    <button type=\"button\" id=\"shift-malam\" class=\"shift-btn p-4 bg-secondary/50 border-2 border-border rounded-lg text-center transition-all hover:bg-secondary\" data-shift=\"malam\">\r\n                                        <div class=\"text-2xl mb-1\"></div>\r\n                                        <div class=\"text-sm font-medium text-foreground\">Malam</div>\r\n                                        <div class=\"text-xs text-muted-foreground\">22:00 - 06:00</div>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <label class=\"block text-sm text-muted-foreground mb-2\">Target Produksi Harian (ton)</label>\r\n                                <input type=\"number\" id=\"target-production\" class=\"w-full px-4 py-3 bg-secondary/50 border border-border rounded-lg text-foreground focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors\" value=\"5000\" min=\"0\" step=\"100\">\r\n                            </div>\r\n                        </div>\r\n                        ` : `\r\n                        <!-- Shipping Planner: Vessel Schedule -->\r\n                        <div id=\"vessels-container\" class=\"space-y-3\">\r\n                            <div class=\"flex items-center justify-center p-4 text-muted-foreground text-sm\">\r\n                                <svg class=\"w-5 h-5 animate-spin mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                                </svg>\r\n                                Memuat jadwal kapal...\r\n                            </div>\r\n                        </div>\r\n                        `}\r\n                    </div>\r\n\r\n                    <!-- Generate Button -->\r\n                    <button id=\"generate-btn\" class=\"w-full h-14 bg-primary hover:bg-primary/90 text-white font-medium rounded-xl flex items-center justify-center gap-2 glow-hover transition-all duration-300 animate-fade-in\" style=\"animation-delay: 0.4s;\">\r\n                        <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z\" />\r\n                        </svg>\r\n                        <span>Hasilkan Rencana Optimal</span>\r\n                    </button>\r\n\r\n                    <!-- Loading Container (Hidden by default) -->\r\n                    <div id=\"loading-container\" class=\"hidden w-full\">\r\n                        <div class=\"glass border border-border rounded-xl p-8 animate-fade-in\">\r\n                            <div class=\"flex flex-col items-center justify-center gap-4\">\r\n                                <div class=\"relative\">\r\n                                    <div class=\"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center\">\r\n                                        <span id=\"loading-icon\" class=\"text-3xl\"></span>\r\n                                    </div>\r\n                                    <div class=\"absolute inset-0 w-16 h-16 rounded-full border-4 border-primary/30 border-t-primary animate-spin\"></div>\r\n                                </div>\r\n                                <p id=\"loading-text\" class=\"text-lg font-medium text-foreground text-center\">\r\n                                    Mengirim data telemetri ke Server...\r\n                                </p>\r\n                                <div class=\"flex gap-2 mt-2\">\r\n                                    <div class=\"w-2 h-2 rounded-full bg-primary animate-pulse\" style=\"animation-delay: 0ms;\"></div>\r\n                                    <div class=\"w-2 h-2 rounded-full bg-primary animate-pulse\" style=\"animation-delay: 200ms;\"></div>\r\n                                    <div class=\"w-2 h-2 rounded-full bg-primary animate-pulse\" style=\"animation-delay: 400ms;\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Result Dashboard (Hidden by default) -->\r\n                    <div id=\"result-dashboard\" class=\"hidden w-full space-y-6 animate-fade-in\">\r\n                        <div class=\"flex items-center justify-between flex-wrap gap-4\">\r\n                            <div class=\"flex items-center gap-3\">\r\n                                <div class=\"w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-cyan-500 flex items-center justify-center\">\r\n                                    <svg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <div>\r\n                                    <h2 class=\"font-heading font-bold text-xl text-foreground\">Rencana Optimasi Operasional</h2>\r\n                                    <p id=\"result-timestamp\" class=\"text-sm text-muted-foreground\"></p>\r\n                                </div>\r\n                            </div>\r\n                            <button id=\"new-plan-btn\" class=\"px-4 py-2 text-sm font-medium text-primary hover:bg-primary/10 rounded-lg transition-colors flex items-center gap-2\">\r\n                                <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n                                </svg>\r\n                                Buat Rencana Baru\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"grid sm:grid-cols-3 gap-4\" id=\"metrics-grid\"></div>\r\n                        <div id=\"recommendations-container\" class=\"space-y-4\"></div>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- Status Panel (1/3 width) -->\r\n                <div class=\"space-y-6\">\r\n                    <!-- System Status Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 border-glow animate-fade-in\" style=\"animation-delay: 0.2s;\">\r\n                        <div class=\"flex items-center gap-3 mb-6\">\r\n                            <div class=\"w-8 h-8 rounded-lg bg-primary/20 flex items-center justify-center\">\r\n                                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <h2 class=\"font-heading font-semibold text-lg text-foreground\">Status Sistem</h2>\r\n                        </div>\r\n\r\n                        <div class=\"space-y-3\">\r\n                            <div class=\"p-3 rounded-lg bg-emerald-500/10 border border-emerald-500/20\">\r\n                                <div class=\"flex items-center gap-3\">\r\n                                    <span class=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse\"></span>\r\n                                    <span class=\"text-sm text-emerald-400 font-medium\">Sistem AI Online</span>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"p-3 rounded-lg bg-primary/10 border border-primary/20\">\r\n                                <div class=\"flex items-center gap-3\">\r\n                                    <span class=\"w-2 h-2 rounded-full bg-primary\"></span>\r\n                                    <span class=\"text-sm text-primary font-medium\">Integrasi RAG Siap</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Active Alerts Card -->\r\n                    <div class=\"glass border border-border rounded-xl p-6 animate-fade-in\" style=\"animation-delay: 0.3s;\">\r\n                        <div class=\"flex items-center gap-3 mb-6\">\r\n                            <div class=\"w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center\">\r\n                                <svg class=\"w-5 h-5 text-yellow-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <h2 class=\"font-heading font-semibold text-lg text-foreground\">Peringatan Aktif</h2>\r\n                        </div>\r\n\r\n                        <div class=\"space-y-3\">\r\n                            <div class=\"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20\">\r\n                                <span class=\"text-sm text-yellow-400\">Curah hujan tinggi diperkirakan di Lokasi Tambang B</span>\r\n                            </div>\r\n                            <div class=\"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20\">\r\n                                <span class=\"text-sm text-orange-400\">2 kendaraan dijadwalkan untuk perawatan</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Initialize Planning Page\r\n */\r\nfunction initPlanningPage() {\r\n    const role = getUserRole();\r\n    const isMiningPlanner = role === 'mining_planner';\r\n\r\n    setupSliders();\r\n    setupInputs();\r\n    setupGenerateButton();\r\n\r\n    if (isMiningPlanner) {\r\n        setupMiningInputs();\r\n    } else {\r\n        loadVessels();\r\n    }\r\n}\r\n\r\n/**\r\n * Setup Sliders\r\n */\r\nfunction setupSliders() {\r\n    const rainfallSlider = document.getElementById('rainfall-slider');\r\n    const waveSlider = document.getElementById('wave-slider');\r\n\r\n    if (rainfallSlider) {\r\n        rainfallSlider.addEventListener('input', (e) => {\r\n            PlanningState.rainfall_mm = parseFloat(e.target.value);\r\n            updateSliderValueDisplays();\r\n        });\r\n    }\r\n\r\n    if (waveSlider) {\r\n        waveSlider.addEventListener('input', (e) => {\r\n            PlanningState.wind_speed_kmh = parseFloat(e.target.value);\r\n            updateSliderValueDisplays();\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Update Slider Value Displays\r\n */\r\nfunction updateSliderValueDisplays() {\r\n    const rainfallValue = document.getElementById('rainfall-value');\r\n    const windValue = document.getElementById('wind-value');\r\n\r\n    if (rainfallValue) {\r\n        rainfallValue.textContent = `${PlanningState.rainfall_mm.toFixed(1)} mm`;\r\n    }\r\n    if (windValue) {\r\n        windValue.textContent = `${PlanningState.wind_speed_kmh.toFixed(1)} km/h`;\r\n    }\r\n}\r\n\r\n/**\r\n * Setup Inputs (Shipping Planner)\r\n */\r\nfunction setupInputs() {\r\n    const activeVehiclesInput = document.getElementById('active-vehicles');\r\n    const maintenanceInput = document.getElementById('maintenance-status');\r\n\r\n    if (activeVehiclesInput) {\r\n        activeVehiclesInput.addEventListener('change', (e) => {\r\n            PlanningState.activeVehicles = parseInt(e.target.value) || 0;\r\n        });\r\n    }\r\n\r\n    if (maintenanceInput) {\r\n        maintenanceInput.addEventListener('change', (e) => {\r\n            PlanningState.maintenanceStatus = parseInt(e.target.value) || 0;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Setup Mining Inputs (Mining Planner)\r\n */\r\nfunction setupMiningInputs() {\r\n    const excavatorInput = document.getElementById('excavator-active');\r\n    const dumpTruckInput = document.getElementById('dump-truck-active');\r\n    const miningMaintenanceInput = document.getElementById('mining-maintenance-status');\r\n    const targetProductionInput = document.getElementById('target-production');\r\n    const shiftButtons = document.querySelectorAll('.shift-btn');\r\n\r\n    if (excavatorInput) {\r\n        excavatorInput.addEventListener('change', (e) => {\r\n            PlanningState.excavatorActive = parseInt(e.target.value) || 0;\r\n        });\r\n    }\r\n\r\n    if (dumpTruckInput) {\r\n        dumpTruckInput.addEventListener('change', (e) => {\r\n            PlanningState.dumpTruckActive = parseInt(e.target.value) || 0;\r\n        });\r\n    }\r\n\r\n    if (miningMaintenanceInput) {\r\n        miningMaintenanceInput.addEventListener('change', (e) => {\r\n            PlanningState.miningMaintenanceStatus = parseInt(e.target.value) || 0;\r\n        });\r\n    }\r\n\r\n    if (targetProductionInput) {\r\n        targetProductionInput.addEventListener('change', (e) => {\r\n            PlanningState.targetProduction = parseInt(e.target.value) || 5000;\r\n        });\r\n    }\r\n\r\n    // Shift button selection\r\n    shiftButtons.forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            // Remove active state from all buttons\r\n            shiftButtons.forEach(b => {\r\n                b.classList.remove('active', 'bg-primary/20', 'border-primary');\r\n                b.classList.add('bg-secondary/50', 'border-border');\r\n            });\r\n            // Add active state to clicked button\r\n            btn.classList.add('active', 'bg-primary/20', 'border-primary');\r\n            btn.classList.remove('bg-secondary/50', 'border-border');\r\n            PlanningState.selectedShift = btn.dataset.shift;\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Setup Generate Button\r\n */\r\nfunction setupGenerateButton() {\r\n    const generateBtn = document.getElementById('generate-btn');\r\n    const newPlanBtn = document.getElementById('new-plan-btn');\r\n\r\n    if (generateBtn) {\r\n        generateBtn.addEventListener('click', () => generateOptimizationPlan());\r\n    }\r\n\r\n    if (newPlanBtn) {\r\n        newPlanBtn.addEventListener('click', () => resetToInput());\r\n    }\r\n}\r\n\r\n/**\r\n * Load Vessels from API\r\n */\r\nasync function loadVessels() {\r\n    const container = document.getElementById('vessels-container');\r\n    if (!container) return;\r\n\r\n    try {\r\n        const token = localStorage.getItem('optimine-token');\r\n        const headers = { 'Content-Type': 'application/json' };\r\n        if (token) headers['Authorization'] = `Bearer ${token}`;\r\n\r\n        const response = await fetch(`${SHIPPING_API_URL}?limit=5`, { headers });\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`HTTP ${response.status}`);\r\n        }\r\n\r\n        const result = await response.json();\r\n        const schedules = result.data || [];\r\n\r\n        if (schedules.length === 0) {\r\n            renderDefaultVessels(container);\r\n            return;\r\n        }\r\n\r\n        PlanningState.vessels = schedules.map(s => ({\r\n            id: s.shipment_id,\r\n            name: s.vessel_name,\r\n            etd: s.etd,\r\n            status: s.status,\r\n            destination: s.destination_port,\r\n            tonnage: s.coal_tonnage\r\n        }));\r\n\r\n        renderVessels(container, schedules);\r\n\r\n    } catch (error) {\r\n        console.warn('Failed to load vessels, using defaults:', error.message);\r\n        renderDefaultVessels(container);\r\n    }\r\n}\r\n\r\n/**\r\n * Render Vessels\r\n */\r\nfunction renderVessels(container, schedules) {\r\n    container.innerHTML = schedules.map(s => {\r\n        const etdDate = s.etd ? new Date(s.etd) : null;\r\n        const timeStr = etdDate ? etdDate.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }) : '-';\r\n        const statusClass = s.status?.toLowerCase() === 'scheduled' || s.status?.toLowerCase() === 'loading'\r\n            ? 'bg-primary/20 text-primary'\r\n            : 'bg-emerald-500/20 text-emerald-400';\r\n        const statusText = s.status || 'Scheduled';\r\n\r\n        return `\r\n            <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border\">\r\n                <div class=\"flex-1\">\r\n                    <span class=\"text-sm font-medium text-foreground\">${s.vessel_name || 'Unknown Vessel'}</span>\r\n                    <span class=\"text-xs text-muted-foreground ml-2\">ETD: ${timeStr}</span>\r\n                </div>\r\n                <div class=\"flex items-center gap-2\">\r\n                    <span class=\"text-xs text-muted-foreground\">${s.coal_tonnage?.toLocaleString() || '-'} ton</span>\r\n                    <span class=\"px-2 py-1 text-xs font-medium ${statusClass} rounded\">${statusText}</span>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }).join('');\r\n}\r\n\r\n/**\r\n * Render Default Vessels\r\n */\r\nfunction renderDefaultVessels(container) {\r\n    PlanningState.vessels = [\r\n        { id: 'A', name: 'MV Samudera Jaya', time: '08:00', status: 'Scheduled' },\r\n        { id: 'B', name: 'MV Nusantara', time: '14:00', status: 'Loading' },\r\n        { id: 'C', name: 'MV Bahari Indah', time: '20:00', status: 'Scheduled' }\r\n    ];\r\n\r\n    container.innerHTML = PlanningState.vessels.map(v => `\r\n        <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border\">\r\n            <span class=\"text-sm text-foreground\">${v.name} - ${v.time}</span>\r\n            <span class=\"px-2 py-1 text-xs font-medium bg-primary/20 text-primary rounded\">${v.status}</span>\r\n        </div>\r\n    `).join('');\r\n}\r\n\r\n/**\r\n * Generate Optimization Plan\r\n */\r\nasync function generateOptimizationPlan() {\r\n    if (PlanningState.isLoading) return;\r\n\r\n    const generateBtn = document.getElementById('generate-btn');\r\n    const loadingContainer = document.getElementById('loading-container');\r\n    const resultDashboard = document.getElementById('result-dashboard');\r\n\r\n    if (generateBtn) generateBtn.classList.add('hidden');\r\n    if (resultDashboard) resultDashboard.classList.add('hidden');\r\n    if (loadingContainer) loadingContainer.classList.remove('hidden');\r\n\r\n    PlanningState.isLoading = true;\r\n\r\n    const loadingPromise = runLoadingAnimation();\r\n\r\n    try {\r\n        const payload = buildPayload();\r\n        console.log(' Sending payload to AI Plan:', payload);\r\n\r\n        const response = await fetch(PLAN_API_URL, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n            throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n\r\n        const result = await response.json();\r\n        console.log(' AI Plan response:', result);\r\n\r\n        PlanningState.result = result;\r\n        await loadingPromise;\r\n        renderResultDashboard(result);\r\n\r\n        App.View.showToast('Rencana optimasi berhasil dibuat!', 'success');\r\n\r\n    } catch (error) {\r\n        console.error(' Error generating plan:', error);\r\n        console.log(' Menggunakan Demo Mode karena API belum tersedia...');\r\n\r\n        await loadingPromise;\r\n\r\n        const demoResult = generateDemoResult();\r\n        PlanningState.result = demoResult;\r\n        renderResultDashboard(demoResult);\r\n\r\n        App.View.showToast('Demo Mode: Menampilkan contoh hasil', 'info');\r\n    } finally {\r\n        PlanningState.isLoading = false;\r\n    }\r\n}\r\n\r\n/**\r\n * Build Payload for API\r\n */\r\nfunction buildPayload() {\r\n    const role = getUserRole();\r\n    const isMiningPlanner = role === 'mining_planner';\r\n\r\n    const weather_input = {\r\n        rainfall_mm: PlanningState.rainfall_mm,\r\n        wind_speed_kmh: PlanningState.wind_speed_kmh,\r\n        temperature_c: 30,\r\n        humidity_pct: 80\r\n    };\r\n\r\n    let weather_condition = 'Mendung';\r\n    if (PlanningState.rainfall_mm >= 1.0) {\r\n        weather_condition = 'Hujan ringan';\r\n    } else if (PlanningState.rainfall_mm < 0.1) {\r\n        weather_condition = 'Berawan';\r\n    }\r\n\r\n    let road_condition = 'Good';\r\n    if (PlanningState.rainfall_mm >= 1.0) {\r\n        road_condition = 'Poor';\r\n    } else if (PlanningState.rainfall_mm >= 0.3) {\r\n        road_condition = 'Fair';\r\n    }\r\n\r\n    let capacity_input, production_input, additional_context;\r\n\r\n    if (isMiningPlanner) {\r\n        // Mining Planner payload\r\n        const totalEquipment = PlanningState.excavatorActive + PlanningState.dumpTruckActive;\r\n        const availability_pct = (totalEquipment / 30) * 100; // Assuming 30 total equipment capacity\r\n\r\n        capacity_input = {\r\n            availability_pct: parseFloat(availability_pct.toFixed(2)),\r\n            road_condition: road_condition,\r\n            weather_condition: weather_condition,\r\n            mine_id: \"MINE_1\",\r\n            equipment_type: \"Mixed\"\r\n        };\r\n\r\n        production_input = {\r\n            planned_output_ton: PlanningState.targetProduction || 5000\r\n        };\r\n\r\n        const shiftLabels = { pagi: 'Pagi (06:00-14:00)', siang: 'Siang (14:00-22:00)', malam: 'Malam (22:00-06:00)' };\r\n\r\n        additional_context =\r\n            `[Mining Planner] Status cuaca: ${weather_condition}, curah hujan ${PlanningState.rainfall_mm.toFixed(1)}mm, angin ${PlanningState.wind_speed_kmh.toFixed(1)}km/h. ` +\r\n            `Peralatan tambang: ${PlanningState.excavatorActive} Excavator aktif, ${PlanningState.dumpTruckActive} Dump Truck aktif, ${PlanningState.miningMaintenanceStatus} unit dalam perawatan. ` +\r\n            `Kondisi jalan tambang: ${road_condition}. ` +\r\n            `Shift produksi: ${shiftLabels[PlanningState.selectedShift] || 'Pagi'}. ` +\r\n            `Target produksi harian: ${(PlanningState.targetProduction || 5000).toLocaleString()} ton.`;\r\n    } else {\r\n        // Shipping Planner payload\r\n        const availability_pct = (PlanningState.activeVehicles / PlanningState.totalFleet) * 100;\r\n\r\n        capacity_input = {\r\n            availability_pct: parseFloat(availability_pct.toFixed(2)),\r\n            road_condition: road_condition,\r\n            weather_condition: weather_condition,\r\n            mine_id: \"MINE_1\",\r\n            equipment_type: \"Excavator\"\r\n        };\r\n\r\n        production_input = {\r\n            planned_output_ton: 5000\r\n        };\r\n\r\n        const vesselInfo = PlanningState.vessels\r\n            .map(v => v.name ? `${v.name} (${v.status})` : `Vessel ${v.id} - ${v.time} (${v.status})`)\r\n            .join(', ');\r\n\r\n        additional_context =\r\n            `[Shipping Planner] Status cuaca: ${weather_condition}, curah hujan ${PlanningState.rainfall_mm.toFixed(1)}mm, angin ${PlanningState.wind_speed_kmh.toFixed(1)}km/h. ` +\r\n            `Armada: ${PlanningState.activeVehicles} aktif dari ${PlanningState.totalFleet} total, ${PlanningState.maintenanceStatus} dalam perawatan. ` +\r\n            `Kondisi jalan: ${road_condition}. ` +\r\n            `Jadwal kapal: ${vesselInfo || 'Tidak ada data'}.`;\r\n    }\r\n\r\n    return {\r\n        weather_input,\r\n        capacity_input,\r\n        production_input,\r\n        additional_context\r\n    };\r\n}\r\n\r\n/**\r\n * Run Loading Animation\r\n */\r\nasync function runLoadingAnimation() {\r\n    const loadingIcon = document.getElementById('loading-icon');\r\n    const loadingText = document.getElementById('loading-text');\r\n\r\n    for (let i = 0; i < loadingSteps.length - 1; i++) {\r\n        const step = loadingSteps[i];\r\n        if (loadingIcon) loadingIcon.textContent = step.icon;\r\n        if (loadingText) loadingText.textContent = step.text;\r\n        await sleep(step.duration);\r\n    }\r\n\r\n    const finalStep = loadingSteps[loadingSteps.length - 1];\r\n    if (loadingIcon) loadingIcon.textContent = finalStep.icon;\r\n    if (loadingText) loadingText.textContent = finalStep.text;\r\n}\r\n\r\n/**\r\n * Sleep utility\r\n */\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\n/**\r\n * Generate Demo Result\r\n */\r\nfunction generateDemoResult() {\r\n    const role = getUserRole();\r\n    const isMiningPlanner = role === 'mining_planner';\r\n    const weatherClass = getWeatherClassFromRainfall(PlanningState.rainfall_mm);\r\n\r\n    let capacity, narrative;\r\n\r\n    if (isMiningPlanner) {\r\n        const totalEquipment = PlanningState.excavatorActive + PlanningState.dumpTruckActive;\r\n        capacity = Math.round((totalEquipment / 30) * (PlanningState.targetProduction || 5000));\r\n        const shiftLabels = { pagi: 'Pagi', siang: 'Siang', malam: 'Malam' };\r\n\r\n        narrative = `\r\n**Strategi Utama:**\r\nBerdasarkan analisis kondisi cuaca ${weatherClass} dengan curah hujan ${PlanningState.rainfall_mm.toFixed(1)}mm, disarankan untuk mengoptimalkan operasi penambangan pada shift ${shiftLabels[PlanningState.selectedShift] || 'Pagi'} dengan memaksimalkan utilisasi ${PlanningState.excavatorActive} unit Excavator dan ${PlanningState.dumpTruckActive} unit Dump Truck.\r\n\r\n**Risiko Terdeteksi:**\r\n- Curah hujan ${PlanningState.rainfall_mm >= 1.0 ? 'tinggi dapat mempengaruhi stabilitas pit dan kondisi jalan tambang' : 'rendah, kondisi operasional tambang optimal'}\r\n- ${PlanningState.miningMaintenanceStatus} unit peralatan dalam perawatan perlu dijadwalkan kembali beroperasi\r\n- Kecepatan angin ${PlanningState.wind_speed_kmh.toFixed(1)} km/h ${PlanningState.wind_speed_kmh > 5 ? 'perlu perhatian untuk operasi blasting' : 'dalam batas aman untuk semua operasi'}\r\n\r\n**Tindakan Prioritas:**\r\n1. Fokuskan Excavator pada front kerja dengan overburden ratio optimal\r\n2. Koordinasikan Dump Truck untuk meminimalkan cycle time\r\n3. Monitor kondisi pit dan jalan akses secara berkala\r\n4. Target produksi harian: ${(PlanningState.targetProduction || 5000).toLocaleString()} ton\r\n        `.trim();\r\n    } else {\r\n        capacity = Math.round((PlanningState.activeVehicles / PlanningState.totalFleet) * 5000);\r\n\r\n        narrative = `\r\n**Strategi Utama:**\r\nBerdasarkan analisis kondisi cuaca ${weatherClass} dengan curah hujan ${PlanningState.rainfall_mm.toFixed(1)}mm, disarankan untuk mengoptimalkan jadwal operasional pada shift pagi ketika kondisi jalan masih optimal.\r\n\r\n**Risiko Terdeteksi:**\r\n- Curah hujan ${PlanningState.rainfall_mm >= 1.0 ? 'tinggi dapat menurunkan kapasitas hauling sebesar 15-20%' : 'rendah, kondisi operasional normal'}\r\n- ${PlanningState.maintenanceStatus} unit kendaraan dalam perawatan perlu diprioritaskan untuk kembali beroperasi\r\n- Kecepatan angin ${PlanningState.wind_speed_kmh.toFixed(1)} km/h ${PlanningState.wind_speed_kmh > 5 ? 'perlu monitoring untuk keamanan operasi crane' : 'dalam batas aman'}\r\n\r\n**Tindakan Prioritas:**\r\n1. Fokuskan operasi pada ${PlanningState.activeVehicles} unit kendaraan aktif\r\n2. Koordinasi dengan jadwal kapal untuk optimasi loading\r\n3. Monitor kondisi jalan secara berkala terutama area ramp\r\n4. Siapkan contingency plan jika cuaca memburuk\r\n        `.trim();\r\n    }\r\n\r\n    return {\r\n        success: true,\r\n        data: {\r\n            ml_predictions: {\r\n                weather_classification: weatherClass,\r\n                effective_capacity_ton_per_day: capacity,\r\n                confidence_score: 0.87,\r\n                production_forecast: capacity * 0.9\r\n            },\r\n            narrative_recommendation: narrative\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * Get Weather Class from Rainfall\r\n */\r\nfunction getWeatherClassFromRainfall(rainfall) {\r\n    if (rainfall >= 1.0) return 'Hujan ringan';\r\n    if (rainfall >= 0.3) return 'Mendung';\r\n    return 'Berawan';\r\n}\r\n\r\n/**\r\n * Get Weather Icon\r\n */\r\nfunction getWeatherIcon(weatherClass) {\r\n    const lower = weatherClass.toLowerCase();\r\n    if (lower.includes('hujan')) return '';\r\n    if (lower.includes('mendung')) return '';\r\n    return '';\r\n}\r\n\r\n/**\r\n * Render Result Dashboard\r\n */\r\nfunction renderResultDashboard(result) {\r\n    const loadingContainer = document.getElementById('loading-container');\r\n    const resultDashboard = document.getElementById('result-dashboard');\r\n    const generateBtn = document.getElementById('generate-btn');\r\n\r\n    if (loadingContainer) loadingContainer.classList.add('hidden');\r\n    if (generateBtn) generateBtn.classList.add('hidden');\r\n    if (resultDashboard) resultDashboard.classList.remove('hidden');\r\n\r\n    const timestamp = document.getElementById('result-timestamp');\r\n    if (timestamp) {\r\n        const now = new Date();\r\n        timestamp.textContent = `Dibuat pada ${now.toLocaleString('id-ID', {\r\n            day: 'numeric', month: 'long', year: 'numeric',\r\n            hour: '2-digit', minute: '2-digit'\r\n        })}`;\r\n    }\r\n\r\n    renderMetrics(result.data || result);\r\n    renderRecommendations(result.data || result);\r\n}\r\n\r\n/**\r\n * Render Metrics\r\n */\r\nfunction renderMetrics(data) {\r\n    const metricsGrid = document.getElementById('metrics-grid');\r\n    if (!metricsGrid) return;\r\n\r\n    const predictions = data.ml_predictions || {};\r\n\r\n    const weatherClass = predictions.weather_classification ||\r\n        getWeatherClassFromRainfall(PlanningState.rainfall_mm);\r\n    const weatherIcon = getWeatherIcon(weatherClass);\r\n\r\n    const capacity = predictions.effective_capacity_ton_per_day ||\r\n        predictions.capacity_forecast ||\r\n        (PlanningState.activeVehicles * 50);\r\n\r\n    const confidence = predictions.confidence_score ||\r\n        predictions.model_confidence || 0.85;\r\n\r\n    metricsGrid.innerHTML = `\r\n        <div class=\"glass border border-border rounded-xl p-5 transition-all hover:border-primary/50\">\r\n            <div class=\"flex items-center gap-3 mb-3\">\r\n                <span class=\"text-3xl\">${weatherIcon}</span>\r\n                <span class=\"text-sm text-muted-foreground\">Kondisi Cuaca</span>\r\n            </div>\r\n            <p class=\"text-xl font-bold text-foreground\">${weatherClass}</p>\r\n            <p class=\"text-xs text-muted-foreground mt-1\">\r\n                ${PlanningState.rainfall_mm.toFixed(1)}mm curah hujan, ${PlanningState.wind_speed_kmh.toFixed(1)}km/h angin\r\n            </p>\r\n        </div>\r\n        \r\n        <div class=\"glass border border-border rounded-xl p-5 transition-all hover:border-primary/50\">\r\n            <div class=\"flex items-center gap-3 mb-3\">\r\n                <span class=\"text-3xl\"></span>\r\n                <span class=\"text-sm text-muted-foreground\">Kapasitas Efektif</span>\r\n            </div>\r\n            <p class=\"text-xl font-bold text-foreground\">${Math.round(capacity).toLocaleString('id-ID')}</p>\r\n            <p class=\"text-xs text-muted-foreground mt-1\">Ton/Hari</p>\r\n        </div>\r\n        \r\n        <div class=\"glass border border-border rounded-xl p-5 transition-all hover:border-primary/50\">\r\n            <div class=\"flex items-center gap-3 mb-3\">\r\n                <span class=\"text-3xl\"></span>\r\n                <span class=\"text-sm text-muted-foreground\">Confidence Score</span>\r\n            </div>\r\n            <p class=\"text-xl font-bold text-foreground\">${(confidence * 100).toFixed(1)}%</p>\r\n            <div class=\"w-full h-2 bg-secondary rounded-full mt-2 overflow-hidden\">\r\n                <div class=\"h-full bg-gradient-to-r from-primary to-cyan-500 rounded-full\" \r\n                     style=\"width: ${confidence * 100}%\"></div>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Render Recommendations\r\n */\r\nfunction renderRecommendations(data) {\r\n    const container = document.getElementById('recommendations-container');\r\n    if (!container) return;\r\n\r\n    const narrative = data.narrative_recommendation ||\r\n        data.recommendation ||\r\n        data.response ||\r\n        'Tidak ada rekomendasi tersedia.';\r\n\r\n    const sections = parseNarrativeToSections(narrative);\r\n\r\n    let html = '';\r\n\r\n    if (sections.strategy) {\r\n        html += createRecommendationCard('', 'Strategi Utama', sections.strategy, 'from-primary/20 to-cyan-500/20');\r\n    }\r\n    if (sections.risks) {\r\n        html += createRecommendationCard('', 'Risiko Terdeteksi', sections.risks, 'from-yellow-500/20 to-orange-500/20');\r\n    }\r\n    if (sections.actions) {\r\n        html += createRecommendationCard('', 'Tindakan Prioritas', sections.actions, 'from-emerald-500/20 to-green-500/20');\r\n    }\r\n\r\n    if (!sections.strategy && !sections.risks && !sections.actions) {\r\n        html = createRecommendationCard('', 'Rekomendasi AI', narrative, 'from-primary/20 to-blue-500/20');\r\n    }\r\n\r\n    container.innerHTML = html;\r\n}\r\n\r\n/**\r\n * Parse Narrative to Sections\r\n */\r\nfunction parseNarrativeToSections(narrative) {\r\n    const sections = { strategy: '', risks: '', actions: '' };\r\n\r\n    const strategyMatch = narrative.match(/\\*\\*Strategi Utama:\\*\\*\\s*([\\s\\S]*?)(?=\\*\\*Risiko|\\*\\*Tindakan|$)/i);\r\n    const risksMatch = narrative.match(/\\*\\*Risiko Terdeteksi:\\*\\*\\s*([\\s\\S]*?)(?=\\*\\*Strategi|\\*\\*Tindakan|$)/i);\r\n    const actionsMatch = narrative.match(/\\*\\*Tindakan Prioritas:\\*\\*\\s*([\\s\\S]*?)(?=\\*\\*Strategi|\\*\\*Risiko|$)/i);\r\n\r\n    if (strategyMatch && strategyMatch[1]) {\r\n        sections.strategy = strategyMatch[1].trim();\r\n    }\r\n    if (risksMatch && risksMatch[1]) {\r\n        sections.risks = risksMatch[1].trim();\r\n    }\r\n    if (actionsMatch && actionsMatch[1]) {\r\n        sections.actions = actionsMatch[1].trim();\r\n    }\r\n\r\n    if (!sections.strategy && !sections.risks && !sections.actions) {\r\n        const paragraphs = narrative.split(/\\n\\n/).filter(p => p.trim());\r\n        if (paragraphs.length >= 1) sections.strategy = paragraphs[0];\r\n        if (paragraphs.length >= 2) sections.risks = paragraphs[1];\r\n        if (paragraphs.length >= 3) sections.actions = paragraphs.slice(2).join('\\n');\r\n    }\r\n\r\n    return sections;\r\n}\r\n\r\n/**\r\n * Create Recommendation Card\r\n */\r\nfunction createRecommendationCard(icon, title, content, gradient) {\r\n    let cleanContent = content\r\n        .replace(/\\*\\*([^*]+)\\*\\*/g, '$1')\r\n        .replace(/\\*([^*]+)\\*/g, '$1')\r\n        .replace(/^#{1,6}\\s+/gm, '')\r\n        .replace(/^(Strategi Utama|Risiko Terdeteksi|Tindakan Prioritas):\\s*/gi, '')\r\n        .trim();\r\n\r\n    let formattedContent = cleanContent;\r\n\r\n    if (cleanContent.includes('\\n') || cleanContent.includes('') || cleanContent.includes('-')) {\r\n        const lines = cleanContent.split(/[\\n-]/)\r\n            .map(line => line.trim())\r\n            .filter(line => line.length > 0);\r\n\r\n        if (lines.length > 1) {\r\n            formattedContent = '<ul class=\"list-disc list-inside space-y-2\">' +\r\n                lines.map(line => `<li class=\"text-muted-foreground\">${line}</li>`).join('') +\r\n                '</ul>';\r\n        } else {\r\n            formattedContent = `<p class=\"text-muted-foreground\">${cleanContent}</p>`;\r\n        }\r\n    } else {\r\n        formattedContent = `<p class=\"text-muted-foreground\">${cleanContent}</p>`;\r\n    }\r\n\r\n    return `\r\n        <div class=\"glass border border-border rounded-xl overflow-hidden\">\r\n            <div class=\"bg-gradient-to-r ${gradient} px-5 py-4 border-b border-border/50\">\r\n                <div class=\"flex items-center gap-3\">\r\n                    <span class=\"text-2xl\">${icon}</span>\r\n                    <h3 class=\"font-heading font-semibold text-lg text-foreground\">${title}</h3>\r\n                </div>\r\n            </div>\r\n            <div class=\"p-5\">${formattedContent}</div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Reset to Input Mode\r\n */\r\nfunction resetToInput() {\r\n    const generateBtn = document.getElementById('generate-btn');\r\n    const loadingContainer = document.getElementById('loading-container');\r\n    const resultDashboard = document.getElementById('result-dashboard');\r\n\r\n    if (generateBtn) generateBtn.classList.remove('hidden');\r\n    if (loadingContainer) loadingContainer.classList.add('hidden');\r\n    if (resultDashboard) resultDashboard.classList.add('hidden');\r\n\r\n    PlanningState.result = null;\r\n}\r\n","/**\r\n * OptiMine SPA - Auth Page\r\n * Login/Register form within SPA\r\n */\r\n\r\nimport { App } from '../../app.js';\r\nimport { API } from '../../data/api.js';\r\n\r\nconst API_BASE_URL = 'http://139.59.224.58:5000';\r\n\r\n/**\r\n * Auth Page Handler\r\n */\r\nexport const authPage = async (params) => {\r\n    // Hide navbar and footer on auth page\r\n    App.View.hideNavbar();\r\n\r\n    const content = getAuthTemplate();\r\n    await App.View.render(content, 'auth');\r\n\r\n    // Initialize after render\r\n    setTimeout(() => {\r\n        initAuthPage();\r\n    }, 100);\r\n};\r\n\r\n/**\r\n * Get Auth Page Template\r\n */\r\nfunction getAuthTemplate() {\r\n    return `\r\n        <div class=\"min-h-[80vh] flex items-center justify-center px-4 py-8\">\r\n            <div class=\"w-full max-w-md\">\r\n                <!-- Auth Card -->\r\n                <div class=\"glass border border-border rounded-2xl p-6 sm:p-8 animate-fade-in\">\r\n                    \r\n                    <!-- Header: Logo + Title -->\r\n                    <div id=\"auth-header\" class=\"text-center mb-6\">\r\n                        <div class=\"w-16 h-16 mx-auto mb-4 rounded-full overflow-hidden border-2 border-primary/30 bg-gradient-to-br from-primary/20 to-cyan-500/20 flex items-center justify-center\">\r\n                            <img src=\"assets/images/b (192 x 192 piksel) (1).png\" alt=\"OptiMine Logo\" class=\"w-full h-full object-cover\" onerror=\"this.style.display='none'; this.nextElementSibling.style.display='flex';\">\r\n                            <svg class=\"w-8 h-8 text-primary\" style=\"display: none;\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n                            </svg>\r\n                        </div>\r\n                        <h1 class=\"font-heading text-2xl font-bold mb-1\">\r\n                            <span class=\"text-primary\">Opti</span><span class=\"text-foreground\">Mine</span>\r\n                        </h1>\r\n                        <p class=\"text-sm text-muted-foreground\">Mining Value Chain Optimization Platform</p>\r\n                    </div>\r\n                    \r\n                    <!-- Tab Navigation -->\r\n                    <div class=\"grid grid-cols-2 gap-1 bg-secondary/50 rounded-lg p-1 mb-6\">\r\n                        <button id=\"login-tab\" class=\"auth-tab active py-2 px-4 text-sm font-medium rounded-md transition-all bg-primary text-white\" data-tab=\"login\">\r\n                            Masuk\r\n                        </button>\r\n                        <button id=\"register-tab\" class=\"auth-tab py-2 px-4 text-sm font-medium rounded-md transition-all text-muted-foreground hover:text-foreground\" data-tab=\"register\">\r\n                            Daftar\r\n                        </button>\r\n                    </div>\r\n                    \r\n                    <!-- LOGIN FORM -->\r\n                    <form id=\"login-form\" class=\"space-y-4\">\r\n                        <!-- Email Input -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"login-email\" class=\"text-sm font-medium text-foreground\">Email</label>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input \r\n                                    type=\"email\" \r\n                                    id=\"login-email\" \r\n                                    class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all\"\r\n                                    placeholder=\"email@example.com\"\r\n                                    required\r\n                                >\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Password Input -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <div class=\"flex items-center justify-between\">\r\n                                <label for=\"login-password\" class=\"text-sm font-medium text-foreground\">Kata Sandi</label>\r\n                                <button type=\"button\" id=\"forgot-password-btn\" class=\"text-xs text-primary hover:text-primary/80 transition-colors\">Lupa Kata Sandi?</button>\r\n                            </div>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input \r\n                                    type=\"password\" \r\n                                    id=\"login-password\" \r\n                                    class=\"w-full pl-10 pr-10 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all\"\r\n                                    placeholder=\"\"\r\n                                    required\r\n                                >\r\n                                <button type=\"button\" class=\"password-toggle absolute inset-y-0 right-0 pr-3 flex items-center\">\r\n                                    <svg class=\"eye-open w-5 h-5 text-muted-foreground hover:text-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n                                    </svg>\r\n                                    <svg class=\"eye-closed w-5 h-5 text-muted-foreground hover:text-foreground hidden\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21\" />\r\n                                    </svg>\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Submit Button -->\r\n                        <button \r\n                            type=\"submit\" \r\n                            id=\"login-submit\"\r\n                            class=\"w-full py-3 bg-primary hover:bg-primary/90 text-white font-medium rounded-lg transition-all duration-300 glow-hover flex items-center justify-center gap-2\"\r\n                        >\r\n                            <span>Masuk</span>\r\n                            <svg class=\"loading-spinner w-5 h-5 animate-spin hidden\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                                <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </form>\r\n                    \r\n                    <!-- REGISTER FORM -->\r\n                    <form id=\"register-form\" class=\"space-y-4 hidden\">\r\n                        <!-- Full Name -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"register-name\" class=\"text-sm font-medium text-foreground\">Nama Lengkap</label>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input type=\"text\" id=\"register-name\" class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm\" placeholder=\"John Doe\" required>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Email -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"register-email\" class=\"text-sm font-medium text-foreground\">Email</label>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input type=\"email\" id=\"register-email\" class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm\" placeholder=\"email@example.com\" required>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Password -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"register-password\" class=\"text-sm font-medium text-foreground\">Kata Sandi</label>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input type=\"password\" id=\"register-password\" class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm\" placeholder=\"Minimal 8 karakter\" required minlength=\"8\">\r\n                            </div>\r\n                            \r\n                            <!-- Password Strength Indicator -->\r\n                            <div id=\"password-info-container\" class=\"hidden mt-3 p-3 bg-secondary/30 border border-border rounded-lg animate-fade-in\">\r\n                                <!-- Password Strength Bar -->\r\n                                <div id=\"password-strength-container\" class=\"hidden mb-3\">\r\n                                    <div class=\"flex gap-1 mb-1\">\r\n                                        <div id=\"strength-bar-1\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                        <div id=\"strength-bar-2\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                        <div id=\"strength-bar-3\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                        <div id=\"strength-bar-4\" class=\"h-1.5 flex-1 rounded-full bg-secondary transition-colors duration-300\"></div>\r\n                                    </div>\r\n                                    <p id=\"password-strength-text\" class=\"text-xs font-medium\"></p>\r\n                                </div>\r\n                                \r\n                                <!-- Password Requirements -->\r\n                                <div id=\"password-requirements\" class=\"space-y-1.5 text-xs\">\r\n                                    <p id=\"req-title\" class=\"text-muted-foreground font-medium mb-2\">Persyaratan Password:</p>\r\n                                    <p id=\"req-length\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                        <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                        </svg>\r\n                                        <span>Minimal 8 karakter</span>\r\n                                    </p>\r\n                                    <p id=\"req-uppercase\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                        <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                        </svg>\r\n                                        <span>Huruf kapital (A-Z)</span>\r\n                                    </p>\r\n                                    <p id=\"req-number\" class=\"flex items-center gap-2 text-muted-foreground\">\r\n                                        <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                                        </svg>\r\n                                        <span>Angka (0-9)</span>\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Confirm Password -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"register-confirm\" class=\"text-sm font-medium text-foreground\">Konfirmasi Kata Sandi</label>\r\n                            <div class=\"relative\">\r\n                                <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                    <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                    </svg>\r\n                                </div>\r\n                                <input type=\"password\" id=\"register-confirm\" class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm\" placeholder=\"\" required>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Role Dropdown -->\r\n                        <div class=\"space-y-1.5\">\r\n                            <label for=\"register-role\" class=\"text-sm font-medium text-foreground\">Peran</label>\r\n                            <select id=\"register-role\" class=\"w-full px-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground focus:outline-none focus:border-primary\" required>\r\n                                <option value=\"\">Pilih Peran</option>\r\n                                <option value=\"mining_planner\">Mining Planner</option>\r\n                                <option value=\"shipping_planner\">Shipping Planner</option>\r\n                            </select>\r\n                        </div>\r\n                        \r\n                        <!-- Submit Button -->\r\n                        <button \r\n                            type=\"submit\" \r\n                            id=\"register-submit\"\r\n                            class=\"w-full py-3 bg-primary hover:bg-primary/90 text-white font-medium rounded-lg transition-all duration-300 glow-hover flex items-center justify-center gap-2\"\r\n                        >\r\n                            <span>Buat Akun</span>\r\n                            <svg class=\"loading-spinner w-5 h-5 animate-spin hidden\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                                <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                            </svg>\r\n                        </button>\r\n                    </form>\r\n                    \r\n                    <!-- FORGOT PASSWORD CARD (shown when forgot password clicked) -->\r\n                    <div id=\"forgot-password-card\" class=\"hidden\">\r\n                        <div class=\"text-center mb-6\">\r\n                            <div class=\"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/20 flex items-center justify-center\">\r\n                                <svg class=\"w-8 h-8 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <h2 class=\"text-xl font-bold text-foreground\">Lupa Kata Sandi?</h2>\r\n                            <p class=\"text-sm text-muted-foreground mt-2\">Masukkan email Anda untuk mereset password</p>\r\n                        </div>\r\n                        \r\n                        <form id=\"forgot-password-form\" class=\"space-y-4\">\r\n                            <div class=\"space-y-1.5\">\r\n                                <label for=\"forgot-email\" class=\"text-sm font-medium text-foreground\">Email</label>\r\n                                <div class=\"relative\">\r\n                                    <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                        <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                                        </svg>\r\n                                    </div>\r\n                                    <input \r\n                                        type=\"email\" \r\n                                        id=\"forgot-email\" \r\n                                        class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all\"\r\n                                        placeholder=\"email@example.com\"\r\n                                        required\r\n                                    >\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <button \r\n                                type=\"submit\" \r\n                                id=\"forgot-submit\"\r\n                                class=\"w-full py-3 bg-primary hover:bg-primary/90 text-white font-medium rounded-lg transition-all duration-300 glow-hover flex items-center justify-center gap-2\"\r\n                            >\r\n                                <span>Kirim Link Reset</span>\r\n                                <svg class=\"loading-spinner w-5 h-5 animate-spin hidden\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                                </svg>\r\n                            </button>\r\n                            \r\n                            <button \r\n                                type=\"button\" \r\n                                id=\"back-to-login\"\r\n                                class=\"w-full py-3 bg-secondary/50 hover:bg-secondary/70 text-foreground border border-border rounded-lg font-medium transition-all duration-300\"\r\n                            >\r\n                                Kembali ke Login\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Initialize Auth Page\r\n */\r\nfunction initAuthPage() {\r\n    setupTabNavigation();\r\n    setupLoginForm();\r\n    setupRegisterForm();\r\n    setupPasswordToggles();\r\n    setupForgotPassword();\r\n    setupPasswordStrength();\r\n}\r\n\r\n/**\r\n * Setup Tab Navigation\r\n */\r\nfunction setupTabNavigation() {\r\n    const loginTab = document.getElementById('login-tab');\r\n    const registerTab = document.getElementById('register-tab');\r\n    const loginForm = document.getElementById('login-form');\r\n    const registerForm = document.getElementById('register-form');\r\n\r\n    if (loginTab && registerTab) {\r\n        loginTab.addEventListener('click', () => {\r\n            loginTab.classList.add('bg-primary', 'text-white');\r\n            loginTab.classList.remove('text-muted-foreground');\r\n            registerTab.classList.remove('bg-primary', 'text-white');\r\n            registerTab.classList.add('text-muted-foreground');\r\n            loginForm.classList.remove('hidden');\r\n            registerForm.classList.add('hidden');\r\n        });\r\n\r\n        registerTab.addEventListener('click', () => {\r\n            registerTab.classList.add('bg-primary', 'text-white');\r\n            registerTab.classList.remove('text-muted-foreground');\r\n            loginTab.classList.remove('bg-primary', 'text-white');\r\n            loginTab.classList.add('text-muted-foreground');\r\n            registerForm.classList.remove('hidden');\r\n            loginForm.classList.add('hidden');\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Setup Login Form\r\n */\r\nfunction setupLoginForm() {\r\n    const form = document.getElementById('login-form');\r\n    if (!form) return;\r\n\r\n    form.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n\r\n        const email = document.getElementById('login-email').value.trim();\r\n        const password = document.getElementById('login-password').value;\r\n        const submitBtn = document.getElementById('login-submit');\r\n        const spinner = submitBtn.querySelector('.loading-spinner');\r\n\r\n        // Show loading\r\n        submitBtn.disabled = true;\r\n        spinner.classList.remove('hidden');\r\n\r\n        try {\r\n            const response = await fetch(`${API_BASE_URL}/login`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ email, password })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (!response.ok || result.error) {\r\n                throw new Error(result.message || 'Login gagal');\r\n            }\r\n\r\n            // Save login state\r\n            localStorage.setItem('optimine-logged-in', 'true');\r\n            localStorage.setItem('optimine-token', result.data.token);\r\n            localStorage.setItem('optimine-user', JSON.stringify({\r\n                id: result.data.id,\r\n                email: email,\r\n                name: result.data.nama,\r\n                role: result.data.role\r\n            }));\r\n\r\n            // Update navbar auth UI - hide login, show profile\r\n            updateNavbarAuthUI(true, result.data.nama);\r\n\r\n            // Show navbar again before redirect\r\n            App.View.showNavbar();\r\n\r\n            // Redirect to saved destination or home\r\n            setTimeout(() => {\r\n                const redirectRoute = localStorage.getItem('optimine-redirect') || 'home';\r\n                localStorage.removeItem('optimine-redirect');\r\n                window.location.hash = redirectRoute;\r\n            }, 1000);\r\n\r\n        } catch (error) {\r\n            App.View.showToast(error.message || 'Email atau password salah', 'error');\r\n        } finally {\r\n            submitBtn.disabled = false;\r\n            spinner.classList.add('hidden');\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Setup Register Form\r\n */\r\nfunction setupRegisterForm() {\r\n    const form = document.getElementById('register-form');\r\n    if (!form) return;\r\n\r\n    // Prevent duplicate event listener registration\r\n    if (form.dataset.listenerAdded === 'true') {\r\n        console.log('Register form listener already added, skipping');\r\n        return;\r\n    }\r\n    form.dataset.listenerAdded = 'true';\r\n\r\n    let isSubmitting = false; // Flag to prevent double-submit\r\n\r\n    form.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        e.stopImmediatePropagation(); // Stop other listeners\r\n\r\n        // Prevent double-submit\r\n        if (isSubmitting) {\r\n            console.log('Registration already in progress, ignoring duplicate submit');\r\n            return;\r\n        }\r\n\r\n        const name = document.getElementById('register-name').value.trim();\r\n        const email = document.getElementById('register-email').value.trim();\r\n        const password = document.getElementById('register-password').value;\r\n        const confirm = document.getElementById('register-confirm').value;\r\n        const role = document.getElementById('register-role').value;\r\n        const submitBtn = document.getElementById('register-submit');\r\n        const spinner = submitBtn.querySelector('.loading-spinner');\r\n\r\n        // Validate\r\n        if (password !== confirm) {\r\n            App.View.showToast('Konfirmasi password tidak cocok', 'error');\r\n            return;\r\n        }\r\n\r\n        if (!role) {\r\n            App.View.showToast('Pilih peran terlebih dahulu', 'error');\r\n            return;\r\n        }\r\n\r\n        // Show loading and set flag\r\n        isSubmitting = true;\r\n        submitBtn.disabled = true;\r\n        spinner.classList.remove('hidden');\r\n\r\n        try {\r\n            // Register\r\n            const registerResponse = await fetch(`${API_BASE_URL}/register`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ nama: name, email, password, role })\r\n            });\r\n\r\n            const registerResult = await registerResponse.json();\r\n\r\n            if (!registerResponse.ok || registerResult.error) {\r\n                throw new Error(registerResult.message || 'Registrasi gagal');\r\n            }\r\n\r\n            // Auto login\r\n            const loginResponse = await fetch(`${API_BASE_URL}/login`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ email, password })\r\n            });\r\n\r\n            const loginResult = await loginResponse.json();\r\n\r\n            let finalUserName = name;\r\n            if (loginResponse.ok && !loginResult.error) {\r\n                localStorage.setItem('optimine-logged-in', 'true');\r\n                localStorage.setItem('optimine-token', loginResult.data.token);\r\n                localStorage.setItem('optimine-user', JSON.stringify({\r\n                    id: loginResult.data.id,\r\n                    email: email,\r\n                    name: loginResult.data.nama,\r\n                    role: loginResult.data.role\r\n                }));\r\n                finalUserName = loginResult.data.nama;\r\n            }\r\n\r\n            // Update navbar auth UI - hide login, show profile\r\n            updateNavbarAuthUI(true, finalUserName);\r\n\r\n            // Show navbar again before redirect\r\n            App.View.showNavbar();\r\n\r\n            setTimeout(() => {\r\n                const redirectRoute = localStorage.getItem('optimine-redirect') || 'home';\r\n                localStorage.removeItem('optimine-redirect');\r\n                window.location.hash = redirectRoute;\r\n            }, 1000);\r\n\r\n        } catch (error) {\r\n            App.View.showToast(error.message || 'Registrasi gagal', 'error');\r\n        } finally {\r\n            isSubmitting = false; // Reset flag\r\n            submitBtn.disabled = false;\r\n            spinner.classList.add('hidden');\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Setup Password Toggle\r\n */\r\nfunction setupPasswordToggles() {\r\n    const toggles = document.querySelectorAll('.password-toggle');\r\n    toggles.forEach(toggle => {\r\n        toggle.addEventListener('click', () => {\r\n            const input = toggle.parentElement.querySelector('input');\r\n            const eyeOpen = toggle.querySelector('.eye-open');\r\n            const eyeClosed = toggle.querySelector('.eye-closed');\r\n\r\n            if (input.type === 'password') {\r\n                input.type = 'text';\r\n                eyeOpen?.classList.add('hidden');\r\n                eyeClosed?.classList.remove('hidden');\r\n            } else {\r\n                input.type = 'password';\r\n                eyeOpen?.classList.remove('hidden');\r\n                eyeClosed?.classList.add('hidden');\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Setup Password Strength Indicator\r\n */\r\nfunction setupPasswordStrength() {\r\n    const registerPassword = document.getElementById('register-password');\r\n    const passwordInfoContainer = document.getElementById('password-info-container');\r\n    const strengthContainer = document.getElementById('password-strength-container');\r\n    const strengthText = document.getElementById('password-strength-text');\r\n    const strengthBars = [\r\n        document.getElementById('strength-bar-1'),\r\n        document.getElementById('strength-bar-2'),\r\n        document.getElementById('strength-bar-3'),\r\n        document.getElementById('strength-bar-4')\r\n    ];\r\n    const reqLength = document.getElementById('req-length');\r\n    const reqUppercase = document.getElementById('req-uppercase');\r\n    const reqNumber = document.getElementById('req-number');\r\n\r\n    if (!registerPassword || !passwordInfoContainer) return;\r\n\r\n    // Get strength label\r\n    const getStrengthLabel = (strength) => {\r\n        const labels = ['', 'Lemah', 'Cukup', 'Baik', 'Kuat'];\r\n        return labels[strength] || '';\r\n    };\r\n\r\n    // Check password strength\r\n    const checkPasswordStrength = (password) => {\r\n        let strength = 0;\r\n        const checks = {\r\n            length: password.length >= 8,\r\n            uppercase: /[A-Z]/.test(password),\r\n            number: /[0-9]/.test(password),\r\n            lowercase: /[a-z]/.test(password),\r\n            special: /[!@#$%^&*(),.?\":{}|<>]/.test(password)\r\n        };\r\n\r\n        // Calculate strength\r\n        if (checks.length) strength++;\r\n        if (checks.uppercase) strength++;\r\n        if (checks.number) strength++;\r\n        if (checks.special || (checks.lowercase && password.length >= 10)) strength++;\r\n\r\n        return { strength, checks };\r\n    };\r\n\r\n    // Update requirement indicator\r\n    const updateRequirement = (element, isValid) => {\r\n        if (!element) return;\r\n        const span = element.querySelector('span');\r\n        const text = span ? span.textContent : '';\r\n\r\n        if (isValid) {\r\n            element.classList.remove('text-muted-foreground');\r\n            element.classList.add('text-green-500');\r\n            element.innerHTML = `\r\n                <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\r\n                </svg>\r\n                <span>${text}</span>\r\n            `;\r\n        } else {\r\n            element.classList.add('text-muted-foreground');\r\n            element.classList.remove('text-green-500');\r\n            element.innerHTML = `\r\n                <svg class=\"w-4 h-4 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke-width=\"2\"/>\r\n                </svg>\r\n                <span>${text}</span>\r\n            `;\r\n        }\r\n    };\r\n\r\n    // Update strength UI\r\n    const updateStrengthUI = (strength) => {\r\n        const colors = {\r\n            0: { bar: 'bg-secondary', text: '', color: '' },\r\n            1: { bar: 'bg-red-500', text: 'text-red-500', color: getStrengthLabel(1) },\r\n            2: { bar: 'bg-orange-500', text: 'text-orange-500', color: getStrengthLabel(2) },\r\n            3: { bar: 'bg-yellow-500', text: 'text-yellow-500', color: getStrengthLabel(3) },\r\n            4: { bar: 'bg-green-500', text: 'text-green-500', color: getStrengthLabel(4) }\r\n        };\r\n\r\n        const config = colors[strength];\r\n\r\n        // Update bars\r\n        strengthBars.forEach((bar, index) => {\r\n            if (!bar) return;\r\n            bar.className = 'h-1.5 flex-1 rounded-full transition-colors duration-300';\r\n            if (index < strength) {\r\n                bar.classList.add(config.bar);\r\n            } else {\r\n                bar.classList.add('bg-secondary');\r\n            }\r\n        });\r\n\r\n        // Update text\r\n        if (strengthText) {\r\n            strengthText.textContent = config.color;\r\n            strengthText.className = `text-xs font-medium ${config.text}`;\r\n        }\r\n    };\r\n\r\n    // Show password info on focus\r\n    registerPassword.addEventListener('focus', () => {\r\n        passwordInfoContainer.classList.remove('hidden');\r\n    });\r\n\r\n    // Hide password info on blur (only if empty)\r\n    registerPassword.addEventListener('blur', () => {\r\n        if (!registerPassword.value) {\r\n            passwordInfoContainer.classList.add('hidden');\r\n            strengthContainer?.classList.add('hidden');\r\n        }\r\n    });\r\n\r\n    // Input handler\r\n    registerPassword.addEventListener('input', (e) => {\r\n        const password = e.target.value;\r\n\r\n        // Always show container when typing\r\n        passwordInfoContainer.classList.remove('hidden');\r\n\r\n        if (password.length > 0) {\r\n            strengthContainer?.classList.remove('hidden');\r\n            const { strength, checks } = checkPasswordStrength(password);\r\n\r\n            // Update requirements\r\n            updateRequirement(reqLength, checks.length);\r\n            updateRequirement(reqUppercase, checks.uppercase);\r\n            updateRequirement(reqNumber, checks.number);\r\n\r\n            // Update strength bar\r\n            updateStrengthUI(strength);\r\n        } else {\r\n            strengthContainer?.classList.add('hidden');\r\n            updateStrengthUI(0);\r\n\r\n            // Reset requirements\r\n            updateRequirement(reqLength, false);\r\n            updateRequirement(reqUppercase, false);\r\n            updateRequirement(reqNumber, false);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Update Navbar Auth UI\r\n * Hide login button and show profile when logged in\r\n */\r\nfunction updateNavbarAuthUI(isLoggedIn, userName) {\r\n    const loginBtn = document.getElementById('loginBtn');\r\n    const profileBtn = document.getElementById('profileBtn');\r\n    const mobileLoginBtn = document.getElementById('mobileLoginBtn');\r\n    const mobileProfileBtn = document.getElementById('mobileProfileBtn');\r\n\r\n    if (isLoggedIn) {\r\n        // Hide login buttons\r\n        loginBtn?.classList.add('hidden');\r\n        loginBtn?.classList.remove('sm:flex');\r\n        mobileLoginBtn?.classList.add('hidden');\r\n\r\n        // Show profile buttons\r\n        profileBtn?.classList.remove('hidden');\r\n        profileBtn?.classList.add('flex');\r\n        mobileProfileBtn?.classList.remove('hidden');\r\n        mobileProfileBtn?.classList.add('flex');\r\n\r\n        // Update user name and initial\r\n        const userNameElements = document.querySelectorAll('.user-name');\r\n        const userInitialElements = document.querySelectorAll('.user-initial');\r\n\r\n        userNameElements.forEach(el => {\r\n            el.textContent = userName || 'User';\r\n        });\r\n\r\n        userInitialElements.forEach(el => {\r\n            el.textContent = (userName || 'U').charAt(0).toUpperCase();\r\n        });\r\n    } else {\r\n        // Show login buttons\r\n        loginBtn?.classList.remove('hidden');\r\n        loginBtn?.classList.add('sm:flex');\r\n        mobileLoginBtn?.classList.remove('hidden');\r\n\r\n        // Hide profile buttons\r\n        profileBtn?.classList.add('hidden');\r\n        profileBtn?.classList.remove('flex');\r\n        mobileProfileBtn?.classList.add('hidden');\r\n        mobileProfileBtn?.classList.remove('flex');\r\n    }\r\n}\r\n\r\n/**\r\n * Setup Forgot Password\r\n */\r\nfunction setupForgotPassword() {\r\n    const forgotPasswordBtn = document.getElementById('forgot-password-btn');\r\n    const forgotPasswordCard = document.getElementById('forgot-password-card');\r\n    const backToLoginBtn = document.getElementById('back-to-login');\r\n    const forgotPasswordForm = document.getElementById('forgot-password-form');\r\n    const loginForm = document.getElementById('login-form');\r\n    const registerForm = document.getElementById('register-form');\r\n    const tabNav = document.querySelector('.grid.grid-cols-2'); // Tab navigation container\r\n    const authHeader = document.getElementById('auth-header'); // Logo + title header\r\n\r\n    // Show forgot password card\r\n    forgotPasswordBtn?.addEventListener('click', () => {\r\n        loginForm?.classList.add('hidden');\r\n        registerForm?.classList.add('hidden');\r\n        tabNav?.classList.add('hidden');\r\n        authHeader?.classList.add('hidden'); // Hide logo + title\r\n        forgotPasswordCard?.classList.remove('hidden');\r\n    });\r\n\r\n    // Back to login\r\n    backToLoginBtn?.addEventListener('click', () => {\r\n        forgotPasswordCard?.classList.add('hidden');\r\n        tabNav?.classList.remove('hidden');\r\n        authHeader?.classList.remove('hidden'); // Show logo + title\r\n        loginForm?.classList.remove('hidden');\r\n    });\r\n\r\n    // Submit forgot password form\r\n    forgotPasswordForm?.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n\r\n        const email = document.getElementById('forgot-email')?.value?.trim();\r\n        const submitBtn = document.getElementById('forgot-submit');\r\n        const spinner = submitBtn?.querySelector('.loading-spinner');\r\n\r\n        if (!email) {\r\n            App.View.showToast('Silakan masukkan email Anda', 'error');\r\n            return;\r\n        }\r\n\r\n        // Show loading\r\n        submitBtn.disabled = true;\r\n        spinner?.classList.remove('hidden');\r\n\r\n        try {\r\n            // Call backend API\r\n            await API.auth.forgotPassword(email);\r\n\r\n            // Show success message\r\n            App.View.showToast('Link reset password telah dikirim ke email Anda', 'success');\r\n\r\n            // Clear form and go back to login\r\n            document.getElementById('forgot-email').value = '';\r\n            forgotPasswordCard?.classList.add('hidden');\r\n            tabNav?.classList.remove('hidden');\r\n            loginForm?.classList.remove('hidden');\r\n\r\n        } catch (error) {\r\n            console.error('Forgot password error:', error);\r\n            App.View.showToast(error.message || 'Gagal mengirim link reset', 'error');\r\n        } finally {\r\n            submitBtn.disabled = false;\r\n            spinner?.classList.add('hidden');\r\n        }\r\n    });\r\n}\r\n","/**\r\n * OptiMine SPA - Reset Password Page\r\n * Handle password reset from email link\r\n */\r\n\r\nimport { App } from '../../app.js';\r\nimport { Router } from '../../routes/routes.js';\r\nimport { getSection } from '../../utils/translations.js';\r\nimport { API } from '../../data/api.js';\r\n\r\n/**\r\n * Get reset password page translations\r\n */\r\nconst getTranslations = (lang) => {\r\n    return {\r\n        title: lang === 'en' ? 'Reset Password' : 'Reset Password',\r\n        subtitle: lang === 'en' ? 'Enter your new password below' : 'Masukkan password baru Anda',\r\n        newPassword: lang === 'en' ? 'New Password' : 'Password Baru',\r\n        confirmPassword: lang === 'en' ? 'Confirm Password' : 'Konfirmasi Password',\r\n        submit: lang === 'en' ? 'Reset Password' : 'Reset Password',\r\n        backToLogin: lang === 'en' ? 'Back to Login' : 'Kembali ke Login',\r\n        passwordMismatch: lang === 'en' ? 'Passwords do not match' : 'Password tidak cocok',\r\n        passwordTooShort: lang === 'en' ? 'Password must be at least 6 characters' : 'Password minimal 6 karakter',\r\n        success: lang === 'en' ? 'Password has been reset successfully!' : 'Password berhasil direset!',\r\n        error: lang === 'en' ? 'Failed to reset password' : 'Gagal mereset password',\r\n        invalidToken: lang === 'en' ? 'Invalid or expired reset link' : 'Link reset tidak valid atau sudah kadaluarsa'\r\n    };\r\n};\r\n\r\n/**\r\n * Render reset password page template\r\n */\r\nconst renderTemplate = (lang) => {\r\n    const t = getTranslations(lang);\r\n\r\n    return `\r\n    <div class=\"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-background via-background to-primary/5\">\r\n        <!-- Decorative elements -->\r\n        <div class=\"absolute inset-0 overflow-hidden pointer-events-none\">\r\n            <div class=\"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl\"></div>\r\n            <div class=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl\"></div>\r\n        </div>\r\n        \r\n        <div class=\"w-full max-w-md relative z-10\">\r\n            <!-- Reset Password Card -->\r\n            <div id=\"reset-password-card\" class=\"glass border border-border rounded-2xl p-6 sm:p-8 animate-scale-in\">\r\n                <!-- Header -->\r\n                <div class=\"text-center mb-6\">\r\n                    <div class=\"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/20 flex items-center justify-center\">\r\n                        <svg class=\"w-8 h-8 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <h2 class=\"font-heading text-xl font-bold text-foreground\">${t.title}</h2>\r\n                    <p class=\"text-sm text-muted-foreground mt-2\">${t.subtitle}</p>\r\n                </div>\r\n                \r\n                <form id=\"reset-password-form\" class=\"space-y-4\">\r\n                    <!-- New Password -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${t.newPassword}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"password\" \r\n                                id=\"new-password\" \r\n                                required \r\n                                minlength=\"6\"\r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Confirm Password -->\r\n                    <div>\r\n                        <label class=\"block text-sm font-medium text-foreground mb-2\">${t.confirmPassword}</label>\r\n                        <div class=\"relative\">\r\n                            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                <svg class=\"w-5 h-5 text-muted-foreground\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <input \r\n                                type=\"password\" \r\n                                id=\"confirm-new-password\" \r\n                                required \r\n                                minlength=\"6\"\r\n                                class=\"w-full pl-10 pr-4 py-2.5 bg-secondary/30 border border-border rounded-lg text-foreground placeholder:text-muted-foreground focus:ring-2 focus:ring-primary focus:border-transparent transition-all\" \r\n                                placeholder=\"\"\r\n                            >\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <!-- Submit Button -->\r\n                    <button \r\n                        type=\"submit\" \r\n                        class=\"w-full py-3 bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg font-medium transition-all duration-300 glow-hover mt-6\"\r\n                    >\r\n                        ${t.submit}\r\n                    </button>\r\n                    \r\n                    <!-- Back to Login -->\r\n                    <button \r\n                        type=\"button\" \r\n                        id=\"back-to-login\"\r\n                        class=\"w-full py-3 bg-secondary/50 hover:bg-secondary/70 text-foreground border border-border rounded-lg font-medium transition-all duration-300\"\r\n                    >\r\n                        ${t.backToLogin}\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    `;\r\n};\r\n\r\n/**\r\n * Setup reset password form handlers\r\n */\r\nconst setupHandlers = (token) => {\r\n    const form = document.getElementById('reset-password-form');\r\n    const backToLoginBtn = document.getElementById('back-to-login');\r\n    const lang = localStorage.getItem('optimine-language') || 'id';\r\n    const t = getTranslations(lang);\r\n\r\n    // Back to login button\r\n    backToLoginBtn?.addEventListener('click', () => {\r\n        Router.navigate('auth');\r\n    });\r\n\r\n    // Form submit\r\n    form?.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n\r\n        const newPassword = document.getElementById('new-password')?.value;\r\n        const confirmPassword = document.getElementById('confirm-new-password')?.value;\r\n\r\n        // Validation\r\n        if (newPassword.length < 6) {\r\n            App.View.showToast(t.passwordTooShort, 'error');\r\n            return;\r\n        }\r\n\r\n        if (newPassword !== confirmPassword) {\r\n            App.View.showToast(t.passwordMismatch, 'error');\r\n            return;\r\n        }\r\n\r\n        // Add loading state\r\n        const submitBtn = form.querySelector('button[type=\"submit\"]');\r\n        const originalText = submitBtn?.innerHTML;\r\n        if (submitBtn) {\r\n            submitBtn.innerHTML = `\r\n                <svg class=\"animate-spin h-5 w-5 mx-auto\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                    <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                    <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n            `;\r\n            submitBtn.disabled = true;\r\n        }\r\n\r\n        try {\r\n            // Call backend API to reset password\r\n            await API.auth.resetPassword(token, newPassword);\r\n\r\n            // Show success message\r\n            App.View.showToast(t.success, 'success');\r\n\r\n            // Redirect to login after delay\r\n            setTimeout(() => {\r\n                Router.navigate('auth');\r\n            }, 2000);\r\n\r\n        } catch (error) {\r\n            console.error('Reset password error:', error);\r\n            App.View.showToast(\r\n                error.message || t.error,\r\n                'error'\r\n            );\r\n        } finally {\r\n            // Reset button\r\n            if (submitBtn) {\r\n                submitBtn.innerHTML = originalText;\r\n                submitBtn.disabled = false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Reset Password Page Handler\r\n */\r\nexport const resetPasswordPage = async (params) => {\r\n    const lang = localStorage.getItem('optimine-language') || 'id';\r\n    const t = getTranslations(lang);\r\n    const token = params?.token;\r\n\r\n    // Check if token exists\r\n    if (!token) {\r\n        App.View.showToast(t.invalidToken, 'error');\r\n        Router.navigate('auth');\r\n        return;\r\n    }\r\n\r\n    // Render page\r\n    await App.View.render(renderTemplate(lang), 'reset-password');\r\n\r\n    // Setup form handlers\r\n    setupHandlers(token);\r\n};\r\n","/**\r\n * OptiMine SPA - Dashboard Page\r\n * Operations Dashboard with AI integration and real-time charts\r\n * Integrated with Backend API endpoints\r\n */\r\n\r\nimport { App } from '../../app.js';\r\nimport { EventBus } from '../../utils/index.js';\r\n\r\n// ============================================\r\n// API CONFIGURATION\r\n// ============================================\r\nconst API_CONFIG = {\r\n    baseUrl: 'http://139.59.224.58:5000',\r\n    endpoints: {\r\n        // AI Endpoints\r\n        aiHealth: '/ai/health',\r\n        aiChat: '/ai/chat',\r\n        aiRecommendations: '/ai/recommendations',\r\n        // Mine Operations\r\n        productionPlans: '/production-plans',\r\n        shippingSchedules: '/shipping-schedules',\r\n        effectiveCapacity: '/effective-capacity',\r\n        productionConstraints: '/production-constraints',\r\n        weather: '/weather',\r\n        equipments: '/equipments',\r\n        mines: '/mines'\r\n    },\r\n    timeout: 30000,\r\n    refreshInterval: 60000 // Refresh data every 60 seconds\r\n};\r\n\r\n// ============================================\r\n// STATE MANAGEMENT\r\n// ============================================\r\nconst DashboardState = {\r\n    // Stats with default/fallback values\r\n    stats: {\r\n        production: { value: 0, change: 0, unit: 'tons', loading: true },\r\n        distribution: { value: 0, change: 0, unit: 'tons', loading: true },\r\n        efficiency: { value: 0, change: 0, unit: '%', loading: true },\r\n        activeAlerts: { value: 0, change: 0, unit: '', loading: true }\r\n    },\r\n    // Weather data\r\n    weather: {\r\n        temperature: null,\r\n        condition: 'Loading...',\r\n        rainfall: null,\r\n        windSpeed: null,\r\n        loading: true\r\n    },\r\n    // Fleet/Equipment status\r\n    fleet: {\r\n        active: 0,\r\n        total: 0,\r\n        loading: true\r\n    },\r\n    // Mine sites\r\n    mines: [],\r\n    // AI Status\r\n    aiStatus: { isOnline: false },\r\n    // Chart state\r\n    chart: null,\r\n    chartType: 'line',\r\n    chartData: { labels: [], production: [], distribution: [], target: [] },\r\n    // Intervals\r\n    updateInterval: null,\r\n    chartUpdateInterval: null,\r\n    dataRefreshInterval: null\r\n};\r\n\r\n// ============================================\r\n// API HELPER\r\n// ============================================\r\nconst fetchWithAuth = async (endpoint, options = {}) => {\r\n    const token = localStorage.getItem('optimine-token');\r\n    const headers = {\r\n        'Content-Type': 'application/json',\r\n        ...(token && { 'Authorization': `Bearer ${token}` }),\r\n        ...options.headers\r\n    };\r\n\r\n    try {\r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), API_CONFIG.timeout);\r\n\r\n        const response = await fetch(`${API_CONFIG.baseUrl}${endpoint}`, {\r\n            ...options,\r\n            headers,\r\n            signal: controller.signal\r\n        });\r\n\r\n        clearTimeout(timeoutId);\r\n        return response;\r\n    } catch (error) {\r\n        console.warn(`API call failed: ${endpoint}`, error.message);\r\n        return null;\r\n    }\r\n};\r\n\r\n// ============================================\r\n// AI HEALTH CHECK\r\n// ============================================\r\nconst checkAIHealth = async () => {\r\n    try {\r\n        const response = await fetchWithAuth(API_CONFIG.endpoints.aiHealth, { method: 'GET' });\r\n\r\n        if (response && response.ok) {\r\n            const data = await response.json().catch(() => ({}));\r\n            DashboardState.aiStatus.isOnline = data.status === 'success';\r\n        } else {\r\n            DashboardState.aiStatus.isOnline = false;\r\n        }\r\n    } catch (error) {\r\n        DashboardState.aiStatus.isOnline = false;\r\n    }\r\n\r\n    updateAIStatusUI();\r\n};\r\n\r\nconst updateAIStatusUI = () => {\r\n    const dot = document.getElementById('ai-dot');\r\n    const text = document.getElementById('ai-text');\r\n\r\n    if (!dot || !text) return;\r\n\r\n    dot.classList.remove('bg-green-500', 'bg-red-500', 'bg-gray-400');\r\n    text.classList.remove('text-green-500', 'text-red-500', 'text-muted-foreground');\r\n\r\n    if (DashboardState.aiStatus.isOnline) {\r\n        dot.classList.add('bg-green-500');\r\n        text.textContent = 'AI Online';\r\n        text.classList.add('text-green-500');\r\n    } else {\r\n        dot.classList.add('bg-red-500');\r\n        text.textContent = 'AI Offline';\r\n        text.classList.add('text-red-500');\r\n    }\r\n};\r\n\r\n// ============================================\r\n// LOAD PRODUCTION STATS FROM API\r\n// ============================================\r\nconst loadProductionStats = async () => {\r\n    const token = localStorage.getItem('optimine-token');\r\n    if (!token) {\r\n        // Use fallback data for non-authenticated users\r\n        setFallbackStats();\r\n        return;\r\n    }\r\n\r\n    try {\r\n        // Fetch production plans\r\n        const prodResponse = await fetchWithAuth(API_CONFIG.endpoints.productionPlans);\r\n        if (prodResponse && prodResponse.ok) {\r\n            const data = await prodResponse.json();\r\n            const plans = data.data || data || [];\r\n            if (Array.isArray(plans) && plans.length > 0) {\r\n                // Calculate total production from plans\r\n                const totalProduction = plans.reduce((sum, plan) => {\r\n                    return sum + (plan.target_production || plan.production || 0);\r\n                }, 0);\r\n                DashboardState.stats.production.value = totalProduction;\r\n                DashboardState.stats.production.change = calculateChange(plans);\r\n            }\r\n        }\r\n\r\n        // Fetch shipping schedules for distribution\r\n        const shipResponse = await fetchWithAuth(API_CONFIG.endpoints.shippingSchedules);\r\n        if (shipResponse && shipResponse.ok) {\r\n            const data = await shipResponse.json();\r\n            const schedules = data.data || data || [];\r\n            if (Array.isArray(schedules) && schedules.length > 0) {\r\n                const totalDistribution = schedules.reduce((sum, schedule) => {\r\n                    return sum + (schedule.tonnage || schedule.quantity || 0);\r\n                }, 0);\r\n                DashboardState.stats.distribution.value = totalDistribution;\r\n                DashboardState.stats.distribution.change = 3.1; // Default change\r\n            }\r\n        }\r\n\r\n        // Fetch effective capacity for efficiency\r\n        const capacityResponse = await fetchWithAuth(API_CONFIG.endpoints.effectiveCapacity);\r\n        if (capacityResponse && capacityResponse.ok) {\r\n            const data = await capacityResponse.json();\r\n            const capacity = data.data || data;\r\n            if (capacity && typeof capacity.efficiency !== 'undefined') {\r\n                DashboardState.stats.efficiency.value = capacity.efficiency;\r\n                DashboardState.stats.efficiency.change = capacity.change || 2.4;\r\n            } else if (Array.isArray(capacity) && capacity.length > 0) {\r\n                // Calculate average efficiency\r\n                const avgEfficiency = capacity.reduce((sum, c) => sum + (c.efficiency || c.rate || 0), 0) / capacity.length;\r\n                DashboardState.stats.efficiency.value = Math.round(avgEfficiency * 10) / 10;\r\n            }\r\n        }\r\n\r\n        // Fetch production constraints for alerts\r\n        const constraintsResponse = await fetchWithAuth(API_CONFIG.endpoints.productionConstraints);\r\n        if (constraintsResponse && constraintsResponse.ok) {\r\n            const data = await constraintsResponse.json();\r\n            const constraints = data.data || data || [];\r\n            if (Array.isArray(constraints)) {\r\n                // Count total constraints as alerts, or filter by active status\r\n                const activeAlerts = constraints.filter(c =>\r\n                    c.active !== false &&\r\n                    c.status !== 'resolved' &&\r\n                    c.status !== 'closed'\r\n                ).length || constraints.length;\r\n                DashboardState.stats.activeAlerts.value = activeAlerts;\r\n                // Calculate change from previous period if available\r\n                DashboardState.stats.activeAlerts.change = -2; // Default\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.warn('Failed to load production stats:', error);\r\n    }\r\n\r\n    // Mark loading complete and use fallback for any missing data\r\n    finishStatsLoading();\r\n    updateStatsUI();\r\n};\r\n\r\nconst calculateChange = (plans) => {\r\n    if (plans.length < 2) return 5.2;\r\n    // Simple change calculation (latest vs previous)\r\n    const latest = plans[0]?.target_production || plans[0]?.production || 0;\r\n    const previous = plans[1]?.target_production || plans[1]?.production || 0;\r\n    if (previous === 0) return 0;\r\n    return Math.round(((latest - previous) / previous) * 100 * 10) / 10;\r\n};\r\n\r\nconst setFallbackStats = () => {\r\n    DashboardState.stats = {\r\n        production: { value: 12450, change: 5.2, unit: 'tons', loading: false },\r\n        distribution: { value: 8320, change: 3.1, unit: 'tons', loading: false },\r\n        efficiency: { value: 94.2, change: 2.4, unit: '%', loading: false },\r\n        activeAlerts: { value: 3, change: -2, unit: '', loading: false }\r\n    };\r\n    // Also set default fleet values\r\n    DashboardState.fleet = { active: 23, total: 25, loading: false };\r\n};\r\n\r\nconst finishStatsLoading = () => {\r\n    const { stats } = DashboardState;\r\n    // Set defaults for any missing data\r\n    if (stats.production.value === 0) stats.production.value = 12450;\r\n    if (stats.distribution.value === 0) stats.distribution.value = 8320;\r\n    if (stats.efficiency.value === 0) stats.efficiency.value = 94.2;\r\n\r\n    // Set default change values if they're 0 (API didn't provide)\r\n    if (stats.production.change === 0) stats.production.change = 5.2;\r\n    if (stats.distribution.change === 0) stats.distribution.change = 3.1;\r\n    if (stats.efficiency.change === 0) stats.efficiency.change = 2.4;\r\n    if (stats.activeAlerts.change === 0) stats.activeAlerts.change = -2;\r\n\r\n    stats.production.loading = false;\r\n    stats.distribution.loading = false;\r\n    stats.efficiency.loading = false;\r\n    stats.activeAlerts.loading = false;\r\n};\r\n\r\nconst updateStatsUI = () => {\r\n    const { stats } = DashboardState;\r\n\r\n    // Update production\r\n    const prodValue = document.getElementById('stat-production-value');\r\n    const prodChange = document.getElementById('stat-production-change');\r\n    if (prodValue) prodValue.textContent = stats.production.value.toLocaleString();\r\n    if (prodChange) prodChange.textContent = `${stats.production.change >= 0 ? '+' : ''}${stats.production.change}%`;\r\n\r\n    // Update distribution\r\n    const distValue = document.getElementById('stat-distribution-value');\r\n    const distChange = document.getElementById('stat-distribution-change');\r\n    if (distValue) distValue.textContent = stats.distribution.value.toLocaleString();\r\n    if (distChange) distChange.textContent = `${stats.distribution.change >= 0 ? '+' : ''}${stats.distribution.change}%`;\r\n\r\n    // Update efficiency\r\n    const effValue = document.getElementById('stat-efficiency-value');\r\n    const effChange = document.getElementById('stat-efficiency-change');\r\n    if (effValue) effValue.textContent = stats.efficiency.value;\r\n    if (effChange) effChange.textContent = `${stats.efficiency.change >= 0 ? '+' : ''}${stats.efficiency.change}%`;\r\n\r\n    // Update alerts\r\n    const alertValue = document.getElementById('stat-alerts-value');\r\n    const alertChange = document.getElementById('stat-alerts-change');\r\n    if (alertValue) alertValue.textContent = stats.activeAlerts.value;\r\n    if (alertChange) alertChange.textContent = stats.activeAlerts.change;\r\n};\r\n\r\n// ============================================\r\n// LOAD WEATHER DATA\r\n// ============================================\r\nconst loadWeatherData = async () => {\r\n    try {\r\n        const response = await fetchWithAuth(API_CONFIG.endpoints.weather);\r\n\r\n        if (response && response.ok) {\r\n            const data = await response.json();\r\n            const weather = data.data || data;\r\n\r\n            if (weather) {\r\n                DashboardState.weather = {\r\n                    temperature: weather.temperature || weather.temp || 28,\r\n                    condition: weather.condition || weather.weather_class || 'Clear',\r\n                    rainfall: weather.rainfall_mm || weather.rainfall || 0,\r\n                    windSpeed: weather.wind_speed_kmh || weather.wind_speed || 12,\r\n                    loading: false\r\n                };\r\n            }\r\n        } else {\r\n            // Use fallback\r\n            DashboardState.weather = {\r\n                temperature: 28,\r\n                condition: 'Partly Cloudy',\r\n                rainfall: 0,\r\n                windSpeed: 12,\r\n                loading: false\r\n            };\r\n        }\r\n    } catch (error) {\r\n        console.warn('Failed to load weather:', error);\r\n        DashboardState.weather.loading = false;\r\n    }\r\n\r\n    updateWeatherUI();\r\n};\r\n\r\nconst updateWeatherUI = () => {\r\n    const { weather } = DashboardState;\r\n\r\n    const tempEl = document.getElementById('weather-temp');\r\n    const condEl = document.getElementById('weather-condition');\r\n    const rainEl = document.getElementById('weather-rainfall');\r\n    const windEl = document.getElementById('weather-wind');\r\n\r\n    if (tempEl) tempEl.textContent = `${weather.temperature}C`;\r\n    if (condEl) condEl.textContent = weather.condition;\r\n    if (rainEl) rainEl.textContent = `${weather.rainfall}mm`;\r\n    if (windEl) windEl.textContent = `${weather.windSpeed} km/h`;\r\n};\r\n\r\n// ============================================\r\n// LOAD FLEET/EQUIPMENT STATUS\r\n// ============================================\r\nconst loadFleetStatus = async () => {\r\n    try {\r\n        const response = await fetchWithAuth(API_CONFIG.endpoints.equipments);\r\n\r\n        if (response && response.ok) {\r\n            const data = await response.json();\r\n            const equipments = data.data || data || [];\r\n\r\n            if (Array.isArray(equipments) && equipments.length > 0) {\r\n                DashboardState.fleet.total = equipments.length;\r\n                // Count active equipment with various status field names\r\n                const activeCount = equipments.filter(e => {\r\n                    const status = (e.status || e.equipment_status || '').toLowerCase();\r\n                    return status === 'active' ||\r\n                        status === 'operational' ||\r\n                        status === 'available' ||\r\n                        status === 'running' ||\r\n                        e.active === true ||\r\n                        e.is_active === true;\r\n                }).length;\r\n                // If no equipment matches active status, assume all are active\r\n                DashboardState.fleet.active = activeCount > 0 ? activeCount : equipments.length;\r\n            }\r\n        } else {\r\n            // Fallback\r\n            DashboardState.fleet = { active: 23, total: 25, loading: false };\r\n        }\r\n    } catch (error) {\r\n        DashboardState.fleet = { active: 23, total: 25, loading: false };\r\n    }\r\n\r\n    DashboardState.fleet.loading = false;\r\n    updateFleetUI();\r\n};\r\n\r\nconst updateFleetUI = () => {\r\n    const { fleet } = DashboardState;\r\n    const fleetEl = document.getElementById('fleet-status');\r\n    if (fleetEl) {\r\n        fleetEl.textContent = `${fleet.active}/${fleet.total} Active`;\r\n    }\r\n};\r\n\r\n// ============================================\r\n// LOAD MINES STATUS\r\n// ============================================\r\nconst loadMinesStatus = async () => {\r\n    try {\r\n        const response = await fetchWithAuth(API_CONFIG.endpoints.mines);\r\n\r\n        if (response && response.ok) {\r\n            const data = await response.json();\r\n            DashboardState.mines = data.data || data || [];\r\n        }\r\n    } catch (error) {\r\n        console.warn('Failed to load mines:', error);\r\n    }\r\n\r\n    updateMinesUI();\r\n};\r\n\r\nconst updateMinesUI = () => {\r\n    const mines = DashboardState.mines;\r\n    if (mines.length === 0) return;\r\n\r\n    // Update mine status badges (if elements exist)\r\n    const mineAStatus = document.getElementById('mine-a-status');\r\n    const mineBStatus = document.getElementById('mine-b-status');\r\n\r\n    if (mines[0] && mineAStatus) {\r\n        mineAStatus.textContent = mines[0].status || 'Active';\r\n    }\r\n    if (mines[1] && mineBStatus) {\r\n        mineBStatus.textContent = mines[1].status || 'Active';\r\n    }\r\n};\r\n\r\n// ============================================\r\n// AI RECOMMENDATIONS\r\n// ============================================\r\nconst loadAIRecommendations = async () => {\r\n    const container = document.getElementById('recommendations-grid');\r\n    if (!container) return;\r\n\r\n    // Show loading briefly for UX\r\n    container.innerHTML = `\r\n        <div class=\"col-span-3 flex items-center justify-center py-8\">\r\n            <div class=\"flex items-center gap-3\">\r\n                <div class=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\"></div>\r\n                <span class=\"text-muted-foreground text-sm\">Memuat rekomendasi AI...</span>\r\n            </div>\r\n        </div>\r\n    `;\r\n\r\n    // Small delay for smoother UX transition\r\n    await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n    // Use fallback recommendations directly (API endpoints not available)\r\n    // This prevents 400 errors in console and provides instant results\r\n    renderRecommendations(container, getFallbackRecommendations(), true);\r\n};\r\n\r\nconst parseRecommendations = (aiResponse) => {\r\n    try {\r\n        const jsonMatch = aiResponse.match(/\\[[\\s\\S]*\\]/);\r\n        if (jsonMatch) {\r\n            return JSON.parse(jsonMatch[0]);\r\n        }\r\n    } catch (e) { }\r\n    return getFallbackRecommendations();\r\n};\r\n\r\nconst getFallbackRecommendations = () => {\r\n    // Get values with safe defaults\r\n    const fleetActive = DashboardState.fleet.active || 23;\r\n    const fleetTotal = DashboardState.fleet.total || 25;\r\n    const weatherCondition = DashboardState.weather.condition || 'Clear';\r\n    const alertsCount = DashboardState.stats.activeAlerts.value || 3;\r\n\r\n    return [\r\n        {\r\n            title: 'Tingkatkan Produksi Melalui Pemeliharaan Fleet',\r\n            description: 'Lakukan pemeliharaan preventif pada armada untuk memastikan semua kendaraan berfungsi dengan baik.',\r\n            priority: 'high',\r\n            justification: `Dengan ${fleetActive} dari ${fleetTotal} kendaraan aktif, pemeliharaan dapat meningkatkan efisiensi.`\r\n        },\r\n        {\r\n            title: 'Optimalkan Distribusi Berdasarkan Cuaca',\r\n            description: `Kondisi cuaca saat ini: ${weatherCondition}. Sesuaikan jadwal pengiriman.`,\r\n            priority: 'medium',\r\n            justification: 'Optimalisasi distribusi dapat mengurangi biaya dan meningkatkan efisiensi operasional.'\r\n        },\r\n        {\r\n            title: 'Tanggapi Alert Aktif Secara Proaktif',\r\n            description: `Tinjau dan tangani ${alertsCount} alert aktif untuk mencegah gangguan.`,\r\n            priority: alertsCount > 5 ? 'high' : 'medium',\r\n            justification: 'Menangani alert dengan cepat mencegah dampak negatif pada produksi.'\r\n        }\r\n    ];\r\n};\r\n\r\nconst renderRecommendations = (container, recommendations, isFallback = false) => {\r\n    const colors = {\r\n        high: { bg: 'bg-red-500/20', text: 'text-red-500', border: 'border-red-500/30' },\r\n        medium: { bg: 'bg-yellow-500/20', text: 'text-yellow-500', border: 'border-yellow-500/30' },\r\n        low: { bg: 'bg-blue-500/20', text: 'text-blue-500', border: 'border-blue-500/30' }\r\n    };\r\n\r\n    container.innerHTML = recommendations.map((rec, i) => {\r\n        const c = colors[rec.priority] || colors.medium;\r\n        return `\r\n            <div class=\"glass border border-border rounded-lg p-4 hover:border-primary/50 transition-all animate-fade-in\" style=\"animation-delay: ${i * 0.1}s\">\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                    <h3 class=\"font-medium text-sm text-foreground\">${escapeHtml(rec.title)}</h3>\r\n                    <span class=\"px-2 py-0.5 text-xs font-medium rounded-full ${c.bg} ${c.text} ${c.border}\">${rec.priority}</span>\r\n                </div>\r\n                <p class=\"text-xs text-muted-foreground mb-3\">${escapeHtml(rec.description)}</p>\r\n                <div class=\"border-t border-border/50 pt-3\">\r\n                    <p class=\"text-xs text-muted-foreground\">\r\n                        <span class=\"font-medium text-yellow-500\">Justifikasi:</span> ${escapeHtml(rec.justification)}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }).join('');\r\n\r\n    if (isFallback) {\r\n        container.innerHTML += `<div class=\"col-span-3 text-center text-xs text-muted-foreground mt-2\"><em> Mode offline - AI sedang tidak tersedia</em></div>`;\r\n    }\r\n};\r\n\r\nconst escapeHtml = (text) => {\r\n    if (!text) return '';\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n};\r\n\r\n// ============================================\r\n// CHART MANAGEMENT\r\n// ============================================\r\nconst initChart = () => {\r\n    try {\r\n        if (typeof window.Chart === 'undefined' && typeof Chart === 'undefined') {\r\n            console.warn('Chart.js not loaded - chart disabled');\r\n            return;\r\n        }\r\n\r\n        loadChartData();\r\n        bindChartToggle();\r\n    } catch (error) {\r\n        console.error('Chart initialization error:', error);\r\n    }\r\n};\r\n\r\nconst loadChartData = async () => {\r\n    // Try to load from API first\r\n    try {\r\n        const response = await fetchWithAuth(`${API_CONFIG.endpoints.productionPlans}?limit=12`);\r\n\r\n        if (response && response.ok) {\r\n            const data = await response.json();\r\n            const plans = data.data || data || [];\r\n\r\n            if (Array.isArray(plans) && plans.length > 0) {\r\n                DashboardState.chartData = {\r\n                    labels: plans.map(p => formatDate(p.date || p.created_at)).reverse(),\r\n                    production: plans.map(p => p.target_production || p.production || 0).reverse(),\r\n                    distribution: plans.map(p => p.distribution || Math.round((p.target_production || 0) * 0.7)).reverse(),\r\n                    target: plans.map(() => 1200)\r\n                };\r\n                createChart();\r\n                startChartUpdates();\r\n                return;\r\n            }\r\n        }\r\n    } catch (error) {\r\n        console.warn('Failed to load chart data from API:', error);\r\n    }\r\n\r\n    // Fallback to generated data\r\n    generateChartData();\r\n    createChart();\r\n    startChartUpdates();\r\n};\r\n\r\nconst formatDate = (dateStr) => {\r\n    if (!dateStr) return formatTime(new Date());\r\n    const date = new Date(dateStr);\r\n    return date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });\r\n};\r\n\r\nconst generateChartData = () => {\r\n    const now = new Date();\r\n    DashboardState.chartData = { labels: [], production: [], distribution: [], target: [] };\r\n\r\n    for (let i = 11; i >= 0; i--) {\r\n        const time = new Date(now.getTime() - i * 5 * 60 * 1000);\r\n        DashboardState.chartData.labels.push(formatTime(time));\r\n        DashboardState.chartData.production.push(Math.round(1000 + Math.random() * 400 - 200));\r\n        DashboardState.chartData.distribution.push(Math.round(700 + Math.random() * 300 - 150));\r\n        DashboardState.chartData.target.push(1200);\r\n    }\r\n};\r\n\r\nconst formatTime = (date) => date.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });\r\n\r\nconst createChart = () => {\r\n    const canvas = document.getElementById('dashboard-chart');\r\n    if (!canvas) return;\r\n\r\n    const existingChart = window.Chart?.getChart?.(canvas);\r\n    if (existingChart) existingChart.destroy();\r\n\r\n    if (DashboardState.chart) {\r\n        try { DashboardState.chart.destroy(); } catch (e) { }\r\n        DashboardState.chart = null;\r\n    }\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    const isDark = document.documentElement.classList.contains('dark');\r\n    const gridColor = isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)';\r\n    const textColor = isDark ? 'rgba(255,255,255,0.7)' : 'rgba(0,0,0,0.7)';\r\n\r\n    const ChartJS = window.Chart || Chart;\r\n\r\n    DashboardState.chart = new ChartJS(ctx, {\r\n        type: DashboardState.chartType,\r\n        data: {\r\n            labels: DashboardState.chartData.labels,\r\n            datasets: [\r\n                {\r\n                    label: 'Production',\r\n                    data: DashboardState.chartData.production,\r\n                    borderColor: 'rgb(34, 197, 94)',\r\n                    backgroundColor: 'rgba(34, 197, 94, 0.1)',\r\n                    borderWidth: 2,\r\n                    fill: true,\r\n                    tension: 0.4\r\n                },\r\n                {\r\n                    label: 'Distribution',\r\n                    data: DashboardState.chartData.distribution,\r\n                    borderColor: 'rgb(59, 130, 246)',\r\n                    backgroundColor: 'rgba(59, 130, 246, 0.1)',\r\n                    borderWidth: 2,\r\n                    fill: true,\r\n                    tension: 0.4\r\n                },\r\n                {\r\n                    label: 'Target',\r\n                    data: DashboardState.chartData.target,\r\n                    borderColor: 'rgb(234, 179, 8)',\r\n                    borderWidth: 2,\r\n                    borderDash: [5, 5],\r\n                    fill: false,\r\n                    pointRadius: 0\r\n                }\r\n            ]\r\n        },\r\n        options: {\r\n            responsive: true,\r\n            maintainAspectRatio: false,\r\n            plugins: { legend: { display: false } },\r\n            scales: {\r\n                x: { grid: { color: gridColor }, ticks: { color: textColor } },\r\n                y: { min: 500, max: 1600, grid: { color: gridColor }, ticks: { color: textColor } }\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nconst bindChartToggle = () => {\r\n    const btn = document.getElementById('chart-toggle');\r\n    if (btn) {\r\n        btn.addEventListener('click', () => {\r\n            DashboardState.chartType = DashboardState.chartType === 'line' ? 'bar' : 'line';\r\n            btn.querySelector('span').textContent = DashboardState.chartType === 'line' ? 'Line' : 'Bar';\r\n            createChart();\r\n        });\r\n    }\r\n};\r\n\r\nconst startChartUpdates = () => {\r\n    DashboardState.chartUpdateInterval = setInterval(() => {\r\n        const now = new Date();\r\n        const { chartData } = DashboardState;\r\n\r\n        chartData.labels.push(formatTime(now));\r\n        const lastProd = chartData.production[chartData.production.length - 1] || 1000;\r\n        const lastDist = chartData.distribution[chartData.distribution.length - 1] || 700;\r\n\r\n        chartData.production.push(Math.max(600, Math.min(1500, lastProd * (0.95 + Math.random() * 0.1))));\r\n        chartData.distribution.push(Math.max(400, Math.min(1200, lastDist * (0.95 + Math.random() * 0.1))));\r\n        chartData.target.push(1200);\r\n\r\n        if (chartData.labels.length > 12) {\r\n            chartData.labels.shift();\r\n            chartData.production.shift();\r\n            chartData.distribution.shift();\r\n            chartData.target.shift();\r\n        }\r\n\r\n        if (DashboardState.chart) {\r\n            DashboardState.chart.data.labels = chartData.labels;\r\n            DashboardState.chart.data.datasets[0].data = chartData.production;\r\n            DashboardState.chart.data.datasets[1].data = chartData.distribution;\r\n            DashboardState.chart.data.datasets[2].data = chartData.target;\r\n            DashboardState.chart.update('none');\r\n        }\r\n    }, 5000);\r\n};\r\n\r\n// ============================================\r\n// PERIODIC DATA REFRESH\r\n// ============================================\r\nconst startDataRefresh = () => {\r\n    DashboardState.dataRefreshInterval = setInterval(() => {\r\n        loadProductionStats();\r\n        loadWeatherData();\r\n        loadFleetStatus();\r\n        checkAIHealth();\r\n    }, API_CONFIG.refreshInterval);\r\n};\r\n\r\n// ============================================\r\n// CLEANUP\r\n// ============================================\r\nconst cleanup = () => {\r\n    if (DashboardState.updateInterval) clearInterval(DashboardState.updateInterval);\r\n    if (DashboardState.chartUpdateInterval) clearInterval(DashboardState.chartUpdateInterval);\r\n    if (DashboardState.dataRefreshInterval) clearInterval(DashboardState.dataRefreshInterval);\r\n    if (DashboardState.chart) {\r\n        DashboardState.chart.destroy();\r\n        DashboardState.chart = null;\r\n    }\r\n};\r\n\r\n// ============================================\r\n// TEMPLATE\r\n// ============================================\r\nconst template = () => {\r\n    const { stats, weather, fleet } = DashboardState;\r\n\r\n    return `\r\n<div class=\"min-h-[calc(100vh-4rem)] pt-6\">\r\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        \r\n        <!-- Header -->\r\n        <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\r\n            <div>\r\n                <h1 class=\"font-heading text-2xl md:text-3xl font-bold text-foreground\">Operations Dashboard</h1>\r\n                <p class=\"text-muted-foreground mt-1\">Real-time monitoring and analytics</p>\r\n            </div>\r\n            <div class=\"flex items-center gap-3 px-4 py-2 glass border border-border rounded-xl\">\r\n                <div id=\"ai-dot\" class=\"w-2.5 h-2.5 rounded-full bg-gray-400 animate-pulse\"></div>\r\n                <span id=\"ai-text\" class=\"text-sm font-medium text-muted-foreground\">Checking AI...</span>\r\n            </div>\r\n        </div>\r\n        \r\n        <!-- Stats Grid -->\r\n        <div class=\"grid sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n            <div class=\"glass border border-border rounded-xl p-5 glow-hover\">\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                    <div class=\"w-10 h-10 rounded-lg bg-green-500/10 flex items-center justify-center\">\r\n                        <svg class=\"w-5 h-5 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6\" />\r\n                        </svg>\r\n                    </div>\r\n                    <span id=\"stat-production-change\" class=\"text-sm font-medium text-green-500\">+${stats.production.change}%</span>\r\n                </div>\r\n                <p class=\"font-heading text-2xl font-bold text-foreground\"><span id=\"stat-production-value\">${stats.production.value.toLocaleString()}</span> <span class=\"text-sm font-normal text-muted-foreground\">tons</span></p>\r\n                <p class=\"text-sm text-muted-foreground\">Production</p>\r\n            </div>\r\n            \r\n            <div class=\"glass border border-border rounded-xl p-5 glow-hover\">\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                    <div class=\"w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center\">\r\n                        <svg class=\"w-5 h-5 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <span id=\"stat-distribution-change\" class=\"text-sm font-medium text-green-500\">+${stats.distribution.change}%</span>\r\n                </div>\r\n                <p class=\"font-heading text-2xl font-bold text-foreground\"><span id=\"stat-distribution-value\">${stats.distribution.value.toLocaleString()}</span> <span class=\"text-sm font-normal text-muted-foreground\">tons</span></p>\r\n                <p class=\"text-sm text-muted-foreground\">Distribution</p>\r\n            </div>\r\n            \r\n            <div class=\"glass border border-border rounded-xl p-5 glow-hover\">\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                    <div class=\"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center\">\r\n                        <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <span id=\"stat-efficiency-change\" class=\"text-sm font-medium text-green-500\">+${stats.efficiency.change}%</span>\r\n                </div>\r\n                <p class=\"font-heading text-2xl font-bold text-foreground\"><span id=\"stat-efficiency-value\">${stats.efficiency.value}</span> <span class=\"text-sm font-normal text-muted-foreground\">%</span></p>\r\n                <p class=\"text-sm text-muted-foreground\">Efficiency</p>\r\n            </div>\r\n            \r\n            <div class=\"glass border border-border rounded-xl p-5 glow-hover\">\r\n                <div class=\"flex items-start justify-between mb-3\">\r\n                    <div class=\"w-10 h-10 rounded-lg bg-yellow-500/10 flex items-center justify-center\">\r\n                        <svg class=\"w-5 h-5 text-yellow-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <span id=\"stat-alerts-change\" class=\"text-sm font-medium text-red-500\">${stats.activeAlerts.change}</span>\r\n                </div>\r\n                <p class=\"font-heading text-2xl font-bold text-foreground\"><span id=\"stat-alerts-value\">${stats.activeAlerts.value}</span></p>\r\n                <p class=\"text-sm text-muted-foreground\">Active Alerts</p>\r\n            </div>\r\n        </div>\r\n        \r\n        <!-- Chart & Status Grid -->\r\n        <div class=\"grid lg:grid-cols-3 gap-6 mb-6\">\r\n            <!-- Chart -->\r\n            <div class=\"lg:col-span-2 glass border border-border rounded-xl p-6\">\r\n                <div class=\"flex items-center justify-between mb-4\">\r\n                    <div class=\"flex items-center gap-2\">\r\n                        <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z\" />\r\n                        </svg>\r\n                        <h2 class=\"font-heading font-semibold text-lg text-foreground\">Production & Distribution</h2>\r\n                    </div>\r\n                    <div class=\"flex items-center gap-2\">\r\n                        <button id=\"chart-toggle\" class=\"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-secondary/50 hover:bg-secondary rounded-lg\">\r\n                            <span>Line</span>\r\n                        </button>\r\n                        <div class=\"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-primary/10 text-primary rounded-lg\">\r\n                            <div class=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\"></div>\r\n                            <span>Live</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"h-64 md:h-72\">\r\n                    <canvas id=\"dashboard-chart\"></canvas>\r\n                </div>\r\n                <div class=\"flex flex-wrap justify-center gap-6 mt-4 pt-4 border-t border-border/50\">\r\n                    <div class=\"flex items-center gap-2\"><div class=\"w-3 h-3 rounded-full bg-green-500\"></div><span class=\"text-xs text-muted-foreground\">Production</span></div>\r\n                    <div class=\"flex items-center gap-2\"><div class=\"w-3 h-3 rounded-full bg-blue-500\"></div><span class=\"text-xs text-muted-foreground\">Distribution</span></div>\r\n                    <div class=\"flex items-center gap-2\"><div class=\"w-3 h-3 rounded-full bg-yellow-500\"></div><span class=\"text-xs text-muted-foreground\">Target</span></div>\r\n                </div>\r\n            </div>\r\n            \r\n            <!-- Live Status -->\r\n            <div class=\"glass border border-border rounded-xl p-6\">\r\n                <div class=\"flex items-center gap-2 mb-4\">\r\n                    <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                    </svg>\r\n                    <h2 class=\"font-heading font-semibold text-lg text-foreground\">Live Status</h2>\r\n                </div>\r\n                <div class=\"space-y-3\">\r\n                    <!-- Mine Site A -->\r\n                    <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border/50\">\r\n                        <div class=\"flex items-center gap-3\">\r\n                            <div class=\"w-8 h-8 rounded-full bg-green-500/10 flex items-center justify-center\">\r\n                                <svg class=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" /></svg>\r\n                            </div>\r\n                            <span class=\"text-sm font-medium\">Mine Site A</span>\r\n                        </div>\r\n                        <span id=\"mine-a-status\" class=\"px-2.5 py-1 text-xs font-medium rounded-full bg-green-500/10 text-green-500 border border-green-500/30\">Active</span>\r\n                    </div>\r\n                    \r\n                    <!-- Mine Site B -->\r\n                    <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border/50\">\r\n                        <div class=\"flex items-center gap-3\">\r\n                            <div class=\"w-8 h-8 rounded-full bg-yellow-500/10 flex items-center justify-center\">\r\n                                <svg class=\"w-4 h-4 text-yellow-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" /></svg>\r\n                            </div>\r\n                            <span class=\"text-sm font-medium\">Mine Site B</span>\r\n                        </div>\r\n                        <span id=\"mine-b-status\" class=\"px-2.5 py-1 text-xs font-medium rounded-full bg-yellow-500/10 text-yellow-500 border border-yellow-500/30\">Weather Alert</span>\r\n                    </div>\r\n                    \r\n                    <!-- Fleet Status -->\r\n                    <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border/50\">\r\n                        <div class=\"flex items-center gap-3\">\r\n                            <div class=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                                <svg class=\"w-4 h-4 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4\" /></svg>\r\n                            </div>\r\n                            <span class=\"text-sm font-medium\">Fleet Status</span>\r\n                        </div>\r\n                        <span id=\"fleet-status\" class=\"px-2.5 py-1 text-xs font-medium rounded-full bg-primary/10 text-primary border border-primary/30\">${fleet.active}/${fleet.total} Active</span>\r\n                    </div>\r\n                    \r\n                    <!-- Weather Widget -->\r\n                    <div class=\"flex items-center justify-between p-3 bg-secondary/30 rounded-lg border border-border/50\">\r\n                        <div class=\"flex items-center gap-3\">\r\n                            <div class=\"w-8 h-8 rounded-full bg-blue-500/10 flex items-center justify-center\">\r\n                                <svg class=\"w-4 h-4 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z\" />\r\n                                </svg>\r\n                            </div>\r\n                            <div>\r\n                                <span class=\"text-sm font-medium\">Weather</span>\r\n                                <div class=\"text-xs text-muted-foreground\">\r\n                                    <span id=\"weather-condition\">${weather.condition}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"text-right\">\r\n                            <span id=\"weather-temp\" class=\"text-lg font-bold text-foreground\">${weather.temperature || '--'}C</span>\r\n                            <div class=\"text-xs text-muted-foreground\">\r\n                                 <span id=\"weather-rainfall\">${weather.rainfall || 0}mm</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n        <!-- AI Recommendations -->\r\n        <div class=\"glass border border-border rounded-xl p-6 border-glow\">\r\n            <div class=\"flex items-center gap-2 mb-4\">\r\n                <svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                </svg>\r\n                <h2 class=\"font-heading font-semibold text-lg text-foreground\">AI Recommendations</h2>\r\n            </div>\r\n            <div id=\"recommendations-grid\" class=\"grid md:grid-cols-3 gap-4\">\r\n                <!-- Recommendations will be loaded here -->\r\n            </div>\r\n        </div>\r\n        \r\n    </div>\r\n</div>\r\n`;\r\n};\r\n\r\n// Store clean up function reference\r\nlet routeCleanupFn = null;\r\n\r\n// ============================================\r\n// PAGE HANDLER\r\n// ============================================\r\nexport const dashboardPage = async () => {\r\n    // Remove previous event listener if exists\r\n    if (routeCleanupFn) {\r\n        routeCleanupFn();\r\n        routeCleanupFn = null;\r\n    }\r\n\r\n    // Cleanup previous state\r\n    cleanup();\r\n\r\n    // Render template\r\n    await App.View.render(template(), 'dashboard');\r\n\r\n    // Initialize after render with proper loading order\r\n    setTimeout(async () => {\r\n        // First: Check AI status\r\n        checkAIHealth();\r\n\r\n        // Second: Load base data that recommendations depend on\r\n        await Promise.all([\r\n            loadProductionStats(),\r\n            loadWeatherData(),\r\n            loadFleetStatus(),\r\n            loadMinesStatus()\r\n        ]);\r\n\r\n        // Third: Load AI recommendations (after stats and fleet are loaded)\r\n        loadAIRecommendations();\r\n\r\n        // Initialize chart\r\n        initChart();\r\n\r\n        // Start periodic refresh\r\n        startDataRefresh();\r\n    }, 100);\r\n\r\n    // Listen for page change to cleanup\r\n    routeCleanupFn = EventBus.on('routeChanged', (route) => {\r\n        if (route !== 'dashboard') {\r\n            cleanup();\r\n            if (routeCleanupFn) {\r\n                routeCleanupFn();\r\n                routeCleanupFn = null;\r\n            }\r\n        }\r\n    });\r\n};\r\n","/**\r\n * OptiMine SPA - Router\r\n * Hash-based routing for SPA navigation\r\n */\r\n\r\nimport { Config } from '../../config.js';\r\nimport { EventBus } from '../utils/index.js';\r\nimport { homePage } from '../pages/home/home-page.js';\r\nimport { aboutPage } from '../pages/about/about-page.js';\r\nimport { aiToolsPage } from '../pages/ai-tools/ai-tools-page.js';\r\nimport { planningPage } from '../pages/planning/planning-page.js';\r\nimport { authPage } from '../pages/auth/auth-page.js';\r\nimport { resetPasswordPage } from '../pages/auth/reset-password-page.js';\r\nimport { dashboardPage } from '../pages/dashboard/dashboard-page.js';\r\n\r\n// Routes registry\r\nconst routes = {};\r\n\r\n// Current route state\r\nlet currentRoute = null;\r\n\r\n/**\r\n * Router module\r\n */\r\nexport const Router = {\r\n    /**\r\n     * Initialize router\r\n     */\r\n    init() {\r\n        // Register default routes\r\n        this.register('home', homePage);\r\n        this.register('planning', planningPage);\r\n        this.register('ai-tools', aiToolsPage);\r\n        this.register('dashboard', dashboardPage);\r\n        this.register('auth', authPage);\r\n        this.register('profile', aboutPage);\r\n        this.register('reset-password', resetPasswordPage);\r\n\r\n        // Listen for hash changes\r\n        window.addEventListener('hashchange', () => this.handleRouteChange());\r\n\r\n        // Handle initial route\r\n        this.handleRouteChange();\r\n\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Register a route\r\n     * @param {string} path - Route path\r\n     * @param {Function} handler - Route handler function\r\n     */\r\n    register(path, handler) {\r\n        routes[path] = handler;\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * Navigate to a route\r\n     * @param {string} path - Route path\r\n     */\r\n    navigate(path) {\r\n        window.location.hash = path;\r\n    },\r\n\r\n    /**\r\n     * Handle route change\r\n     */\r\n    async handleRouteChange() {\r\n        const hash = window.location.hash.slice(1) || Config.routes.default;\r\n        const [routePath, queryString] = hash.split('?');\r\n\r\n        // Check if route is protected\r\n        if (Config.routes.protected.includes(routePath)) {\r\n            const isLoggedIn = localStorage.getItem(Config.storage.isLoggedIn) === 'true';\r\n            if (!isLoggedIn) {\r\n                // Save intended destination for after login\r\n                localStorage.setItem('optimine-redirect', routePath);\r\n                // Redirect to SPA auth page (consistent UI)\r\n                this.navigate('auth');\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Get route handler\r\n        const handler = routes[routePath];\r\n\r\n        if (handler) {\r\n            currentRoute = routePath;\r\n\r\n            // Parse query params\r\n            const params = this.parseQuery(queryString);\r\n\r\n            // Execute handler\r\n            await handler(params);\r\n\r\n            // Update active nav\r\n            this.updateActiveNav(routePath);\r\n        } else {\r\n            // 404 - redirect to home\r\n            this.navigate(Config.routes.default);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Parse query string\r\n     * @param {string} queryString \r\n     * @returns {Object}\r\n     */\r\n    parseQuery(queryString) {\r\n        if (!queryString) return {};\r\n\r\n        const params = {};\r\n        const pairs = queryString.split('&');\r\n\r\n        pairs.forEach(pair => {\r\n            const [key, value] = pair.split('=');\r\n            params[decodeURIComponent(key)] = decodeURIComponent(value || '');\r\n        });\r\n\r\n        return params;\r\n    },\r\n\r\n    /**\r\n     * Update active navigation link\r\n     * @param {string} route \r\n     */\r\n    updateActiveNav(route) {\r\n        // Desktop nav\r\n        document.querySelectorAll('.spa-nav-link').forEach(link => {\r\n            const linkRoute = link.getAttribute('href')?.replace('#', '');\r\n            link.classList.toggle('active', linkRoute === route);\r\n        });\r\n\r\n        // Mobile nav\r\n        document.querySelectorAll('.spa-mobile-nav-link').forEach(link => {\r\n            const linkRoute = link.getAttribute('href')?.replace('#', '');\r\n            link.classList.toggle('active', linkRoute === route);\r\n        });\r\n\r\n        // Close mobile menu\r\n        const mobileMenu = document.getElementById('mobile-menu');\r\n        mobileMenu?.classList.add('hidden');\r\n\r\n        // Emit event\r\n        EventBus.emit('routeChanged', route);\r\n    },\r\n\r\n    /**\r\n     * Get current route\r\n     * @returns {string}\r\n     */\r\n    getCurrentRoute() {\r\n        return currentRoute;\r\n    }\r\n};\r\n","/**\r\n * OptiMine SPA - Main Application\r\n * MVP Architecture: Presenter Layer\r\n */\r\n\r\nimport { Config } from '../config.js';\r\nimport { Router } from './routes/routes.js';\r\nimport { EventBus } from './utils/index.js';\r\n\r\n// ============================================\r\n// MODEL - State Management\r\n// ============================================\r\nconst Model = {\r\n    state: {\r\n        user: null,\r\n        isAuthenticated: false,\r\n        theme: Config.defaults.theme,\r\n        language: Config.defaults.language,\r\n        currentRoute: null,\r\n        isLoading: false\r\n    },\r\n\r\n    init() {\r\n        // Load persisted state\r\n        this.state.theme = localStorage.getItem(Config.storage.theme) || Config.defaults.theme;\r\n        this.state.language = localStorage.getItem(Config.storage.language) || Config.defaults.language;\r\n        this.state.isAuthenticated = localStorage.getItem(Config.storage.isLoggedIn) === 'true';\r\n\r\n        const savedUser = localStorage.getItem(Config.storage.user);\r\n        if (savedUser) {\r\n            try {\r\n                this.state.user = JSON.parse(savedUser);\r\n            } catch (e) {\r\n                this.state.user = null;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    getState(key) {\r\n        return key ? this.state[key] : this.state;\r\n    },\r\n\r\n    setState(key, value) {\r\n        this.state[key] = value;\r\n        EventBus.emit('stateChanged', { key, value });\r\n        return this;\r\n    },\r\n\r\n    // Auth methods\r\n    login(user) {\r\n        this.state.user = user;\r\n        this.state.isAuthenticated = true;\r\n        localStorage.setItem(Config.storage.user, JSON.stringify(user));\r\n        localStorage.setItem(Config.storage.isLoggedIn, 'true');\r\n        EventBus.emit('authChanged', { isAuthenticated: true, user });\r\n        return this;\r\n    },\r\n\r\n    logout() {\r\n        this.state.user = null;\r\n        this.state.isAuthenticated = false;\r\n        localStorage.removeItem(Config.storage.user);\r\n        localStorage.removeItem(Config.storage.token);\r\n        localStorage.setItem(Config.storage.isLoggedIn, 'false');\r\n        EventBus.emit('authChanged', { isAuthenticated: false, user: null });\r\n        return this;\r\n    },\r\n\r\n    // Theme methods\r\n    setTheme(theme) {\r\n        this.state.theme = theme;\r\n        localStorage.setItem(Config.storage.theme, theme);\r\n        document.documentElement.classList.toggle('dark', theme === 'dark');\r\n        EventBus.emit('themeChanged', theme);\r\n        return this;\r\n    },\r\n\r\n    toggleTheme() {\r\n        const newTheme = this.state.theme === 'dark' ? 'light' : 'dark';\r\n        return this.setTheme(newTheme);\r\n    },\r\n\r\n    // Language methods\r\n    setLanguage(lang) {\r\n        this.state.language = lang;\r\n        localStorage.setItem(Config.storage.language, lang);\r\n        EventBus.emit('languageChanged', lang);\r\n        return this;\r\n    }\r\n};\r\n\r\n// ============================================\r\n// VIEW - DOM Manipulation\r\n// ============================================\r\nconst View = {\r\n    elements: {\r\n        content: null,\r\n        navbar: null,\r\n        toastContainer: null\r\n    },\r\n\r\n    init() {\r\n        this.elements.content = document.getElementById('spa-content');\r\n        this.elements.navbar = document.getElementById('header');\r\n        this.elements.toastContainer = document.getElementById('toast-container');\r\n\r\n        // Apply initial theme\r\n        document.documentElement.classList.toggle('dark', Model.getState('theme') === 'dark');\r\n\r\n        return this;\r\n    },\r\n\r\n    // Render content with smooth CSS animation (no overlay)\r\n    async render(html, routeName) {\r\n        // Ensure content element is available\r\n        if (!this.elements.content) {\r\n            this.elements.content = document.getElementById('spa-content');\r\n        }\r\n\r\n        const { content } = this.elements;\r\n\r\n        if (!content) {\r\n            console.error('SPA content element not found');\r\n            return;\r\n        }\r\n\r\n        // Check if this is initial render (content is empty)\r\n        const isInitialRender = content.innerHTML.trim() === '';\r\n\r\n        if (!isInitialRender) {\r\n            // Start exit animation (fade out) only if not initial render\r\n            content.classList.add('page-exit');\r\n            content.classList.add('page-exit-active');\r\n\r\n            await this.delay(200); // Exit animation duration\r\n        }\r\n\r\n        // Update content\r\n        content.innerHTML = html;\r\n\r\n        // Remove exit classes\r\n        content.classList.remove('page-exit', 'page-exit-active');\r\n\r\n        // Start enter animation (fade in + slide up)\r\n        content.classList.add('page-enter');\r\n\r\n        // Force reflow\r\n        void content.offsetWidth;\r\n\r\n        content.classList.add('page-enter-active');\r\n\r\n        // Notify route changed\r\n        EventBus.emit('routeChanged', routeName);\r\n\r\n        await this.delay(500); // Enter animation duration\r\n\r\n        // Cleanup\r\n        content.classList.remove('page-enter', 'page-enter-active');\r\n\r\n        // Re-init icons\r\n        if (window.lucide) {\r\n            window.lucide.createIcons();\r\n        }\r\n    },\r\n\r\n    // Update auth UI\r\n    updateAuthUI(isAuthenticated, user) {\r\n        const authBtn = document.getElementById('nav-auth-btn');\r\n        const userMenu = document.getElementById('nav-user-menu');\r\n        const userInitial = document.getElementById('nav-user-initial');\r\n        const userName = document.getElementById('nav-user-name');\r\n        const userEmail = document.getElementById('nav-user-email');\r\n\r\n        if (isAuthenticated && user) {\r\n            authBtn?.classList.add('hidden');\r\n            userMenu?.classList.remove('hidden');\r\n            if (userInitial) userInitial.textContent = (user.name || 'U').charAt(0).toUpperCase();\r\n            if (userName) userName.textContent = user.name || 'User';\r\n            if (userEmail) userEmail.textContent = user.email || '';\r\n        } else {\r\n            authBtn?.classList.remove('hidden');\r\n            userMenu?.classList.add('hidden');\r\n        }\r\n    },\r\n\r\n    // Show toast notification\r\n    showToast(message, type = 'info', duration = 3000) {\r\n        const container = this.elements.toastContainer;\r\n        if (!container) return;\r\n\r\n        const icons = {\r\n            success: 'check-circle',\r\n            error: 'x-circle',\r\n            warning: 'alert-triangle',\r\n            info: 'info'\r\n        };\r\n\r\n        const toast = document.createElement('div');\r\n        toast.className = `spa-toast ${type}`;\r\n        toast.innerHTML = `\r\n            <i data-lucide=\"${icons[type]}\" class=\"spa-toast-icon\"></i>\r\n            <span class=\"spa-toast-message\">${message}</span>\r\n        `;\r\n\r\n        container.appendChild(toast);\r\n\r\n        if (window.lucide) {\r\n            window.lucide.createIcons();\r\n        }\r\n\r\n        setTimeout(() => {\r\n            toast.classList.add('exiting');\r\n            setTimeout(() => toast.remove(), 300);\r\n        }, duration);\r\n    },\r\n\r\n    // Hide navbar (for auth page)\r\n    hideNavbar() {\r\n        if (this.elements.navbar) {\r\n            this.elements.navbar.classList.add('hidden');\r\n        }\r\n        // Also hide footer if exists\r\n        const footer = document.getElementById('footer');\r\n        if (footer) {\r\n            footer.classList.add('hidden');\r\n        }\r\n    },\r\n\r\n    // Show navbar\r\n    showNavbar() {\r\n        if (this.elements.navbar) {\r\n            this.elements.navbar.classList.remove('hidden');\r\n        }\r\n        // Also show footer\r\n        const footer = document.getElementById('footer');\r\n        if (footer) {\r\n            footer.classList.remove('hidden');\r\n        }\r\n    },\r\n\r\n    // Utility delay\r\n    delay(ms) {\r\n        return new Promise(resolve => setTimeout(resolve, ms));\r\n    }\r\n};\r\n\r\n// ============================================\r\n// PRESENTER - Business Logic\r\n// ============================================\r\nconst Presenter = {\r\n    init() {\r\n        this.setupEventListeners();\r\n        return this;\r\n    },\r\n\r\n    setupEventListeners() {\r\n        // Auth state changes\r\n        EventBus.on('authChanged', ({ isAuthenticated, user }) => {\r\n            View.updateAuthUI(isAuthenticated, user);\r\n            if (!isAuthenticated) {\r\n                Router.navigate('home');\r\n            }\r\n        });\r\n\r\n        // Theme changes\r\n        EventBus.on('themeChanged', (theme) => {\r\n            console.log('Theme changed:', theme);\r\n        });\r\n    },\r\n\r\n    // Handle login\r\n    async handleLogin(email, password) {\r\n        try {\r\n            // Call real API\r\n            const response = await fetch('http://139.59.224.58:5000/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({ email, password })\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (!response.ok || result.error) {\r\n                throw new Error(result.message || 'Login gagal');\r\n            }\r\n\r\n            const user = {\r\n                id: result.data.id,\r\n                name: result.data.nama,\r\n                email: email,\r\n                role: result.data.role,\r\n                token: result.data.token\r\n            };\r\n\r\n            // Save token to localStorage\r\n            localStorage.setItem('optimine-token', result.data.token);\r\n\r\n            Model.login(user);\r\n            View.showToast('Login berhasil!', 'success');\r\n\r\n            setTimeout(() => {\r\n                Router.navigate('home');\r\n            }, 500);\r\n\r\n            return true;\r\n        } catch (error) {\r\n            View.showToast('Login gagal: ' + error.message, 'error');\r\n            return false;\r\n        }\r\n    },\r\n\r\n    // Handle register\r\n    async handleRegister(name, email, password, role) {\r\n        try {\r\n            // Call real API for registration\r\n            const registerResponse = await fetch('http://139.59.224.58:5000/register', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    nama: name,\r\n                    email,\r\n                    password,\r\n                    role: role || 'admin'\r\n                })\r\n            });\r\n\r\n            const registerResult = await registerResponse.json();\r\n            console.log('Register response:', registerResult);\r\n\r\n            if (!registerResponse.ok || registerResult.error) {\r\n                throw new Error(registerResult.message || 'Registrasi gagal');\r\n            }\r\n\r\n            // Auto login after successful registration\r\n            const loginResponse = await fetch('http://139.59.224.58:5000/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({ email, password })\r\n            });\r\n\r\n            const loginResult = await loginResponse.json();\r\n\r\n            if (loginResponse.ok && !loginResult.error) {\r\n                const user = {\r\n                    id: loginResult.data.id,\r\n                    name: loginResult.data.nama,\r\n                    email: email,\r\n                    role: loginResult.data.role,\r\n                    token: loginResult.data.token\r\n                };\r\n\r\n                // Save token to localStorage\r\n                localStorage.setItem('optimine-token', loginResult.data.token);\r\n\r\n                Model.login(user);\r\n            } else {\r\n                // If auto-login fails, just create user object from registration data\r\n                const user = {\r\n                    id: Date.now(),\r\n                    name: name,\r\n                    email: email,\r\n                    role: role || 'admin'\r\n                };\r\n                Model.login(user);\r\n            }\r\n\r\n            View.showToast('Registrasi berhasil!', 'success');\r\n\r\n            setTimeout(() => {\r\n                Router.navigate('home');\r\n            }, 500);\r\n\r\n            return true;\r\n        } catch (error) {\r\n            View.showToast('Registrasi gagal: ' + error.message, 'error');\r\n            return false;\r\n        }\r\n    },\r\n\r\n    // Handle logout\r\n    handleLogout() {\r\n        Model.logout();\r\n        View.showToast('Logout berhasil', 'info');\r\n    }\r\n};\r\n\r\n// ============================================\r\n// APP - Main Application\r\n// ============================================\r\nexport const App = {\r\n    Model,\r\n    View,\r\n    Presenter,\r\n\r\n    init() {\r\n        Model.init();\r\n        View.init();\r\n        Presenter.init();\r\n\r\n        // Update auth UI on init\r\n        View.updateAuthUI(Model.getState('isAuthenticated'), Model.getState('user'));\r\n\r\n        console.log('App initialized');\r\n        return this;\r\n    }\r\n};\r\n\r\n// Export individual modules\r\nexport { Model, View, Presenter };\r\n","/**\r\n * OptiMine SPA - Main Entry Point\r\n * Using Webpack bundler with MVP Architecture\r\n */\r\n\r\nimport { App } from './scripts/app.js';\r\nimport { Router } from './scripts/routes/routes.js';\r\nimport { EventBus, LanguageManager } from './scripts/utils/index.js';\r\nimport { t, getSection } from './scripts/utils/translations.js';\r\nimport './styles/styles.css';\r\n\r\n/**\r\n * Update UI text based on current language\r\n */\r\nconst updateLanguageUI = (lang) => {\r\n    const nav = getSection(lang, 'nav');\r\n    \r\n    // Update Desktop Navigation Links\r\n    document.querySelectorAll('.nav-link[data-page]').forEach(link => {\r\n        const page = link.dataset.page;\r\n        const span = link.querySelector('span');\r\n        if (span) {\r\n            if (page === 'home') span.textContent = nav.home;\r\n            if (page === 'planning') span.textContent = nav.planning;\r\n            if (page === 'ai-tools') span.textContent = nav.aiTools;\r\n            if (page === 'dashboard') span.textContent = nav.dashboard;\r\n        }\r\n    });\r\n    \r\n    // Update Mobile Navigation Links\r\n    document.querySelectorAll('.mobile-nav-link[data-page]').forEach(link => {\r\n        const page = link.dataset.page;\r\n        const span = link.querySelector('span');\r\n        if (span) {\r\n            if (page === 'home') span.textContent = nav.home;\r\n            if (page === 'planning') span.textContent = nav.planning;\r\n            if (page === 'ai-tools') span.textContent = nav.aiTools;\r\n            if (page === 'dashboard') span.textContent = nav.dashboard;\r\n        }\r\n    });\r\n    \r\n    // Update Login/Profile button text\r\n    const loginBtnText = document.querySelector('#loginBtn span');\r\n    const mobileLoginBtnText = document.querySelector('#mobileLoginBtn span');\r\n    if (loginBtnText) loginBtnText.textContent = nav.login;\r\n    if (mobileLoginBtnText) mobileLoginBtnText.textContent = nav.login;\r\n    \r\n    // Update active language indicator in dropdown\r\n    document.querySelectorAll('.lang-option').forEach(btn => {\r\n        const isActive = btn.dataset.lang === lang;\r\n        btn.classList.toggle('bg-primary', isActive);\r\n        btn.classList.toggle('text-primary-foreground', isActive);\r\n        btn.classList.toggle('shadow-lg', isActive);\r\n        // Remove hover effect for active\r\n        if (isActive) {\r\n            btn.classList.remove('hover:bg-primary/10');\r\n        } else {\r\n            btn.classList.add('hover:bg-primary/10');\r\n        }\r\n    });\r\n    \r\n    document.querySelectorAll('.lang-option-mobile').forEach(btn => {\r\n        const isActive = btn.dataset.lang === lang;\r\n        btn.classList.toggle('bg-primary', isActive);\r\n        btn.classList.toggle('text-primary-foreground', isActive);\r\n        btn.classList.toggle('bg-secondary/50', !isActive);\r\n    });\r\n};\r\n\r\n/**\r\n * Setup Navbar Event Handlers\r\n */\r\nconst setupNavbarHandlers = () => {\r\n    // Theme Toggle\r\n    const themeToggle = document.getElementById('theme-toggle');\r\n    themeToggle?.addEventListener('click', () => {\r\n        App.Model.toggleTheme();\r\n    });\r\n    \r\n    // Language Dropdown\r\n    const langToggle = document.getElementById('lang-toggle');\r\n    const langDropdown = document.getElementById('lang-dropdown');\r\n    \r\n    langToggle?.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        langDropdown?.classList.toggle('hidden');\r\n    });\r\n    \r\n    // Language Options (Desktop)\r\n    document.querySelectorAll('.lang-option').forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            const lang = btn.dataset.lang;\r\n            App.Model.setLanguage(lang);\r\n            langDropdown?.classList.add('hidden');\r\n            updateLanguageUI(lang);\r\n            // Re-render current page to apply translations\r\n            Router.handleRouteChange();\r\n        });\r\n    });\r\n    \r\n    // Mobile Language Options\r\n    document.querySelectorAll('.lang-option-mobile').forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            const lang = btn.dataset.lang;\r\n            App.Model.setLanguage(lang);\r\n            updateLanguageUI(lang);\r\n            // Re-render current page to apply translations\r\n            Router.handleRouteChange();\r\n        });\r\n    });\r\n    \r\n    // Mobile Menu Toggle\r\n    const mobileMenuBtn = document.getElementById('mobile-menu-btn');\r\n    const mobileMenu = document.getElementById('mobile-menu');\r\n    const menuIcon = document.getElementById('menu-icon');\r\n    const closeIcon = document.getElementById('close-icon');\r\n    \r\n    mobileMenuBtn?.addEventListener('click', () => {\r\n        const isOpen = !mobileMenu?.classList.contains('hidden');\r\n        mobileMenu?.classList.toggle('hidden', isOpen);\r\n        menuIcon?.classList.toggle('hidden', !isOpen);\r\n        closeIcon?.classList.toggle('hidden', isOpen);\r\n    });\r\n    \r\n    // Close mobile menu when clicking nav links\r\n    document.querySelectorAll('.mobile-nav-link').forEach(link => {\r\n        link.addEventListener('click', () => {\r\n            mobileMenu?.classList.add('hidden');\r\n            menuIcon?.classList.remove('hidden');\r\n            closeIcon?.classList.add('hidden');\r\n        });\r\n    });\r\n    \r\n    // Close language dropdown when clicking outside\r\n    document.addEventListener('click', (e) => {\r\n        if (!langToggle?.contains(e.target) && !langDropdown?.contains(e.target)) {\r\n            langDropdown?.classList.add('hidden');\r\n        }\r\n    });\r\n    \r\n    // Apply initial language\r\n    const currentLang = App.Model.getState('language') || 'id';\r\n    updateLanguageUI(currentLang);\r\n};\r\n\r\n/**\r\n * Update Navigation Active State\r\n */\r\nconst updateNavActiveState = (route) => {\r\n    // Desktop nav links\r\n    document.querySelectorAll('.nav-link').forEach(link => {\r\n        const page = link.dataset.page;\r\n        link.classList.toggle('active', page === route);\r\n    });\r\n    \r\n    // Mobile nav links\r\n    document.querySelectorAll('.mobile-nav-link').forEach(link => {\r\n        const page = link.dataset.page;\r\n        link.classList.toggle('active', page === route);\r\n    });\r\n};\r\n\r\n/**\r\n * Update Auth UI State\r\n */\r\nconst updateAuthUI = () => {\r\n    const isLoggedIn = App.Model.getState('isAuthenticated');\r\n    const user = App.Model.getState('user');\r\n    \r\n    const loginBtn = document.getElementById('loginBtn');\r\n    const profileBtn = document.getElementById('profileBtn');\r\n    const mobileLoginBtn = document.getElementById('mobileLoginBtn');\r\n    const mobileProfileBtn = document.getElementById('mobileProfileBtn');\r\n    \r\n    if (isLoggedIn && user) {\r\n        loginBtn?.classList.add('hidden');\r\n        profileBtn?.classList.remove('hidden');\r\n        profileBtn?.classList.add('flex');\r\n        mobileLoginBtn?.classList.add('hidden');\r\n        mobileProfileBtn?.classList.remove('hidden');\r\n        mobileProfileBtn?.classList.add('flex');\r\n        \r\n        // Update user info\r\n        const initial = (user.name || 'U').charAt(0).toUpperCase();\r\n        document.querySelectorAll('.user-initial').forEach(el => el.textContent = initial);\r\n        document.querySelectorAll('.user-name').forEach(el => el.textContent = user.name || 'User');\r\n    } else {\r\n        loginBtn?.classList.remove('hidden');\r\n        loginBtn?.classList.add('flex');\r\n        profileBtn?.classList.add('hidden');\r\n        profileBtn?.classList.remove('flex');\r\n        mobileLoginBtn?.classList.remove('hidden');\r\n        mobileLoginBtn?.classList.add('flex');\r\n        mobileProfileBtn?.classList.add('hidden');\r\n        mobileProfileBtn?.classList.remove('flex');\r\n    }\r\n};\r\n\r\n/**\r\n * Show Toast Notification\r\n */\r\nconst showToast = (message, type = 'info', duration = 3000) => {\r\n    const container = document.getElementById('toast-container');\r\n    if (!container) return;\r\n    \r\n    const icons = {\r\n        success: `<svg class=\"w-5 h-5 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>`,\r\n        error: `<svg class=\"w-5 h-5 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>`,\r\n        info: `<svg class=\"w-5 h-5 text-primary\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path></svg>`\r\n    };\r\n    \r\n    const toast = document.createElement('div');\r\n    toast.className = `toast ${type}`;\r\n    toast.innerHTML = `${icons[type] || icons.info}<span>${message}</span>`;\r\n    \r\n    container.appendChild(toast);\r\n    \r\n    setTimeout(() => {\r\n        toast.style.opacity = '0';\r\n        toast.style.transform = 'translateX(100%)';\r\n        toast.style.transition = 'all 0.3s ease';\r\n        setTimeout(() => toast.remove(), 300);\r\n    }, duration);\r\n};\r\n\r\n// Make showToast globally available\r\nwindow.showToast = showToast;\r\n\r\n// Make translation function globally available\r\nwindow.t = t;\r\nwindow.getSection = getSection;\r\nwindow.updateLanguageUI = updateLanguageUI;\r\n\r\n// Make LanguageManager globally available\r\nwindow.LanguageManager = LanguageManager;\r\n\r\n// Initialize app when DOM ready\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    // Initialize App FIRST (before Router)\r\n    App.init();\r\n    \r\n    // Initialize LanguageManager\r\n    LanguageManager.init();\r\n    \r\n    // Setup Navbar Handlers\r\n    setupNavbarHandlers();\r\n    \r\n    // Update Auth UI\r\n    updateAuthUI();\r\n    \r\n    // Listen for route changes\r\n    EventBus.on('routeChanged', updateNavActiveState);\r\n    \r\n    // Listen for auth changes\r\n    EventBus.on('authChanged', updateAuthUI);\r\n    \r\n    // Listen for language changes - re-render current page\r\n    EventBus.on('languageChanged', (lang) => {\r\n        updateLanguageUI(lang);\r\n        // Re-render current page to update content\r\n        const currentRoute = Router.getCurrentRoute();\r\n        if (currentRoute) {\r\n            Router.navigate(currentRoute);\r\n        }\r\n    });\r\n    \r\n    // Subscribe LanguageManager to re-render on language change\r\n    LanguageManager.subscribe((lang) => {\r\n        const currentRoute = Router.getCurrentRoute();\r\n        if (currentRoute) {\r\n            Router.navigate(currentRoute);\r\n        }\r\n    });\r\n    \r\n    // Initialize Router LAST (so it can render initial route)\r\n    Router.init();\r\n    \r\n    console.log('OptiMine SPA initialized');\r\n});\r\n\r\n// Export for global access if needed\r\nwindow.OptiMine = {\r\n    App,\r\n    Router,\r\n    showToast\r\n};\r\n"],"names":["Config","appName","version","api","baseUrl","timeout","routes","default","protected","public","transition","duration","type","storage","theme","language","user","token","isLoggedIn","defaults","translations","en","nav","home","planning","aiTools","dashboard","login","profile","logout","welcomeBack","subtitle","activeSites","fleetUnits","efficiency","quickAccess","aiScenario","aiScenarioDesc","aiChatbot","aiChatbotDesc","opsDashboard","opsDashboardDesc","accessDashboard","aiPoweredAnalysis","realtimeMonitoring","riskMitigation","costOptimization","title","weatherConditions","rainfallLevel","low","high","waveHeight","calm","rough","fleetStatus","activeVehicles","maintenanceStatus","fleetAvailability","truckCount","excavatorCount","shipSchedule","vesselName","estimatedArrival","cargoCapacity","addVessel","generatePlan","systemStatus","aiSystemOnline","n8nReady","activeAlerts","alertRainfall","alertMaintenance","weatherData","connected","fleetTracking","online","aiEngine","ready","lastUpdate","justNow","active","aiOnline","responseTime","suggestedPrompts","prompt1","prompt2","prompt3","integration","integrationDesc","connectedSystems","weather","fleet","shipping","placeholder","greeting","totalProduction","fromLastMonth","activeEquipment","outOfTotal","efficiencyRate","target","costSavings","thisQuarter","productionTrends","equipmentStatus","chartPlaceholder","statusPlaceholder","auth","register","email","password","confirmPassword","fullName","role","forgotPassword","signIn","createAccount","resetPassword","resetDesc","sendResetLink","backToLogin","miningPlanner","shippingPlanner","passwordRequirements","minLength","uppercase","number","weak","medium","fair","strong","passwordError","passwordMismatch","accountInfo","displayName","preferences","darkMode","useDarkTheme","selectLanguage","signOut","dark","light","common","loading","error","success","save","cancel","confirm","delete","edit","view","search","noData","languageChanged","copyright","privacy","terms","contact","id","getSection","lang","section","constructor","this","currentLanguage","getSavedLanguage","listeners","isInitialized","saved","localStorage","getItem","navigator","toLowerCase","startsWith","init","setLanguage","setupLanguageSwitcher","console","log","t","translate","path","keys","split","result","key","undefined","warn","notify","setItem","document","documentElement","setAttribute","updateAllTranslations","updateLanguageIndicator","notifyListeners","toggleLanguage","newLang","querySelectorAll","forEach","element","getAttribute","translation","textContent","indicator","toUpperCase","button","isActive","classList","toggle","btn","dataset","addEventListener","e","closest","preventDefault","langBtn","langOption","subscribe","callback","push","filter","cb","$","EventBus","events","on","event","off","emit","data","once","wrapper","animate","fadeIn","style","opacity","display","start","step","timestamp","progress","Math","min","requestAnimationFrame","fadeOut","slideDown","height","overflow","targetHeight","scrollHeight","slideUp","startHeight","typewriter","text","speed","borderRight","animation","index","length","charAt","setTimeout","typewriterWelcome","welcomeText","userName","innerHTML","welcomeSpan","createElement","className","userSpan","appendChild","add","welcomeIndex","userIndex","typeWelcome","typeUser","remove","countUp","suffix","startTime","performance","now","updateCount","currentTime","elapsed","easedProgress","pow","currentValue","floor","initStatCounters","delay","parseInt","initTypewriter","welcomeElement","getElementById","userData","JSON","parse","name","nama","getUserName","homePage","async","App","View","render","Model","getState","template","BASE_URL","request","endpoint","options","url","defaultHeaders","config","headers","response","fetch","json","ok","Error","message","get","method","post","body","stringify","put","API","credentials","newPassword","chat","chatInput","Date","toISOString","userId","responseText","parseError","status","output","plan","payload","recommend","context","templates","p","ai","d","a","pr","aboutPage","params","route","Router","getCurrentRoute","loginTab","registerTab","loginForm","registerForm","authCard","forgotPasswordCard","forgotPasswordBtn","backToLoginBtn","forgotPasswordForm","loginFormClone","cloneNode","replaceWith","registerFormClone","registerPassword","passwordInfoContainer","strengthContainer","strengthText","strengthBars","reqTitle","reqLength","reqUppercase","reqNumber","getAuthTranslations","window","updateRequirement","isValid","updateStrengthUI","strength","bar","label","querySelector","initPasswordRequirements","value","checks","test","special","lowercase","checkPasswordStrength","submitBtn","originalText","disabled","Presenter","handleLogin","hasMinLength","hasUppercase","hasNumber","handleRegister","showToast","setupAuthHandlers","logoutBtn","themeToggle","langBtns","logoutBtnClone","themeToggleClone","handleLogout","toggleTheme","dot","isDark","handleRouteChange","setupProfileHandlers","sendBtn","messagesContainer","addMessage","content","isUser","time","toLocaleTimeString","hour","minute","messageHTML","insertAdjacentHTML","scrollTop","sendMessage","trim","responses","randomResponse","random","shiftKey","promptText","focus","setupChatHandlers","aiToolsPage","chatMessages","chatForm","typingIndicator","messageEl","escapeHtml","scrollToBottom","div","afterRender","API_BASE_URL","PLAN_API_URL","SHIPPING_API_URL","getUserRole","PlanningState","rainfall_mm","wind_speed_kmh","totalFleet","vessels","excavatorActive","dumpTruckActive","miningMaintenanceStatus","selectedShift","isLoading","loadingSteps","icon","planningPage","isMiningPlanner","getPlanningTemplate","rainfallSlider","waveSlider","parseFloat","updateSliderValueDisplays","setupSliders","activeVehiclesInput","maintenanceInput","setupInputs","generateBtn","newPlanBtn","loadingContainer","resultDashboard","loadingPromise","loadingIcon","loadingText","i","sleep","finalStep","runLoadingAnimation","weather_input","temperature_c","humidity_pct","weather_condition","capacity_input","production_input","additional_context","road_condition","totalEquipment","availability_pct","toFixed","mine_id","equipment_type","planned_output_ton","targetProduction","shiftLabels","pagi","siang","malam","toLocaleString","vesselInfo","map","v","join","buildPayload","renderResultDashboard","demoResult","weatherClass","getWeatherClassFromRainfall","capacity","narrative","round","ml_predictions","weather_classification","effective_capacity_ton_per_day","confidence_score","production_forecast","narrative_recommendation","generateDemoResult","generateOptimizationPlan","resetToInput","setupGenerateButton","excavatorInput","dumpTruckInput","miningMaintenanceInput","targetProductionInput","shiftButtons","b","shift","setupMiningInputs","container","schedules","renderDefaultVessels","s","shipment_id","vessel_name","etd","destination","destination_port","tonnage","coal_tonnage","etdDate","timeStr","statusClass","statusText","renderVessels","loadVessels","initPlanningPage","rainfallValue","windValue","ms","Promise","resolve","rainfall","day","month","year","metricsGrid","predictions","weatherIcon","lower","includes","getWeatherIcon","capacity_forecast","confidence","model_confidence","renderMetrics","recommendation","sections","strategy","risks","actions","strategyMatch","match","risksMatch","actionsMatch","paragraphs","slice","parseNarrativeToSections","html","createRecommendationCard","renderRecommendations","gradient","cleanContent","replace","formattedContent","lines","line","authPage","hideNavbar","setupTabNavigation","form","spinner","updateNavbarAuthUI","showNavbar","redirectRoute","removeItem","location","hash","setupLoginForm","listenerAdded","isSubmitting","stopImmediatePropagation","registerResponse","registerResult","loginResponse","loginResult","finalUserName","setupRegisterForm","input","parentElement","eyeOpen","eyeClosed","tabNav","authHeader","setupForgotPassword","getStrengthLabel","span","color","setupPasswordStrength","loginBtn","profileBtn","mobileLoginBtn","mobileProfileBtn","userNameElements","userInitialElements","el","getTranslations","submit","passwordTooShort","invalidToken","resetPasswordPage","navigate","renderTemplate","setupHandlers","API_CONFIG","DashboardState","stats","production","change","unit","distribution","temperature","condition","windSpeed","total","mines","aiStatus","isOnline","chart","chartType","chartData","labels","updateInterval","chartUpdateInterval","dataRefreshInterval","fetchWithAuth","controller","AbortController","timeoutId","abort","signal","clearTimeout","checkAIHealth","catch","updateAIStatusUI","loadProductionStats","prodResponse","plans","Array","isArray","reduce","sum","target_production","calculateChange","shipResponse","totalDistribution","schedule","quantity","capacityResponse","avgEfficiency","c","rate","constraintsResponse","constraints","finishStatsLoading","updateStatsUI","setFallbackStats","latest","previous","prodValue","prodChange","distValue","distChange","effValue","effChange","alertValue","alertChange","loadWeatherData","temp","weather_class","wind_speed","updateWeatherUI","tempEl","condEl","rainEl","windEl","loadFleetStatus","equipments","activeCount","equipment_status","is_active","updateFleetUI","fleetEl","loadMinesStatus","updateMinesUI","mineAStatus","mineBStatus","dateStr","formatTime","generateChartData","getTime","date","createChart","canvas","existingChart","Chart","getChart","destroy","ctx","getContext","contains","gridColor","textColor","ChartJS","datasets","borderColor","backgroundColor","borderWidth","fill","tension","borderDash","pointRadius","responsive","maintainAspectRatio","plugins","legend","scales","x","grid","ticks","y","max","startChartUpdates","setInterval","lastProd","lastDist","update","cleanup","clearInterval","routeCleanupFn","dashboardPage","all","recommendations","isFallback","colors","bg","border","rec","priority","description","justification","fleetActive","fleetTotal","weatherCondition","alertsCount","getFallbackRecommendations","loadAIRecommendations","created_at","reverse","loadChartData","bindChartToggle","initChart","currentRoute","handler","routePath","queryString","parseQuery","updateActiveNav","pair","decodeURIComponent","link","linkRoute","mobileMenu","state","isAuthenticated","savedUser","setState","setTheme","newTheme","elements","navbar","toastContainer","routeName","offsetWidth","lucide","createIcons","updateAuthUI","authBtn","userMenu","userInitial","userEmail","toast","warning","info","footer","setupEventListeners","updateLanguageUI","page","loginBtnText","mobileLoginBtnText","updateNavActiveState","initial","icons","transform","LanguageManager","langToggle","langDropdown","stopPropagation","mobileMenuBtn","menuIcon","closeIcon","isOpen","currentLang","setupNavbarHandlers","OptiMine"],"ignoreList":[],"sourceRoot":""}