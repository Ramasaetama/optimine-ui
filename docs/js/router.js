class Router{constructor(){this.currentPage=this.getCurrentPage(),this.protectedPages=["profile"],this.authPage="auth",this.init()}getCurrentPage(){return{"":"home",index:"home",planning:"planning","ai-tools":"ai-tools",dashboard:"dashboard",auth:"auth",profile:"profile"}[window.location.pathname.split("/").pop().replace(".html","")]||"home"}setActiveNav(){const t=document.querySelectorAll(".nav-link[data-page]"),e=document.querySelectorAll(".mobile-nav-link[data-page]");t.forEach(t=>{t.dataset.page===this.currentPage?t.classList.add("active"):t.classList.remove("active")}),e.forEach(t=>{t.dataset.page===this.currentPage?t.classList.add("active"):t.classList.remove("active")})}navigateTo(t){const e=document.getElementById("page-transition-overlay");e&&e.classList.add("active"),document.body.classList.add("page-transition-out"),setTimeout(()=>{window.location.href=t},250)}checkAuth(){const t="true"===localStorage.getItem("optimine-logged-in"),e=document.getElementById("loginBtn"),i=document.getElementById("profileBtn"),n=document.getElementById("mobileLoginBtn"),o=document.getElementById("mobileProfileBtn");if(t){const t=JSON.parse(localStorage.getItem("optimine-user")||"{}"),a=(t.name||"User").charAt(0).toUpperCase(),r=t.name||"User";if(e&&(e.classList.add("hidden"),e.classList.remove("sm:flex")),i){i.classList.remove("hidden"),i.classList.add("flex");const t=i.querySelector(".user-name"),e=i.querySelector(".user-initial");t&&(t.textContent=r),e&&(e.textContent=a)}if(n&&n.classList.add("hidden"),o){o.classList.remove("hidden"),o.classList.add("flex");const t=o.querySelector(".user-name");t&&(t.textContent=r)}}else e&&(e.classList.remove("hidden"),e.classList.add("sm:flex")),i&&(i.classList.add("hidden"),i.classList.remove("flex")),n&&n.classList.remove("hidden"),o&&(o.classList.add("hidden"),o.classList.remove("flex"))}protectRoute(t="auth.html"){const e="true"===localStorage.getItem("optimine-logged-in");this.protectedPages.includes(this.currentPage)&&!e&&(localStorage.setItem("optimine-redirect",window.location.href),window.location.href=t)}redirectIfLoggedIn(){const t="true"===localStorage.getItem("optimine-logged-in");this.currentPage===this.authPage&&t&&(window.location.href="index.html")}getRedirectUrl(){const t=localStorage.getItem("optimine-redirect");return localStorage.removeItem("optimine-redirect"),t||"index.html"}updatePageTitle(){const t={home:"OptiMine - Mining Value Chain Optimization",planning:"Production Planning - OptiMine","ai-tools":"AI Assistant - OptiMine",dashboard:"Operations Dashboard - OptiMine",auth:"Login / Register - OptiMine",profile:"Profile Settings - OptiMine"};document.title=t[this.currentPage]||t.home}createTransitionOverlay(){if(!document.getElementById("page-transition-overlay")){const t=document.createElement("div");t.id="page-transition-overlay",t.className="page-transition-overlay",document.body.appendChild(t)}}init(){document.addEventListener("DOMContentLoaded",()=>{this.createTransitionOverlay(),this.setActiveNav(),this.checkAuth(),this.protectRoute(),this.redirectIfLoggedIn(),this.updatePageTitle(),document.body.classList.add("page-transition-in"),setTimeout(()=>{document.body.classList.remove("page-transition-in")},350)}),"complete"!==document.readyState&&"interactive"!==document.readyState||(this.createTransitionOverlay(),this.setActiveNav(),this.checkAuth(),this.updatePageTitle())}}function isAuthenticated(){return"true"===localStorage.getItem("optimine-logged-in")}function getCurrentUser(){try{return JSON.parse(localStorage.getItem("optimine-user")||"{}")}catch{return{}}}function navigateTo(t,e=!1){if(e&&!isAuthenticated())return localStorage.setItem("optimine-redirect",t),void(window.location.href="auth.html");window.router?window.router.navigateTo(t):window.location.href=t}const router=new Router;function setupSmoothNavigation(){document.addEventListener("click",t=>{const e=t.target.closest("a");if(!e)return;const i=e.getAttribute("href");if(!(!i||i.startsWith("http")||i.startsWith("//")||i.startsWith("#")||i.startsWith("mailto:")||i.startsWith("tel:")||"_blank"===e.target||e.hasAttribute("download"))&&(i.endsWith(".html")||""===i||"/"===i)){if(t.preventDefault(),(window.location.pathname.split("/").pop()||"index.html")===(i||"index.html"))return;window.router?window.router.navigateTo(i):window.location.href=i}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",setupSmoothNavigation):setupSmoothNavigation(),window.router=router,window.isAuthenticated=isAuthenticated,window.getCurrentUser=getCurrentUser,window.navigateTo=navigateTo;